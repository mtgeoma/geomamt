      DOUBLE PRECISION FUNCTION S13ACF(X,IFAIL)
C     MARK 5A REVISED - NAG COPYRIGHT 1976
C     MARK 5C REVISED
C     MARK 11.5(F77) REVISED. (SEPT 1985.)
C     COSINE INTEGRAL  CI(X)
C
C     .. Parameters ..
      CHARACTER*6                      SRNAME
      PARAMETER                        (SRNAME='S13ACF')
C     .. Scalar Arguments ..
      DOUBLE PRECISION                 X
      INTEGER                          IFAIL
C     .. Local Scalars ..
      DOUBLE PRECISION                 F, G, T, XHI, Y
C     .. Local Arrays ..
      CHARACTER*1                      P01REC(1)
C     .. External Functions ..
      INTEGER                          P01ABF
      EXTERNAL                         P01ABF
C     .. Intrinsic Functions ..
      INTRINSIC                        COS, LOG, SIN
C     .. Data statements ..
C     PRECISION DEPENDENT CONSTANTS
C08   DATA XHI/1.0D8/
C12   DATA XHI/1.0D12/
C14   DATA XHI/1.0D14/
      DATA XHI/1.0D16/
C18   DATA XHI/1.0D18/
C     .. Executable Statements ..
C
C      ERROR TEST
      IF (X.LE.0.0D0) GO TO 60
      IFAIL = 0
C
C     LARGE RANGE TEST
      IF (X.GT.16.0D0) GO TO 20
C
C     SMALL X - ARGUMENT EVALUATION
      T = X*X*7.8125D-3 - 1.0D0
C
C      * EXPANSION (0018) *
C
C     EXPANSION (0018) EVALUATED AS Y(T)  --PRECISION 08E
C08   Y = (((((((((((((((-6.9647762D-4)*T+4.4284628D-3)
C08  *    *T-2.1485111D-2)*T+9.5050686D-2)*T-3.4545275D-1)
C08  *    *T+9.7951502D-1)*T-2.0512621D+0)*T+2.7926704D+0)
C08  *    *T-1.4442763D+0)*T-2.3461641D+0)*T+4.5928016D+0)
C08  *    *T-1.6342365D+0)*T-2.0680286D+0)*T+1.5150509D+0)
C08  *    *T-3.4360253D-1)*T - 2.5111016D+0
C
C     EXPANSION (0018) EVALUATED AS Y(T)  --PRECISION 12E
C12   Y = (((((((((((((((+1.19344413290D-6*T-1.13231277698D-5)
C12  *    *T+8.95365063225D-5)*T-6.48354331303D-4)
C12  *    *T+4.05890444785D-3)*T-2.15693272466D-2)
C12  *    *T+9.56573999111D-2)*T-3.45374545929D-1)
C12  *    *T+9.78999033715D-1)*T-2.05130344312D+0)
C12  *    *T+2.79291303133D+0)*T-1.44426393737D+0)
C12  *    *T-2.34622593672D+0)*T+4.59279959820D+0)
C12  *    *T-1.63422875867D+0)*T-2.06802842645D+0)
C12  *    *T+1.51505055241D+0
C12   Y = (Y*T-3.43602529252D-1)*T - 2.51110158011D+0
C
C     EXPANSION (0018) EVALUATED AS Y(T)  --PRECISION 14E
C14   Y = (((((((((((((((-1.1199014452226D-7*T+1.1934441328981D-6)
C14  *    *T-1.0791174583311D-5)*T+8.9536506322483D-5)
C14  *    *T-6.4941823767606D-4)*T+4.0589044478466D-3)
C14  *    *T-2.1568163598975D-2)*T+9.5657399911138D-2)
C14  *    *T-3.4537530229991D-1)*T+9.7899903371549D-1)
C14  *    *T-2.0513031459780D+0)*T+2.7929130313342D+0)
C14  *    *T-1.4442640059461D+0)*T-2.3462259367158D+0)
C14  *    *T+4.5927996067723D+0)*T-1.6342287586743D+0)
C14  *    *T-2.0680284269337D+0
C14   Y = ((Y*T+1.5150505524083D+0)*T-3.4360252924391D-1)
C14  *    *T - 2.5111015801066D+0
C
C     EXPANSION (0018) EVALUATED AS Y(T)  --PRECISION 16E
      Y = (((((((((((((((-7.145762153657962D-10
     *    *T+9.420130491007220D-9)*T-1.082386193915909D-7)
     *    *T+1.146343480443066D-6)*T-1.079961551485462D-5)
     *    *T+8.963659520895003D-5)*T-6.494076083548573D-4)
     *    *T+4.058786696215413D-3)*T-2.156817180543587D-2)
     *    *T+9.565748362518863D-2)*T-3.453752982992567D-1)
     *    *T+9.789989968813039D-1)*T-2.051303147200470D+0)
     *    *T+2.792913041200510D+0)*T-1.444264005721564D+0)
     *    *T-2.346225938233677D+0)*T+4.592799606749607D+0
      Y = ((((Y*T-1.634228758555692D+0)*T-2.068028426932639D+0)
     *    *T+1.515050552404695D+0)*T-3.436025292439280D-1)*T -
     *     2.511101580106584D+0
C
C     EXPANSION (0018) EVALUATED AS Y(T)  --PRECISION 18E
C18   Y = (((((((((((((((+4.91456734855115571D-11
C18  *    *T-7.14576215365796233D-10)*T+9.14982928683690623D-9)
C18  *    *T-1.08238619391590866D-7)*T+1.14698544580297062D-6)
C18  *    *T-1.07996155148546244D-5)*T+8.96357336238617346D-5)
C18  *    *T-6.49407608354857276D-4)*T+4.05878741420298707D-3)
C18  *    *T-2.15681718054358687D-2)*T+9.56574832408541034D-2)
C18  *    *T-3.45375298299256684D-1)*T+9.78998997013418893D-1)
C18  *    *T-2.05130314720046993D+0)*T+2.79291304117220014D+0)
C18  *    *T-1.44426400572156389D+0)*T-2.34622593823013773D+0
C18   Y = (((((Y*T+4.59279960674960658D+0)*T-1.63422875855591890D+0)
C18  *    *T-2.06802842693263893D+0)*T+1.51505055240470049D+0)
C18  *    *T-3.43602529243928014D-1)*T - 2.51110158010658381D+0
C
C
      S13ACF = DLOG(X) + Y
      RETURN
C
C     LARGE X - ARGUMENT EVALUATION
   20 IF (X.GE.XHI) GO TO 40
      Y = X*X
      T = 512.0D0/Y - 1.0D0
C
C      * EXPANSION (0019) *
C
C     EXPANSION (0019) EVALUATED AS F(T)  --PRECISION 08E
C08   F = ((((+3.0159308D-7)*T-3.7549003D-6)*T+7.8218589D-5)
C08  *    *T-3.7372805D-3)*T + 9.9618044D-1
C
C     EXPANSION (0019) EVALUATED AS F(T)  --PRECISION 12E
C12   F = ((((((((+2.18730111947D-10)*T-9.87195648721D-10)
C12  *    *T+4.84033743417D-9)*T-3.31129990890D-8)
C12  *    *T+2.93949795147D-7)*T-3.71221333201D-6)
C12  *    *T+7.82215026550D-5)*T-3.73729126678D-3)*T +
C12  *     9.96180441908D-1
C
C     EXPANSION (0019) EVALUATED AS F(T)  --PRECISION 14E
C14   F = ((((((((((+1.5955106693333D-11)*T-5.5714992702494D-11)
C14  *    *T+1.7884234521333D-10)*T-8.6183691514048D-10)
C14  *    *T+4.8752392300591D-9)*T-3.3207018139177D-8)
C14  *    *T+2.9393733021989D-7)*T-3.7121872156051D-6)
C14  *    *T+7.8221504213102D-5)*T-3.7372912687427D-3)*T +
C14  *     9.9618044190789D-1
C
C     EXPANSION (0019) EVALUATED AS F(T)  --PRECISION 16E
      F = (((((((((((((-6.487820803229041D-13)*T+1.742662974813055D-12)
     *    *T-2.941068638271440D-12)*T+1.072711776889383D-11)
     *    *T-4.446424130567387D-11)*T+1.847238327533211D-10)
     *    *T-8.741419374178216D-10)*T+4.872189569853223D-9)
     *    *T-3.320140407017584D-8)*T+2.939380449839969D-7)
     *    *T-3.712188242826874D-6)*T+7.822150415183696D-5)
     *    *T-3.737291268690489D-3)*T + 9.961804419078865D-1
C
C     EXPANSION (0019) EVALUATED AS F(T)  --PRECISION 18E
C18   F = ((((((((((((((((+4.86990663727841280D-14)
C18  *    *T-1.09176921093439488D-13)*T+6.34989883577057280D-14)
C18  *    *T-2.39368626222505984D-13)*T+1.15517351776520397D-12)
C18  *    *T-3.55518881942203699D-12)*T+1.17023188129910753D-11)
C18  *    *T-4.39951217228505001D-11)*T+1.84001853732121956D-10)
C18  *    *T-8.74333849974431170D-10)*T+4.87245424704650801D-9)
C18  *    *T-3.32013637685389532D-8)*T+2.93937999539516224D-7)
C18  *    *T-3.71218824655850721D-6)*T+7.82215041547366874D-5)
C18  *    *T-3.73729126869038934D-3)*T + 9.96180441907886510D-1
C
C
C      * EXPANSION (0020) *
C
C     EXPANSION (0020) EVALUATED AS G(T)  --PRECISION 08E
C08   G = (((((-3.2605673D-7)*T+2.3945267D-6)*T-2.3623892D-5)
C08  *    *T+3.6880340D-4)*T-1.0898989D-2)*T + 9.8870586D-1
C
C     EXPANSION (0020) EVALUATED AS G(T)  --PRECISION 12E
C12   G = (((((((((-7.86311811853D-10)*T+2.85167855920D-9)
C12  *    *T-9.97241803495D-9)*T+5.06204309139D-8)
C12  *    *T-3.06835791943D-7)*T+2.31360560292D-6)
C12  *    *T-2.36337972334D-5)*T+3.68834368710D-4)
C12  *    *T-1.08989877903D-2)*T + 9.88705859371D-1
C
C     EXPANSION (0020) EVALUATED AS G(T)  --PRECISION 14E
C14   G = ((((((((((((+2.9651791738191D-11)*T-8.1274519104934D-11)
C14  *    *T+1.5244369660008D-10)*T-5.6280688431483D-10)
C14  *    *T+2.3482556767751D-9)*T-1.0195922962487D-8)
C14  *    *T+5.1096600747956D-8)*T-3.0673800853768D-7)
C14  *    *T+2.3134291717659D-6)*T-2.3633814694710D-5)
C14  *    *T+3.6883439124165D-4)*T-1.0898987789417D-2)*T +
C14  *     9.8870585937051D-1
C
C     EXPANSION (0020) EVALUATED AS G(T)  --PRECISION 16E
      G = (((((((((((((((-2.134526069276983D-12)
     *    *T+4.840233971123487D-12)*T-3.605540496408867D-12)
     *    *T+1.271097283925905D-11)*T-5.554868516197534D-11)
     *    *T+1.757373225861146D-10)*T-6.008007714642121D-10)
     *    *T+2.332373659057313D-9)*T-1.017137565178131D-8)
     *    *T+5.110215945415727D-8)*T-3.067454745911935D-7)
     *    *T+2.313428245314906D-6)*T-2.363381373591827D-5)
     *    *T+3.688343912995559D-4)*T-1.089898778945207D-2)*T +
     *     9.887058593705057D-1
C
C     EXPANSION (0020) EVALUATED AS G(T)  --PRECISION 18E
C18   G = (((((((((((((((+2.43669269913534464D-13
C18  *    *T-4.81013570050588672D-13)*T-1.06265802930487296D-13)
C18  *    *T-9.02183965619814400D-14)*T+2.93520978929726259D-12)
C18  *    *T-7.18307892366012006D-12)*T+1.70687678062319268D-11)
C18  *    *T-5.22266851938134641D-11)*T+1.71515979253039184D-10)
C18  *    *T-6.02557598370451512D-10)*T+2.33450259515872927D-9)
C18  *    *T-1.01708486037094415D-8)*T+5.11015920578187682D-8)
C18  *    *T-3.06745558439750417D-7)*T+2.31342831851492447D-6)
C18  *    *T-2.36338137299290861D-5)*T+3.68834391295988884D-4
C18   G = (G*T-1.08989877894521955D-2)*T + 9.88705859370505720D-1
C
C
      S13ACF = SIN(X)*F/X - COS(X)*G/Y
      RETURN
   40 S13ACF = 0.0D0
      RETURN
C
   60 IFAIL = P01ABF(IFAIL,1,SRNAME,0,P01REC)
      S13ACF = 0.0D0
      RETURN
C
      END
