      DOUBLE PRECISION FUNCTION S17ADF(X,IFAIL)
C     MARK 7 RELEASE. NAG COPYRIGHT 1978.
C     MARK 7C REVISED IER-185 (MAY 1979)
C     MARK 7D REVISED IER-196 (JUL 1979)
C     MARK 11.5(F77) REVISED. (SEPT 1985.)
C     MARK 14 REVISED. IER-757 (DEC 1989).
C     BESSEL FUNCTION Y1(X)
C
C     **************************************************************
C
C     TO EXTRACT THE CORRECT CODE FOR A PARTICULAR MACHINE-RANGE,
C     ACTIVATE THE STATEMENTS CONTAINED IN COMMENTS BEGINNING  CDD ,
C     WHERE  DD  IS THE APPROXIMATE NUMBER OF SIGNIFICANT DECIMAL
C     DIGITS REPRESENTED BY THE MACHINE
C     DELETE THE ILLEGAL DUMMY STATEMENTS OF THE FORM
C     * EXPANSION (NNNN) *
C
C     ALSO INSERT APPROPRIATE DATA STATEMENTS TO DEFINE CONSTANTS
C     WHICH DEPEND ON THE RANGE OF NUMBERS REPRESENTED BY THE
C     MACHINE, RATHER THAN THE PRECISION (SUITABLE STATEMENTS FOR
C     SOME MACHINES ARE CONTAINED IN COMMENTS BEGINNING CRD WHERE
C     D IS A DIGIT WHICH SIMPLY DISTINGUISHES A GROUP OF MACHINES).
C     DELETE THE ILLEGAL DUMMY DATA STATEMENTS WITH VALUES WRITTEN
C     *VALUE*
C
C     NOTE - THE VALUE OF THE CONSTANT XBIG (DEFINED IN A DATA
C     STATEMENT) SHOULD BE REDUCED IF NECESSARY TO ENSURE THAT SIN
C     AND COS WILL RETURN A RESULT WITHOUT AN EXECUTION ERROR FOR
C     ALL ARGUMENTS X SUCH THAT ABS(X) .LE. XBIG
C
C     **************************************************************
C
C     .. Parameters ..
      CHARACTER*6                      SRNAME
      PARAMETER                        (SRNAME='S17ADF')
C     .. Scalar Arguments ..
      DOUBLE PRECISION                 X
      INTEGER                          IFAIL
C     .. Local Scalars ..
      DOUBLE PRECISION                 A, B, C, CX, G, SX, T, T2, TBPI,
     *                                 XBIG, XSEST, XSMALL, Y
C     .. Local Arrays ..
      CHARACTER*1                      P01REC(1)
C     .. External Functions ..
      INTEGER                          P01ABF
      EXTERNAL                         P01ABF
C     .. Intrinsic Functions ..
      INTRINSIC                        LOG, COS, SIN, SQRT
C     .. Data statements ..
C08    DATA XBIG,XSMALL,TBPI
C08  1/1.0D+7,7.7D-5,6.36619772D-1/
C09   DATA XBIG,XSMALL,TBPI
C09  1/1.0D+8,2.5D-5,6.366197724D-1/
C12   DATA XBIG,XSMALL,TBPI
C12  1/1.0D+11,3.4D-7,6.366197723676D-1/
C15   DATA XBIG,XSMALL,TBPI
C15  1/1.0D+14,1.3D-8,6.366197723675813D-1/
      DATA XBIG,XSMALL,TBPI
     1/1.0D+16,7.9D-10,6.36619772367581343D-1/
C19   DATA XBIG,XSMALL,TBPI
C19  1/1.0D+18,2.7D-10,6.3661977236758134308D-1/
C
      DATA XSEST / 2.23D-308 /
C     XSEST = (2.0/PI) * (1.0/MAXREAL)  (ROUNDED UP)
C     FOR IEEE SINGLE PRECISION
CR0   DATA XSEST /1.176E-38/
C     FOR IBM 360/370 AND SIMILAR MACHINES
CR1   DATA XSEST /8.8D-77/
C     FOR DEC-10, HONEYWELL, UNIVAC 1100(S.P.)
CR2   DATA XSEST /3.8D-39/
C     FOR ICL 1900
CR3   DATA XSEST /1.2D-77/
C     FOR CDC 7600/CYBER
CR4   DATA XSEST /0.0D0/
C     FOR UNIVAC 1100(D.P.)
CR5   DATA XSEST /7.1D-309/
C     FOR IEEE DOUBLE PRECISION
CR7   DATA XSEST /2.2251D-308/
C     .. Executable Statements ..
C
C     X RANGE TEST
      IF (X.GT.8.0D0) GO TO 40
C     X SMALL RANGE TEST
      IF (X.GT.XSMALL) GO TO 20
C     ERROR 3 OR 2 TEST
      IF (X.LE.XSEST) GO TO 80
      S17ADF = -TBPI/X
      IFAIL = 0
      GO TO 120
C
   20 T = 3.125D-2*X*X - 1.0D0
      T2 = 2.0D0*T
C
C      * EXPANSION (0031) *
C
C     EXPANSION (0031) EVALUATED AS Y(T)  --PRECISION 08E.09
C08   A = +2.94970701D-8
C08   B = T2*A - 7.61758781D-7
C08   C = T2*B - A + 1.58870192D-5
C08   A = T2*C - B - 2.60444389D-4
C08   B = T2*A - C + 3.24027018D-3
C08   C = T2*B - A - 2.91755248D-2
C08   A = T2*C - B + 1.77709117D-1
C08   B = T2*A - C - 6.61443934D-1
C08   C = T2*B - A + 1.28799410D+0
C08   A = T2*C - B - 1.19180116D+0
C08   Y = T*A - C + 6.48358771D-1
C
C     EXPANSION (0031) EVALUATED AS Y(T)  --PRECISION 09E.10
C09   A = -9.424212982D-10
C09   B = T2*A + 2.949707007D-8
C09   C = T2*B - A - 7.617587805D-7
C09   A = T2*C - B + 1.588701924D-5
C09   B = T2*A - C - 2.604443893D-4
C09   C = T2*B - A + 3.240270183D-3
C09   A = T2*C - B - 2.917552481D-2
C09   B = T2*A - C + 1.777091172D-1
C09   C = T2*B - A - 6.614439341D-1
C09   A = T2*C - B + 1.287994099D+0
C09   B = T2*A - C - 1.191801161D+0
C09   Y = T*B - A + 6.483587706D-1
C
C     EXPANSION (0031) EVALUATED AS Y(T)  --PRECISION 12E.13
C12   A = -5.777404200000D-13
C12   B = T2*A + 2.528123664000D-11
C12   C = T2*B - A - 9.424212981600D-10
C12   A = T2*C - B + 2.949707007278D-8
C12   B = T2*A - C - 7.617587805400D-7
C12   C = T2*B - A + 1.588701923993D-5
C12   A = T2*C - B - 2.604443893486D-4
C12   B = T2*A - C + 3.240270182684D-3
C12   C = T2*B - A - 2.917552480615D-2
C12   A = T2*C - B + 1.777091172397D-1
C12   B = T2*A - C - 6.614439341345D-1
C12   C = T2*B - A + 1.287994098858D+0
C12   A = T2*C - B - 1.191801160541D+0
C12   Y = T*A - C + 6.483587706053D-1
C
C     EXPANSION (0031) EVALUATED AS Y(T)  --PRECISION 15E.16
C15   A = -1.955400000000000D-16
C15   B = T2*A + 1.138572000000000D-14
C15   C = T2*B - A - 5.777404200000000D-13
C15   A = T2*C - B + 2.528123664000000D-11
C15   B = T2*A - C - 9.424212981600000D-10
C15   C = T2*B - A + 2.949707007278000D-8
C15   A = T2*C - B - 7.617587805400300D-7
C15   B = T2*A - C + 1.588701923993213D-5
C15   C = T2*B - A - 2.604443893485807D-4
C15   A = T2*C - B + 3.240270182683857D-3
C15   B = T2*A - C - 2.917552480615421D-2
C15   C = T2*B - A + 1.777091172397283D-1
C15   A = T2*C - B - 6.614439341345433D-1
C15   B = T2*A - C + 1.287994098857678D+0
C15   C = T2*B - A - 1.191801160541217D+0
C15   Y = T*C - B + 6.483587706052649D-1
C
C     EXPANSION (0031) EVALUATED AS Y(T)  --PRECISION 17E.18
      A = +2.95000000000000000D-18
      B = T2*A - 1.95540000000000000D-16
      C = T2*B - A + 1.13857200000000000D-14
      A = T2*C - B - 5.77740420000000000D-13
      B = T2*A - C + 2.52812366400000000D-11
      C = T2*B - A - 9.42421298160000000D-10
      A = T2*C - B + 2.94970700727800000D-8
      B = T2*A - C - 7.61758780540030000D-7
      C = T2*B - A + 1.58870192399321300D-5
      A = T2*C - B - 2.60444389348580680D-4
      B = T2*A - C + 3.24027018268385747D-3
      C = T2*B - A - 2.91755248061542077D-2
      A = T2*C - B + 1.77709117239728283D-1
      B = T2*A - C - 6.61443934134543253D-1
      C = T2*B - A + 1.28799409885767762D+0
      A = T2*C - B - 1.19180116054121687D+0
      Y = T*A - C + 6.48358770605264921D-1
C
C     EXPANSION (0031) EVALUATED AS Y(T)  --PRECISION 19E.20
C19   A = -4.0000000000000000000D-20
C19   B = T2*A + 2.9500000000000000000D-18
C19   C = T2*B - A - 1.9554000000000000000D-16
C19   A = T2*C - B + 1.1385720000000000000D-14
C19   B = T2*A - C - 5.7774042000000000000D-13
C19   C = T2*B - A + 2.5281236640000000000D-11
C19   A = T2*C - B - 9.4242129816000000000D-10
C19   B = T2*A - C + 2.9497070072780000000D-8
C19   C = T2*B - A - 7.6175878054003000000D-7
C19   A = T2*C - B + 1.5887019239932130000D-5
C19   B = T2*A - C - 2.6044438934858068000D-4
C19   C = T2*B - A + 3.2402701826838574700D-3
C19   A = T2*C - B - 2.9175524806154207660D-2
C19   B = T2*A - C + 1.7770911723972828328D-1
C19   C = T2*B - A - 6.6144393413454325277D-1
C19   A = T2*C - B + 1.2879940988576776204D+0
C19   B = T2*A - C - 1.1918011605412168725D+0
C19   Y = T*B - A + 6.4835877060526492084D-1
C
C      * EXPANSION (0032) *
C
C     EXPANSION (0032) EVALUATED AS G(T)  --PRECISION 08E.09
C08   A = +1.87547032D-9
C08   B = T2*A - 5.68844004D-8
C08   C = T2*B - A + 1.41662436D-6
C08   A = T2*C - B - 2.83046401D-5
C08   B = T2*A - C + 4.40478630D-4
C08   C = T2*B - A - 5.13164116D-3
C08   A = T2*C - B + 4.23191804D-2
C08   B = T2*A - C - 2.26624992D-1
C08   C = T2*B - A + 6.75615781D-1
C08   A = T2*C - B - 7.67296363D-1
C08   B = T2*A - C - 1.28697384D-1
C08   G = T*B - A + 2.03041059D-2
C
C     EXPANSION (0032) EVALUATED AS G(T)  --PRECISION 09E.10
C09   A = +1.875470325D-9
C09   B = T2*A - 5.688440040D-8
C09   C = T2*B - A + 1.416624364D-6
C09   A = T2*C - B - 2.830464015D-5
C09   B = T2*A - C + 4.404786299D-4
C09   C = T2*B - A - 5.131641161D-3
C09   A = T2*C - B + 4.231918035D-2
C09   B = T2*A - C - 2.266249916D-1
C09   C = T2*B - A + 6.756157808D-1
C09   A = T2*C - B - 7.672963629D-1
C09   B = T2*A - C - 1.286973844D-1
C09   G = T*B - A + 2.030410589D-2
C
C     EXPANSION (0032) EVALUATED AS G(T)  --PRECISION 12E.13
C12   A = +1.211433210000D-12
C12   B = T2*A - 5.172121473000D-11
C12   C = T2*B - A + 1.875470324730D-9
C12   A = T2*C - B - 5.688440039919D-8
C12   B = T2*A - C + 1.416624364492D-6
C12   C = T2*B - A - 2.830464014951D-5
C12   A = T2*C - B + 4.404786298671D-4
C12   B = T2*A - C - 5.131641161061D-3
C12   C = T2*B - A + 4.231918035334D-2
C12   A = T2*C - B - 2.266249915568D-1
C12   B = T2*A - C + 6.756157807722D-1
C12   C = T2*B - A - 7.672963628866D-1
C12   A = T2*C - B - 1.286973843814D-1
C12   G = T*A - C + 2.030410588593D-2
C
C     EXPANSION (0032) EVALUATED AS G(T)  --PRECISION 15E.16
C15   A = +4.277300000000000D-16
C15   B = T2*A - 2.440949000000000D-14
C15   C = T2*B - A + 1.211433210000000D-12
C15   A = T2*C - B - 5.172121473000000D-11
C15   B = T2*A - C + 1.875470324730000D-9
C15   C = T2*B - A - 5.688440039919000D-8
C15   A = T2*C - B + 1.416624364492350D-6
C15   B = T2*A - C - 2.830464014951480D-5
C15   C = T2*B - A + 4.404786298670995D-4
C15   A = T2*C - B - 5.131641161061085D-3
C15   B = T2*A - C + 4.231918035333690D-2
C15   C = T2*B - A - 2.266249915567549D-1
C15   A = T2*C - B + 6.756157807721877D-1
C15   B = T2*A - C - 7.672963628866459D-1
C15   C = T2*B - A - 1.286973843813500D-1
C15   G = T*C - B + 2.030410588593425D-2
C
C     EXPANSION (0032) EVALUATED AS G(T)  --PRECISION 17E.18
      A = -6.58000000000000000D-18
      B = T2*A + 4.27730000000000000D-16
      C = T2*B - A - 2.44094900000000000D-14
      A = T2*C - B + 1.21143321000000000D-12
      B = T2*A - C - 5.17212147300000000D-11
      C = T2*B - A + 1.87547032473000000D-9
      A = T2*C - B - 5.68844003991900000D-8
      B = T2*A - C + 1.41662436449235000D-6
      C = T2*B - A - 2.83046401495148000D-5
      A = T2*C - B + 4.40478629867099510D-4
      B = T2*A - C - 5.13164116106108479D-3
      C = T2*B - A + 4.23191803533369041D-2
      A = T2*C - B - 2.26624991556754924D-1
      B = T2*A - C + 6.75615780772187667D-1
      C = T2*B - A - 7.67296362886645940D-1
      A = T2*C - B - 1.28697384381350001D-1
      G = T*A - C + 2.03041058859342538D-2
C
C     EXPANSION (0032) EVALUATED AS G(T)  --PRECISION 19E.20
C19   A = +9.0000000000000000000D-20
C19   B = T2*A - 6.5800000000000000000D-18
C19   C = T2*B - A + 4.2773000000000000000D-16
C19   A = T2*C - B - 2.4409490000000000000D-14
C19   B = T2*A - C + 1.2114332100000000000D-12
C19   C = T2*B - A - 5.1721214730000000000D-11
C19   A = T2*C - B + 1.8754703247300000000D-9
C19   B = T2*A - C - 5.6884400399190000000D-8
C19   C = T2*B - A + 1.4166243644923500000D-6
C19   A = T2*C - B - 2.8304640149514800000D-5
C19   B = T2*A - C + 4.4047862986709951000D-4
C19   C = T2*B - A - 5.1316411610610847900D-3
C19   A = T2*C - B + 4.2319180353336904110D-2
C19   B = T2*A - C - 2.2662499155675492443D-1
C19   C = T2*B - A + 6.7561578077218766694D-1
C19   A = T2*C - B - 7.6729636288664593978D-1
C19   B = T2*A - C - 1.2869738438135000138D-1
C19   G = T*B - A + 2.0304105885934253840D-2
C
      S17ADF = 0.125D0*X*(LOG(X)*Y*TBPI+G) - TBPI/X
      IFAIL = 0
      GO TO 120
C
   40 IF (X.GT.XBIG) GO TO 60
      G = X - 1.5D0/TBPI
      Y = SQRT(TBPI/X)
      CX = COS(G)*Y*8.0D0/X
      SX = SIN(G)*Y
      T = 128.0D0/(X*X) - 1.0D0
C
C      * EXPANSION (0033) *
C
C     EXPANSION (0033) EVALUATED AS Y(T)  --PRECISION 08E.09
C08   Y = ((((-1.49751260D-8)*T+2.47105358D-7)*T-7.95959347D-6)
C08  *    *T+8.98804504D-4)*T + 1.00090703D+0
C
C     EXPANSION (0033) EVALUATED AS Y(T)  --PRECISION 09E.10
C09   Y = ((((-1.497512599D-8)*T+2.471053584D-7)*T-7.959593475D-6)
C09  *    *T+8.988045041D-4)*T + 1.000907026D+0
C
C     EXPANSION (0033) EVALUATED AS Y(T)  --PRECISION 12E.13
C12   Y = (((((((+3.007485120000D-11)*T-1.825556364800D-10)
C12  *    *T+1.358072796000D-9)*T-1.470129253816D-8)
C12  *    *T+2.453682941886D-7)*T-7.959696162530D-6)
C12  *    *T+8.988049416226D-4)*T + 1.000907026278D+0
C
C     EXPANSION (0033) EVALUATED AS Y(T)  --PRECISION 15E.16
C15   Y = (((((((((((+1.092403200000000D-13)*T-3.697254400000000D-13)
C15  *    *T+1.095472640000000D-12)*T-5.071493120000000D-12)
C15  *    *T+2.723452416000000D-11)*T-1.713727974400000D-10)
C15  *    *T+1.360296919680000D-9)*T-1.470849844856000D-8)
C15  *    *T+2.453676633377600D-7)*T-7.959694699684780D-6)
C15  *    *T+8.988049416705182D-4)*T + 1.000907026278082D+0
C
C     EXPANSION (0033) EVALUATED AS Y(T)  --PRECISION 17E.18
      Y = (((((((((((((+1.24928000000000000D-14)
     *    *T-3.54508800000000000D-14)*T+6.86387200000000000D-14)
     *    *T-2.63372800000000000D-13)*T+1.14622464000000000D-12)
     *    *T-5.19113984000000000D-12)*T+2.72040729600000000D-11)
     *    *T-1.71310758400000000D-10)*T+1.36030580128000000D-9)
     *    *T-1.47085129889600000D-8)*T+2.45367662227560000D-7)
     *    *T-7.95969469843846000D-6)*T+8.98804941670557880D-4)*T +
     *    1.00090702627808217D+0
C
C     EXPANSION (0033) EVALUATED AS Y(T)  --PRECISION 19E.20
C19   Y = ((((((((((((((((-6.5536000000000000000D-16)
C19  *    *T+1.9660800000000000000D-15)*T-2.1299200000000000000D-15)
C19  *    *T+5.1200000000000000000D-15)*T-2.3080960000000000000D-14)
C19  *    *T+7.9697920000000000000D-14)*T-2.8263424000000000000D-13)
C19  *    *T+1.1377766400000000000D-12)*T-5.1772390400000000000D-12)
C19  *    *T+2.7207528960000000000D-11)*T-1.7131578496000000000D-10)
C19  *    *T+1.3603050755200000000D-9)*T-1.4708512133280000000D-8)
C19  *    *T+2.4536766229476000000D-7)*T-7.9596946984927400000D-6)
C19  *    *T+8.9880494167055608000D-4)*T + 1.0009070262780821665D+0
C
C      * EXPANSION (0034) *
C
C     EXPANSION (0034) EVALUATED AS G(T)  --PRECISION 08E.09
C08   G = (((((-7.49818190D-10)*T+6.58335466D-9)*T-8.29018528D-8)
C08  *    *T+1.82113970D-6)*T-9.62145905D-5)*T + 4.67768740D-2
C
C     EXPANSION (0034) EVALUATED AS G(T)  --PRECISION 09E.10
C09   G = (((((-7.498181901D-10)*T+6.583354662D-9)*T-8.290185280D-8)
C09  *    *T+1.821139697D-6)*T-9.621459047D-5)*T + 4.677687403D-2
C
C     EXPANSION (0034) EVALUATED AS G(T)  --PRECISION 12E.13
C12   G = (((((((((-1.167680000000D-12)*T+4.603874560000D-12)
C12  *    *T-1.826434048000D-11)*T+1.032792521600D-10)
C12  *    *T-7.152283142400D-10)*T+6.420379003440D-9)
C12  *    *T-8.291958561664D-8)*T+1.821201819899D-6)
C12  *    *T-9.621458822163D-5)*T + 4.677687402745D-2
C
C     EXPANSION (0034) EVALUATED AS G(T)  --PRECISION 15E.16
C15   G = ((((((((((((+3.620864000000000D-14)*T-1.051545600000000D-13)
C15  *    *T+2.245990400000000D-13)*T-8.785049600000000D-13)
C15  *    *T+3.893016320000000D-12)*T-1.855351552000000D-11)
C15  *    *T+1.039448166400000D-10)*T-7.151018001600000D-10)
C15  *    *T+6.420133522640000D-9)*T-8.291960820844000D-8)
C15  *    *T+1.821201851167060D-6)*T-9.621458822050362D-5)*T +
C15  *    4.677687402744898D-2
C
C     EXPANSION (0034) EVALUATED AS G(T)  --PRECISION 17E.18
      G = (((((((((((((((-2.29376000000000000D-15)
     *    *T+5.32480000000000000D-15)*T-4.83328000000000000D-15)
     *    *T+1.75718400000000000D-14)*T-7.43936000000000000D-14)
     *    *T+2.50224640000000000D-13)*T-9.23228160000000000D-13)
     *    *T+3.87554432000000000D-12)*T-1.85248000000000000D-11)
     *    *T+1.03950931840000000D-10)*T-7.15110504800000000D-10)
     *    *T+6.42013250344000000D-9)*T-8.29196070929200000D-8)
     *    *T+1.82120185123076000D-6)*T-9.62145882205441600D-5)*T +
     *    4.67768740274489776D-2
C
C     EXPANSION (0034) EVALUATED AS G(T)  --PRECISION 19E.20
C19   G = ((((((((((((((((-6.5536000000000000000D-16
C19  *    *T+9.8304000000000000000D-16)*T+4.9152000000000000000D-16)
C19  *    *T+1.3926400000000000000D-15)*T-9.7075200000000000000D-15)
C19  *    *T+2.3961600000000000000D-14)*T-6.9867520000000000000D-14)
C19  *    *T+2.4481792000000000000D-13)*T-9.2562176000000000000D-13)
C19  *    *T+3.8780787200000000000D-12)*T-1.8524081920000000000D-11)
C19  *    *T+1.0395028672000000000D-10)*T-7.1511061904000000000D-10)
C19  *    *T+6.4201325840800000000D-9)*T-8.2919607084760000000D-8)
C19  *    *T+1.8212018512269200000D-6)*T-9.6214588220544330000D-5)*T +
C19  *    4.6776874027448977670D-2
C
      S17ADF = G*CX + Y*SX
      IFAIL = 0
      GO TO 120
C
   60 IFAIL = P01ABF(IFAIL,1,SRNAME,0,P01REC)
      S17ADF = SQRT(TBPI/X)
      GO TO 120
C
   80 IF (X.GT.0.0D0) GO TO 100
      IFAIL = P01ABF(IFAIL,2,SRNAME,0,P01REC)
      S17ADF = 0.0D0
      GO TO 120
C
  100 IFAIL = P01ABF(IFAIL,3,SRNAME,0,P01REC)
      S17ADF = -TBPI/XSEST
C
  120 RETURN
      END
