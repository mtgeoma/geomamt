      DOUBLE PRECISION FUNCTION S11AAF(X,IFAIL)
C     MARK 5A REVISED - NAG COPYRIGHT 1976
C     MARK 11.5(F77) REVISED. (SEPT 1985.)
C     ARCTANH(X)
C
C     .. Parameters ..
      CHARACTER*6                      SRNAME
      PARAMETER                        (SRNAME='S11AAF')
C     .. Scalar Arguments ..
      DOUBLE PRECISION                 X
      INTEGER                          IFAIL
C     .. Local Scalars ..
      DOUBLE PRECISION                 U, Y
C     .. Local Arrays ..
      CHARACTER*1                      P01REC(1)
C     .. External Functions ..
      INTEGER                          P01ABF
      EXTERNAL                         P01ABF
C     .. Intrinsic Functions ..
      INTRINSIC                        ABS, LOG, SIGN
C     .. Executable Statements ..
C
      U = ABS(X)
C
C     ERROR 1 TEST
      IF (U.GE.1.0D0) GO TO 40
      IFAIL = 0
C     LARGE RANGE TEST
      IF (X*X.GT.0.5D0) GO TO 20
C
C     EXPANSION ARGUMENT
      U = 4.0D0*X*X - 1.0D0
C
C      * EXPANSION (0013) *
C
C     EXPANSION (0013) EVALUATED AS Y(U)  --PRECISION 08E
C08   Y = (((((((((+3.5214953D-6)*U+1.1487224D-5)*U+3.0088098D-5)
C08  *    *U+1.0514863D-4)*U+3.8208291D-4)*U+1.4056950D-3)
C08  *    *U+5.4490214D-3)*U+2.3090616D-2)*U+1.1736053D-1)*U +
C08  *     1.0986123D+0
C
C     EXPANSION (0013) EVALUATED AS Y(U)  --PRECISION 12E
C12   Y = ((((((((((((((+1.09259899627D-8)*U+3.42221223670D-8)
C12  *    *U+6.95509537241D-8)*U+2.30527749148D-7)
C12  *    *U+8.21135661776D-7)*U+2.72071118548D-6)
C12  *    *U+9.08534546912D-6)*U+3.09444927838D-5)
C12  *    *U+1.07361134571D-4)*U+3.81696075883D-4)
C12  *    *U+1.40488401355D-3)*U+5.44909177456D-3)
C12  *    *U+2.30907193659D-2)*U+1.17360522336D-1)*U +
C12  *     1.09861228867D+0
C
C     EXPANSION (0013) EVALUATED AS Y(U)  --PRECISION 14E
C14   Y = ((((((((((((((((+1.1293320646428D-9)*U+3.5052644308575D-9)
C14  *    *U+6.4086617041053D-9)*U+2.1077380751299D-8)
C14  *    *U+7.6891612144316D-8)*U+2.5024486157205D-7)
C14  *    *U+8.1492433542048D-7)*U+2.7056495023737D-6)
C14  *    *U+9.0882570283485D-6)*U+3.0950654381434D-5)
C14  *    *U+1.0736039344640D-4)*U+3.8169478194781D-4)
C14  *    *U+1.4048841061925D-3)*U+5.4490918943666D-3)
C14  *    *U+2.3090719361510D-2)*U+1.1736052233252D-1)*U +
C14  *     1.0986122886681D+0
C
C     EXPANSION (0013) EVALUATED AS Y(U)  --PRECISION 16E
      Y = (((((((((((((((+3.856235316559190D-11
     *    *U+1.184977617320312D-10)*U+1.820410351379402D-10)
     *    *U+5.960921368486746D-10)*U+2.319454882064018D-9)
     *    *U+7.408486568719348D-9)*U+2.339295963220429D-8)
     *    *U+7.588067811453948D-8)*U+2.479830612463254D-7)
     *    *U+8.155200644023077D-7)*U+2.706881064641104D-6)
     *    *U+9.088050814470148D-6)*U+3.095027782918129D-5)
     *    *U+1.073604335435426D-4)*U+3.816948426588058D-4)
     *    *U+1.404884102286929D-3)*U+5.449091889986991D-3
      Y = ((Y*U+2.309071936165689D-2)*U+1.173605223326117D-1)*U +
     *     1.098612288668110D+0
C
C     EXPANSION (0013) EVALUATED AS Y(U)  --PRECISION 18E
C18   Y = (((((((((((((((+4.11562562746528563D-12
C18  *    *U+1.25827560334735442D-11)*U+1.69553186213991547D-11)
C18  *    *U+5.55839815646634312D-11)*U+2.30656862862373880D-10)
C18  *    *U+7.29783919704331026D-10)*U+2.25823495085547189D-9)
C18  *    *U+7.25120211830092882D-9)*U+2.34402250202697166D-8)
C18  *    *U+7.59924975285088236D-8)*U+2.47960019369643487D-7)
C18  *    *U+8.15470863860161166D-7)*U+2.70688810521453458D-6)
C18  *    *U+9.08806399318679459D-6)*U+3.09502765360147389D-5)
C18  *    *U+1.07360431516047715D-4)*U+3.81694842789365899D-4
C18   Y = ((((Y*U+1.40488410244532737D-3)*U+5.44909188998094690D-3)
C18  *    *U+2.30907193616520946D-2)*U+1.17360522332611823D-1)*U +
C18  *     1.09861228866810969D+0
C
C
      S11AAF = X*Y
      RETURN
C
   20 S11AAF = SIGN(DLOG((1.0D0+U)/((0.5D0-U)+0.5D0))*0.5D0,X)
      RETURN
C
C     ERROR 1 EXIT
   40 IFAIL = P01ABF(IFAIL,1,SRNAME,0,P01REC)
      S11AAF = 0.0D0
      RETURN
      END
