      DOUBLE PRECISION FUNCTION S15AEF(X,IFAIL)
C     MARK 4 RELEASE NAG COPYRIGHT 1974.
C     MARK 4.5 REVISED
C     MARK 8 REVISED. IER-221 (MAR 1980)
C     MARK 11.5(F77) REVISED. (SEPT 1985.)
C     MARK 14 REVISED. IER-755 (DEC 1989).
C     ERF(X)
C
C     **************************************************************
C
C     TO EXTRACT THE CORRECT CODE FOR A PARTICULAR MACHINE-RANGE,
C     ACTIVATE THE STATEMENTS CONTAINED IN COMMENTS BEGINNING  CDD ,
C     WHERE  DD  IS THE APPROXIMATE NUMBER OF SIGNIFICANT DECIMAL
C     DIGITS REPRESENTED BY THE MACHINE
C     DELETE THE ILLEGAL DUMMY STATEMENT OF THE FORM
C     * EXPANSION (DATA) *
C
C     **************************************************************
C     .. Scalar Arguments ..
      DOUBLE PRECISION                 X
      INTEGER                          IFAIL
C     .. Local Scalars ..
      DOUBLE PRECISION                 BJ, BJP1, BJP2, HALF, ONE,
     *                                 SQRTPI, THREE, TWENTY, TWO,
     *                                 X2, XUP, XV, ZERO
      INTEGER                          J, NCFC, NCFD
C     .. Local Arrays ..
C07   DOUBLE PRECISION                 C(8), D(8)
C12   DOUBLE PRECISION                 C(11), D(12)
C14   DOUBLE PRECISION                 C(15), D(15)
      DOUBLE PRECISION                 C(18), D(17)
C     .. Intrinsic Functions ..
      INTRINSIC                        ABS, EXP, SIGN
C     .. Data statements ..
C      * EXPANSION (DATA) *
C07   DATA NCFC,NCFD/8,8/,XUP/4.0D0/,SQRTPI/1.772454D0/
C07  A,C(1),C(2),C(3),C(4),C(5),C(6),C(7),C(8)
C07  A/1.944907D0,4.2019D-2,-1.8687D-2,5.129D-3,-1.068D-3
C07  A,1.74D-4,-2.1D-5,2.0D-6/
C07  A,D(1),D(2),D(3),D(4),D(5),D(6),D(7),D(8)
C07  A/1.483110D0,-3.01071D-1,6.8995D-2,-1.3916D-2,2.421D-3
C07  A,-3.66D-4,4.9D-5,-6.0D-6/
C
C12   DATA NCFC,NCFD/11,12/,XUP/5.0D0/,SQRTPI/1.7724538509D0/,C(1),
C12  * C(2),C(3),C(4),C(5),C(6),C(7),C(8),C(9),C(10),C(11)
C12  * /1.9449071068D0,4.20186582D-2,-1.86866104D-2,5.1281062D-3,
C12  * -1.0683107D-3,1.744738D-4,-2.15642D-5,1.7283D-6,-2.D-8,-1.65D-8,
C12  * 2.D-9/,D(1),D(2),D(3),D(4),D(5),D(6),D(7),D(8),D(9),
C12  * D(10),D(11),D(12)/1.4831105641D0,-3.010710734D-1,6.89948307D-2,
C12  * -1.39162713D-2,2.4207995D-3,-3.658640D-4,4.86210D-5,-5.7493D-6,
C12  * 6.113D-7,-5.90D-8,5.2D-9,-4.D-10/
C
C14   DATA NCFC,NCFD/15,15/,XUP/5.75D0/,SQRTPI/1.7724538509055D0/
C14  A,C(1),C(2),C(3),C(4),C(5),C(6),C(7),C(8),C(9),C(10)
C14  A,C(11),C(12),C(13),C(14),C(15)
C14  A/1.9449071068179D0,4.20186582324D-2,-1.86866103977D-2
C14  A,5.1281061839D-3,-1.0683107462D-3,1.744737872D-4
C14  A,-2.15642056D-5,1.7282658D-6,-2.00479D-8,-1.64782D-8
C14  A,2.0008D-9,2.58D-11,-3.06D-11,1.9D-12,4.0D-13/
C14  A,D(1),D(2),D(3),D(4),D(5),D(6),D(7),D(8),D(9),D(10)
C14  A,D(11),D(12),D(13),D(14),D(15)
C14  A/1.4831105640848D0,-3.010710733866D-1,6.89948306898D-2
C14  A,-1.39162712647D-2,2.4207995224D-3,-3.658639686D-4
C14  A,4.86209844D-5,-5.7492565D-6,6.113243D-7,-5.89910D-8
C14  A,5.2070D-9,-4.233D-10,3.19D-11,-2.2D-12,1.0D-13/
C
      DATA NCFC,NCFD/18,17/,XUP/6.25D0/,SQRTPI/1.7724538509055160D0/
     A,C(1),C(2),C(3),C(4),C(5),C(6),C(7),C(8),C(9),C(10),C(11)
     A,C(12),C(13),C(14),C(15),C(16),C(17),C(18)
     A/1.9449071068178803D0,4.20186582324414D-2,-1.86866103976769D-2
     A,5.1281061839107D-3,-1.0683107461726D-3,1.744737872522D-4
     A,-2.15642065714D-5,1.7282657974D-6,-2.00479241D-8
     A,-1.64782105D-8,2.0008475D-9,2.57716D-11,-3.06343D-11
     A,1.9158D-12,3.703D-13,-5.43D-14,-4.0D-15,1.2D-15/
     A,D(1),D(2),D(3),D(4),D(5),D(6),D(7),D(8),D(9),D(10),D(11)
     A,D(12),D(13),D(14),D(15),D(16),D(17)
     A/1.4831105640848036D0,-3.010710733865950D-1,6.89948306898316D-2
     A,-1.39162712647222D-2,2.4207995224335D-3,-3.658639685849D-4
     A,4.86209844323D-5,-5.7492565580D-6,6.113243578D-7
     A,-5.89910153D-8,5.2070091D-9,-4.232976D-10,3.18811D-11
     A,-2.2361D-12,1.467D-13,-9.0D-15,5.0D-16/
C
      DATA                             ZERO, ONE, TWO, THREE, TWENTY,
     *                                 HALF/0.0D0, 1.0D0, 2.0D0, 3.0D0,
     *                                 20.0D0, 0.5D0/
C     .. Executable Statements ..
C
C     NO FAILURE EXITS
      IFAIL = 0
      XV = ABS(X)
      IF (XV.GE.XUP) GO TO 120
      IF (XV.LE.TWO) GO TO 60
      X2 = TWO - TWENTY/(XV+THREE)
C
C     SUMMATION
      BJP2 = ZERO
      BJP1 = C(NCFC)
      J = NCFC - 1
   20 BJ = X2*BJP1 - BJP2 + C(J)
      IF (J.EQ.1) GO TO 40
      BJP2 = BJP1
      BJP1 = BJ
      J = J - 1
      GO TO 20
   40 X2 = HALF*(BJ-BJP2)/XV*EXP(-X*X)/SQRTPI
      S15AEF = (ONE-X2)*SIGN(ONE,X)
      GO TO 140
C
   60 X2 = X*X - TWO
C     SUMMATION
      BJP2 = ZERO
      BJP1 = D(NCFD)
      J = NCFD - 1
   80 BJ = X2*BJP1 - BJP2 + D(J)
      IF (J.EQ.1) GO TO 100
      BJP2 = BJP1
      BJP1 = BJ
      J = J - 1
      GO TO 80
  100 S15AEF = HALF*(BJ-BJP2)*X
      GO TO 140
C
  120 S15AEF = SIGN(ONE,X)
  140 RETURN
      END
