      DOUBLE PRECISION FUNCTION S15AFF(X,IFAIL)
C     MARK 7 RELEASE. NAG COPYRIGHT 1978.
C     MARK 11.5(F77) REVISED. (SEPT 1985.)
C     MARK 14 REVISED. IER-756 (DEC 1989).
C     DAWSONS INTEGRAL
C
C     **************************************************************
C
C     TO EXTRACT THE CORRECT CODE FOR A PARTICULAR MACHINE-RANGE,
C     ACTIVATE THE STATEMENTS CONTAINED IN COMMENTS BEGINNING  CDD ,
C     WHERE  DD  IS THE APPROXIMATE NUMBER OF SIGNIFICANT DECIMAL
C     DIGITS REPRESENTED BY THE MACHINE
C     DELETE THE ILLEGAL DUMMY STATEMENTS OF THE FORM
C     * EXPANSION (NNNN) *
C
C     ALSO INSERT APPROPRIATE DATA STATEMENTS TO DEFINE CONSTANTS
C     WHICH DEPEND ON THE RANGE OF NUMBERS REPRESENTED BY THE
C     MACHINE, RATHER THAN THE PRECISION (SUITABLE STATEMENTS FOR
C     SOME MACHINES ARE CONTAINED IN COMMENTS BEGINNING CRD WHERE
C     D IS A DIGIT WHICH SIMPLY DISTINGUISHES A GROUP OF MACHINES).
C     DELETE THE ILLEGAL DUMMY DATA STATEMENTS WITH VALUES WRITTEN
C     *VALUE*
C
C     **************************************************************
C
C     .. Scalar Arguments ..
      DOUBLE PRECISION                 X
      INTEGER                          IFAIL
C     .. Local Scalars ..
      DOUBLE PRECISION                 T, U, XMAX, XMIN, XMXINV, Y
C     .. Intrinsic Functions ..
      INTRINSIC                        ABS
C     .. Data statements ..
C08   DATA XMIN,XMAX/1.0D-4,1.0D+4/
C09   DATA XMIN,XMAX/3.1D-5,3.2D+4/
C12   DATA XMIN,XMAX/1.0D-6,1.0D+6/
C15   DATA XMIN,XMAX/3.1D-8,3.2D+7/
      DATA XMIN,XMAX/3.1D-9,3.2D+8/
C19   DATA XMIN,XMAX/3.1D-10,3.2D+9/
C
C     THE FOLLOWING DATA STATEMENT IS ONLY REQUIRED ON MACHINES
C     WHERE  MAXREAL .GT. 0.5/MINREAL.  FOR SUCH MACHINES, CODE
C     AFTER LABEL 60 MUST ALSO BE ACTIVATED.
      DATA XMXINV / 2.24D+307 /
C     XMXINV = 0.5/MINREAL  (ROUNDED DOWN)
C     FOR IEEE SINGLE PRECISION
CR0   DATA XMXINV /4.25E+37/
C     FOR CDC 7600/CYBER
CR4   DATA XMXINV /1.59D+293/
C     FOR IEEE DOUBLE PRECISION
CR7   DATA XMXINV /2.24D+307/
C     FOR BURROUGHS B6700
CR6   DATA XMXINV /1.42D+45/
C     .. Executable Statements ..
C
C     NO ACTUAL FAILURE EXITS
C
      IFAIL = 0
      IF (X.NE.0.0D0) GO TO 20
      S15AFF = 0.0D0
      RETURN
C     TEST FOR X RANGE
   20 U = ABS(X)
      IF (U.GT.4.0D0) GO TO 60
C     TEST FOR VERY SMALL X
      IF (U.GT.XMIN) GO TO 40
      S15AFF = X
      RETURN
C     ARGUMENT EVALUATION
   40 T = X*X*0.125D0 - 1.0D0
C
C      * EXPANSION (0024) *
C
C     EXPANSION (0024) EVALUATED AS Y(T)  --PRECISION 08E.09
C08   Y = (((((((((((((((-2.09800160D-4*T+5.36916665D-4)
C08  *    *T-3.13605869D-4)*T+6.25672489D-4)*T-3.12886745D-3)
C08  *    *T+6.35381618D-3)*T-9.99857151D-3)*T+1.73964810D-2)
C08  *    *T-2.96098131D-2)*T+4.50688167D-2)*T-6.30097782D-2)
C08  *    *T+8.18718057D-2)*T-9.80908408D-2)*T+1.08098213D-1)
C08  *    *T-1.10083295D-1)*T+1.04701361D-1)*T-9.47947994D-2
C08   Y = ((Y*T+8.39163439D-2)*T-7.45921281D-2)*T + 6.75990738D-2
C
C     EXPANSION (0024) EVALUATED AS Y(T)  --PRECISION 09E.10
C09   Y = (((((((((((((((-2.798439617D-5*T+7.832077928D-5)
C09  *    *T-6.288207978D-5)*T+1.453127682D-4)*T-6.441715483D-4)
C09  *    *T+1.457830769D-3)*T-2.712599552D-3)*T+5.374806440D-3)
C09  *    *T-1.031995481D-2)*T+1.809249574D-2)*T-2.945313879D-2)
C09  *    *T+4.476257019D-2)*T-6.305765095D-2)*T+8.195383600D-2)
C09  *    *T-9.808204787D-2)*T+1.080855927D-1)*T-1.100841830D-1
C09   Y = ((((Y*T+1.047023468D-1)*T-9.479475827D-2)*T+8.391631398D-2)
C09  *    *T-7.459212862D-2)*T + 6.759907396D-2
C
C     EXPANSION (0024) EVALUATED AS Y(T)  --PRECISION 12E.13
C12   Y = (((((((((((((((+9.976655424629D-7
C12  *    *T-3.153584150420D-6)*T+3.600553472709D-6)
C12  *    *T-9.851287303149D-6)*T+4.130800457634D-5)
C12  *    *T-1.082148519471D-4)*T+2.468424781458D-4)
C12  *    *T-5.795723479797D-4)*T+1.312424541147D-3)
C12  *    *T-2.770398836563D-3)*T+5.500549630943D-3)
C12  *    *T-1.028623856473D-2)*T+1.802355480575D-2)
C12  *    *T-2.946603029392D-2)*T+4.478666918873D-2)
C12  *    *T-6.305448562179D-2)*T+8.194860755824D-2
C12   Y = (((((((Y*T-9.808252267205D-2)*T+1.080862525175D-1)
C12  *    *T-1.100841433928D-1)*T+1.047023042049D-1)
C12  *    *T-9.479475978922D-2)*T+8.391631505225D-2)
C12  *    *T-7.459212860304D-2)*T + 6.759907395335D-2
C
C     EXPANSION (0024) EVALUATED AS Y(T)  --PRECISION 15E.16
C15   Y = (((((((((((((((+6.942808431660248D-9
C15  *    *T-2.532612228079977D-8)*T+4.069450180977151D-8)
C15  *    *T-1.329999522629561D-7)*T+5.691274315014095D-7)
C15  *    *T-1.766742641241862D-6)*T+4.989790063871063D-6)
C15  *    *T-1.417439394363051D-5)*T+3.885098253020314D-5)
C15  *    *T-1.009320632654470D-4)*T+2.495801606428295D-4)
C15  *    *T-5.872325984360481D-4)*T+1.310388553506182D-3)
C15  *    *T-2.765077706156866D-3)*T+5.501582407047025D-3)
C15  *    *T-1.028872598008210D-2)*T+1.802319769479049D-2
C15   Y = (((((((((((Y*T-2.946525181479228D-2)
C15  *    *T+4.478675170269773D-2)
C15  *    *T-6.305464438185731D-2)*T+8.194859534429811D-2)
C15  *    *T-9.808250269234224D-2)*T+1.080862535918663D-1)
C15  *    *T-1.100841447990752D-1)*T+1.047023041558410D-1)
C15  *    *T-9.479475974335326D-2)*T+8.391631505312465D-2)
C15  *    *T-7.459212860347920D-2)*T + 6.759907395335052D-2
C
C     EXPANSION (0024) EVALUATED AS Y(T)  --PRECISION 17E.18
      Y = (((((((((((((((+4.73110787583905890D-10
     *    *T-1.84156612203899571D-9)*T+3.39447752478095416D-9)
     *    *T-1.19747678960170492D-8)*T+5.26701186204891318D-8)
     *    *T-1.76391854013499939D-7)*T+5.45102274319414278D-7)
     *    *T-1.68329667633696962D-6)*T+5.02166959936255662D-6)
     *    *T-1.42799530892351998D-5)*T+3.88215258394090029D-5)
     *    *T-1.00839699013042906D-4)*T+2.49599593876339565D-4)
     *    *T-5.87289824114168026D-4)*T+1.31037931970268204D-3)
     *    *T-2.76505243767561823D-3)*T+5.50158555493458225D-3
      Y = (((((((((((((Y*T-1.02887338764824911D-2)
     *    *T+1.80231969369657062D-2)
     *    *T-2.94652501039055316D-2)*T+4.47867518277388141D-2)
     *    *T-6.30546446294856549D-2)*T+8.19485953308367479D-2)
     *    *T-9.80825026698305700D-2)*T+1.08086253592738758D-1)
     *    *T-1.10084144800233882D-1)*T+1.04702304155811420D-1)
     *    *T-9.47947597433254029D-2)*T+8.39163150531250491D-2)
     *    *T-7.45921286034793947D-2)*T + 6.75990739533505166D-2
C
C     EXPANSION (0024) EVALUATED AS Y(T)  --PRECISION 19E.20
C19   Y = (((((((((((((((+2.8478208705453621248D-11
C19  *    *T-1.1783509332983808000D-10)*T+2.4528511794027692032D-10)
C19  *    *T-9.2834414873275059405D-10)*T+4.2203455772391091732D-9)
C19  *    *T-1.5171044802588907143D-8)*T+5.0875991472045553615D-8)
C19  *    *T-1.6971391833369802179D-7)*T+5.4770536058389714803D-7)
C19  *    *T-1.6925715870033611692D-6)*T+5.0190086667366408022D-6)
C19  *    *T-1.4270927887702134208D-5)*T+3.8823495952987805923D-5)
C19  *    *T-1.0084601665411605194D-4)*T+2.4959852438611107194D-4)
C19  *    *T-5.8728660888612187171D-4)*T+1.3103797458276949541D-3
C19   Y = (((((((((((((((Y*T-2.7650536259120700698D-3)
C19  *    *T+5.5015854314200857482D-3)
C19  *    *T-1.0288733561419795531D-2)*T+1.8023196962510749810D-2)
C19  *    *T-2.9465250162417175087D-2)*T+4.4786751824089522203D-2)
C19  *    *T-6.3054644622171699473D-2)*T+8.1948595331178869059D-2)
C19  *    *T-9.8082502670407987515D-2)*T+1.0808625359271936655D-1)
C19  *    *T-1.1008414480020797257D-1)*T+1.0470230415581199688D-1)
C19  *    *T-9.4794759743325947236D-2)*T+8.3916315053125042275D-2)
C19  *    *T-7.4592128603479391295D-2)*T + 6.7599073953350516629D-2
C
      S15AFF = X*Y
      RETURN
C     TEST FOR VERY LARGE X
   60 IF (U.LT.XMAX) GO TO 80
C
C     THE FOLLOWING CODE MUST BE ACTIVATED ON MACHINES WHERE
C     MAXREAL .GT. 0.5/MINREAL (TO AVOID UNDERFLOW).
C
      IF (U.LT.XMXINV) GO TO 70
      S15AFF = 0.0D0
      RETURN
   70 CONTINUE
      S15AFF = 0.5D0/X
      RETURN
C     ARGUMENT EVALUATION
   80 T = 32.0D0/(X*X) - 1.0D0
C
C      * EXPANSION (0025) *
C
C     EXPANSION (0025) EVALUATED AS Y(T)  --PRECISION 08E.09
C08   Y = ((((((((-2.43371058D-8)*T+1.83488672D-7)*T+7.43407766D-7)
C08  *    *T+1.85195050D-6)*T+7.45910480D-6)*T+4.78915290D-5)
C08  *    *T+4.76838054D-4)*T+8.64607582D-3)*T + 5.08210986D-1
C
C     EXPANSION (0025) EVALUATED AS Y(T)  --PRECISION 09E.10
C09   Y = ((((((((((-5.270604165D-8)*T-7.930318040D-8)
C09  *    *T+1.074279983D-7)*T+3.619208280D-7)*T+6.281132996D-7)
C09  *    *T+1.718126379D-6)*T+7.500281399D-6)*T+4.792870235D-5)
C09  *    *T+4.768329068D-4)*T+8.646073029D-3)*T + 5.082109864D-1
C
C     EXPANSION (0025) EVALUATED AS Y(T)  --PRECISION 12E.13
C12   Y = ((((((((((((((((+3.218610764409D-9*T-1.451996226075D-9)
C12  *    *T-2.057775064559D-8)*T+3.740636787364D-9)
C12  *    *T+6.223172635000D-8)*T+1.533503829456D-8)
C12  *    *T-1.078199664122D-7)*T-1.072810612878D-7)
C12  *    *T+3.019398532227D-8)*T+1.696564283652D-7)
C12  *    *T+2.983565577849D-7)*T+5.960016851975D-7)
C12  *    *T+1.737778995608D-6)*T+7.507751024269D-6)
C12  *    *T+4.792594517104D-5)*T+4.768322711876D-4)
C12  *    *T+8.646073144686D-3)*T + 5.082109864491D-1
C
C     EXPANSION (0025) EVALUATED AS Y(T)  --PRECISION 15E.16
C15   Y = (((((((((((((((-5.296096616199676D-10
C15  *    *T-5.032879826102554D-10)*T+3.985385894716396D-9)
C15  *    *T+3.694719058089324D-9)*T-1.398066018878370D-8)
C15  *    *T-1.295651550566729D-8)*T+3.073305913156835D-8)
C15  *    *T+3.019579392269961D-8)*T-4.764583213522984D-8)
C15  *    *T-5.613024734768150D-8)*T+5.176526226498771D-8)
C15  *    *T+9.257700428196641D-8)*T-1.863716887363830D-8)
C15  *    *T-1.246097404353762D-7)*T-9.139889806878578D-8)
C15  *    *T+3.609545782445589D-8)*T+1.649627015749513D-7
C15   Y = (((((((Y*T+2.970999996830943D-7)*T+5.968169966278101D-7)
C15  *    *T+1.737926859487363D-6)*T+7.507677974299260D-6)
C15  *    *T+4.792593715289753D-5)*T+4.768322737575980D-4)
C15  *    *T+8.646073144814329D-3)*T + 5.082109864490418D-1
C
C     EXPANSION (0025) EVALUATED AS Y(T)  --PRECISION 17E.18
      Y = (((((((((((((((+2.74025015401477308D-10
     *    *T-1.92777411862777037D-10)*T-2.30082253585696739D-9)
     *    *T+1.68458106112580151D-9)*T+8.95290316416285986D-9)
     *    *T-6.92502020367956994D-9)*T-2.16297541013440026D-8)
     *    *T+1.80075901126820663D-8)*T+3.70364318218408061D-8)
     *    *T-3.37996293801057122D-8)*T-4.97301908488584026D-8)
     *    *T+4.97624015903312482D-8)*T+5.90832390144876555D-8)
     *    *T-6.03608014702259991D-8)*T-7.23521212676254469D-8)
     *    *T+5.77122948307144822D-8)*T+9.90333958007913327D-8
      Y = ((((((((((((Y*T-2.05663666463271863D-8)
     *    *T-1.26392804533869908D-7)
     *    *T-9.09755613786389276D-8)*T+3.64246653663605826D-8)
     *    *T+1.64902654547901545D-7)*T+2.97061775695647310D-7)
     *    *T+5.96822092643564129D-7)*T+1.73792937740632787D-6)
     *    *T+7.50767774865078295D-6)*T+4.79259370751892485D-5)
     *    *T+4.76832273761536912D-4)*T+8.64607314481504465D-3)*T +
     *     5.08210986449041748D-1
C
C     EXPANSION (0025) EVALUATED AS Y(T)  --PRECISION 19E.20
C19   Y = (((((((((((((((+1.1278710291691261133D-10
C19  *    *T-1.2882580408354891366D-10)*T-1.0858184423946993009D-9)
C19  *    *T+1.3149252980811906417D-9)*T+4.7930964458099263406D-9)
C19  *    *T-6.2924831570700355502D-9)*T-1.2773454058162573279D-8)
C19  *    *T+1.8822686016746643522D-8)*T+2.2594114531744060277D-8)
C19  *    *T-3.9651801963219652706D-8)*T-2.6830834541286253396D-8)
C19  *    *T+6.3006571758671068398D-8)*T+1.8540547685630655594D-8)
C19  *    *T-7.9394354969235060425D-8)*T+1.9039648141211661763D-9)
C19  *    *T+8.3256569901661473997D-8)*T-2.6918051153501878223D-8
C19   Y = (((((((((((((((Y*T-7.7554658766593741554D-8)
C19  *    *T+4.8088390495736073421D-8)
C19  *    *T+7.1653010156336624632D-8)*T-6.0363198362031315649D-8)
C19  *    *T-7.6571929332062520361D-8)*T+5.7881893987748302709D-8)
C19  *    *T+1.0006752712366737069D-7)*T-2.0633575211318338570D-8)
C19  *    *T-1.2657267641625276635D-7)*T-9.0961541933240498256D-8)
C19  *    *T+3.6445941977530196839D-8)*T+1.6490092654408674006D-7)
C19  *    *T+2.9706017309701417732D-7)*T+5.9682221471958218039D-7)
C19  *    *T+1.7379294464684766347D-6)*T+7.5076777442598529937D-6
C19   Y = (((Y*T+4.7925937073788371901D-5)
C19  *    *T+4.7683227376159817169D-4)
C19  *    *T+8.6460731448150531421D-3)*T + 5.0821098644904174772D-1
C
      S15AFF = Y/X
      RETURN
      END
