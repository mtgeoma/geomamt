      DOUBLE PRECISION FUNCTION S13ADF(X,IFAIL)
C     MARK 5A REVISED - NAG COPYRIGHT 1976
C     MARK 11.5(F77) REVISED. (SEPT 1985.)
C     MARK 14 REVISED. IER-752 (DEC 1989).
C     SINE INTEGRAL  SI(X)
C
C     .. Scalar Arguments ..
      DOUBLE PRECISION                 X
      INTEGER                          IFAIL
C     .. Local Scalars ..
      DOUBLE PRECISION                 F, G, PIB2, T, U, XHI, Y
C     .. Intrinsic Functions ..
      INTRINSIC                        ABS, COS, SIGN, SIN
C     .. Data statements ..
C     PRECISION DEPENDENT CONSTANTS
C08   DATA XHI,PIB2/1.0D9,1.5707963D0/
C12   DATA XHI,PIB2/1.0D13,1.57079632679D0/
C14   DATA XHI,PIB2/1.0D15,1.5707963267949D0/
      DATA XHI,PIB2/1.0D17,1.570796326794897D0/
C18   DATA XHI,PIB2/1.0D19,1.57079632679489662D0/
C     .. Executable Statements ..
C
C     NO ERROR EXITS
      IFAIL = 0
C
C     LARGE RANGE TEST
      U = ABS(X)
      IF (U.GT.16.0D0) GO TO 20
C
C     SMALL X - ARGUMENT EVALUATION
      T = X*X*7.8125D-3 - 1.0D0
C
C      * EXPANSION (0017) *
C
C     EXPANSION (0017) EVALUATED AS Y(T)  --PRECISION 08E
C08   Y = ((((((((((((((+1.7049016D-4)*T-1.0170646D-3)*T+4.5770792D-3)
C08  *    *T-1.8804566D-2)*T+6.3258185D-2)*T-1.6520838D-1)
C08  *    *T+3.1827386D-1)*T-4.0415056D-1)*T+2.2943598D-1)
C08  *    *T+1.6198125D-1)*T-3.3427147D-1)*T+8.8684315D-2)
C08  *    *T+1.3247360D-1)*T-1.1050680D-1)*T + 1.3706047D-1
C
C     EXPANSION (0017) EVALUATED AS Y(T)  --PRECISION 12E
C12   Y = (((((((((((((((+3.42865899820D-8*T-3.46970611411D-7)
C12  *    *T+2.96352310435D-6)*T-2.32038522775D-5)
C12  *    *T+1.58308199534D-4)*T-9.27100942644D-4)
C12  *    *T+4.59705246594D-3)*T-1.89409860495D-2)
C12  *    *T+6.32412090102D-2)*T-1.65103610069D-1)
C12  *    *T+3.18281837944D-1)*T-4.04193558969D-1)
C12  *    *T+2.29433945283D-1)*T+1.61990303868D-1)
C12  *    *T-3.34271212966D-1)*T+8.86834755513D-2)
C12  *    *T+1.32473585261D-1
C12   Y = (Y*T-1.10506776682D-1)*T + 1.37060472876D-1
C
C     EXPANSION (0017) EVALUATED AS Y(T)  --PRECISION 14E
C14   Y = (((((((((((((((-3.0296888499984D-9*T+3.4286589981972D-8)
C14  *    *T-3.3257958937359D-7)*T+2.9635231043479D-6)
C14  *    *T-2.3232634321618D-5)*T+1.5830819953436D-4)
C14  *    *T-9.2706946228348D-4)*T+4.5970524659417D-3)
C14  *    *T-1.8941006511729D-2)*T+6.3241209010218D-2)
C14  *    *T-1.6510360203074D-1)*T+3.1828183794422D-1)
C14  *    *T-4.0419356082438D-1)*T+2.2943394528302D-1)
C14  *    *T+1.6199030409943D-1)*T-3.3427121296649D-1)
C14  *    *T+8.8683475538137D-2
C14   Y = ((Y*T+1.3247358526095D-1)*T-1.1050677668139D-1)
C14  *    *T + 1.3706047287635D-1
C
C     EXPANSION (0017) EVALUATED AS Y(T)  --PRECISION 16E
      Y = (((((((((((((((+2.408885682450884D-10
     *    *T-3.029688849998370D-9)*T+3.308214714074615D-8)
     *    *T-3.325795893735864D-7)*T+2.966082545385467D-6)
     *    *T-2.323263432161826D-5)*T+1.583051884272567D-4)
     *    *T-9.270694622834814D-4)*T+4.597054606650696D-3)
     *    *T-1.894100651172915D-2)*T+6.324120806830593D-2)
     *    *T-1.651036020307420D-1)*T+3.182818381965181D-1)
     *    *T-4.041935608243848D-1)*T+2.294339452442039D-1)
     *    *T+1.619903040994258D-1)*T-3.342712129634582D-1
      Y = (((Y*T+8.868347553813718D-2)*T+1.324735852608597D-1)
     *    *T-1.105067766813852D-1)*T + 1.370604728763501D-1
C
C     EXPANSION (0017) EVALUATED AS Y(T)  --PRECISION 18E
C18   Y = (((((((((((((((+1.13364013523612467D-12
C18  *    *T-1.73295770867796541D-11)*T+2.34653547501289734D-10)
C18  *    *T-2.93870857029277660D-9)*T+3.30969553150126728D-8)
C18  *    *T-3.32784295002924013D-7)*T+2.96606267125684584D-6)
C18  *    *T-2.32323765441590923D-5)*T+1.58305204989030543D-4)
C18  *    *T-9.27069661302843286D-4)*T+4.59705459778527538D-3)
C18  *    *T-1.89410064147072063D-2)*T+6.32412080713534156D-2)
C18  *    *T-1.65103602060387617D-1)*T+3.18281838195865030D-1)
C18  *    *T-4.04193560818939660D-1)*T+2.29433945244285525D-1
C18   Y = (((((Y*T+1.61990304098876091D-1)*T-3.34271212963463397D-1)
C18  *    *T+8.86834755381626329D-2)*T+1.32473585260859799D-1)
C18  *    *T-1.10506776681385560D-1)*T + 1.37060472876350089D-1
C
C
      S13ADF = X*Y
      RETURN
C
C     LARGE X - ARGUMENT EVALUATION
   20 IF (U.GE.XHI) GO TO 40
      Y = X*X
      T = 512.0D0/Y - 1.0D0
C
C      * EXPANSION (0019) *
C
C     EXPANSION (0019) EVALUATED AS F(T)  --PRECISION 08E
C08   F = ((((+3.0159308D-7)*T-3.7549003D-6)*T+7.8218589D-5)
C08  *    *T-3.7372805D-3)*T + 9.9618044D-1
C
C     EXPANSION (0019) EVALUATED AS F(T)  --PRECISION 12E
C12   F = ((((((((+2.18730111947D-10)*T-9.87195648721D-10)
C12  *    *T+4.84033743417D-9)*T-3.31129990890D-8)
C12  *    *T+2.93949795147D-7)*T-3.71221333201D-6)
C12  *    *T+7.82215026550D-5)*T-3.73729126678D-3)*T +
C12  *     9.96180441908D-1
C
C     EXPANSION (0019) EVALUATED AS F(T)  --PRECISION 14E
C14   F = ((((((((((+1.5955106693333D-11)*T-5.5714992702494D-11)
C14  *    *T+1.7884234521333D-10)*T-8.6183691514048D-10)
C14  *    *T+4.8752392300591D-9)*T-3.3207018139177D-8)
C14  *    *T+2.9393733021989D-7)*T-3.7121872156051D-6)
C14  *    *T+7.8221504213102D-5)*T-3.7372912687427D-3)*T +
C14  *     9.9618044190789D-1
C
C     EXPANSION (0019) EVALUATED AS F(T)  --PRECISION 16E
      F = (((((((((((((-6.487820803229041D-13)*T+1.742662974813055D-12)
     *    *T-2.941068638271440D-12)*T+1.072711776889383D-11)
     *    *T-4.446424130567387D-11)*T+1.847238327533211D-10)
     *    *T-8.741419374178216D-10)*T+4.872189569853223D-9)
     *    *T-3.320140407017584D-8)*T+2.939380449839969D-7)
     *    *T-3.712188242826874D-6)*T+7.822150415183696D-5)
     *    *T-3.737291268690489D-3)*T + 9.961804419078865D-1
C
C     EXPANSION (0019) EVALUATED AS F(T)  --PRECISION 18E
C18   F = ((((((((((((((((+4.86990663727841280D-14)
C18  *    *T-1.09176921093439488D-13)*T+6.34989883577057280D-14)
C18  *    *T-2.39368626222505984D-13)*T+1.15517351776520397D-12)
C18  *    *T-3.55518881942203699D-12)*T+1.17023188129910753D-11)
C18  *    *T-4.39951217228505001D-11)*T+1.84001853732121956D-10)
C18  *    *T-8.74333849974431170D-10)*T+4.87245424704650801D-9)
C18  *    *T-3.32013637685389532D-8)*T+2.93937999539516224D-7)
C18  *    *T-3.71218824655850721D-6)*T+7.82215041547366874D-5)
C18  *    *T-3.73729126869038934D-3)*T + 9.96180441907886510D-1
C
C
C      * EXPANSION (0020) *
C
C     EXPANSION (0020) EVALUATED AS G(T)  --PRECISION 08E
C08   G = (((((-3.2605673D-7)*T+2.3945267D-6)*T-2.3623892D-5)
C08  *    *T+3.6880340D-4)*T-1.0898989D-2)*T + 9.8870586D-1
C
C     EXPANSION (0020) EVALUATED AS G(T)  --PRECISION 12E
C12   G = (((((((((-7.86311811853D-10)*T+2.85167855920D-9)
C12  *    *T-9.97241803495D-9)*T+5.06204309139D-8)
C12  *    *T-3.06835791943D-7)*T+2.31360560292D-6)
C12  *    *T-2.36337972334D-5)*T+3.68834368710D-4)
C12  *    *T-1.08989877903D-2)*T + 9.88705859371D-1
C
C     EXPANSION (0020) EVALUATED AS G(T)  --PRECISION 14E
C14   G = ((((((((((((+2.9651791738191D-11)*T-8.1274519104934D-11)
C14  *    *T+1.5244369660008D-10)*T-5.6280688431483D-10)
C14  *    *T+2.3482556767751D-9)*T-1.0195922962487D-8)
C14  *    *T+5.1096600747956D-8)*T-3.0673800853768D-7)
C14  *    *T+2.3134291717659D-6)*T-2.3633814694710D-5)
C14  *    *T+3.6883439124165D-4)*T-1.0898987789417D-2)*T +
C14  *     9.8870585937051D-1
C
C     EXPANSION (0020) EVALUATED AS G(T)  --PRECISION 16E
      G = (((((((((((((((-2.134526069276983D-12)
     *    *T+4.840233971123487D-12)*T-3.605540496408867D-12)
     *    *T+1.271097283925905D-11)*T-5.554868516197534D-11)
     *    *T+1.757373225861146D-10)*T-6.008007714642121D-10)
     *    *T+2.332373659057313D-9)*T-1.017137565178131D-8)
     *    *T+5.110215945415727D-8)*T-3.067454745911935D-7)
     *    *T+2.313428245314906D-6)*T-2.363381373591827D-5)
     *    *T+3.688343912995559D-4)*T-1.089898778945207D-2)*T +
     *     9.887058593705057D-1
C
C     EXPANSION (0020) EVALUATED AS G(T)  --PRECISION 18E
C18   G = (((((((((((((((+2.43669269913534464D-13
C18  *    *T-4.81013570050588672D-13)*T-1.06265802930487296D-13)
C18  *    *T-9.02183965619814400D-14)*T+2.93520978929726259D-12)
C18  *    *T-7.18307892366012006D-12)*T+1.70687678062319268D-11)
C18  *    *T-5.22266851938134641D-11)*T+1.71515979253039184D-10)
C18  *    *T-6.02557598370451512D-10)*T+2.33450259515872927D-9)
C18  *    *T-1.01708486037094415D-8)*T+5.11015920578187682D-8)
C18  *    *T-3.06745558439750417D-7)*T+2.31342831851492447D-6)
C18  *    *T-2.36338137299290861D-5)*T+3.68834391295988884D-4
C18   G = (G*T-1.08989877894521955D-2)*T + 9.88705859370505720D-1
C
C
      S13ADF = SIGN(PIB2-COS(U)*F/U-SIN(U)*G/Y,X)
      RETURN
   40 S13ADF = SIGN(PIB2,X)
      RETURN
C
      END
