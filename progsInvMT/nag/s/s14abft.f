      DOUBLE PRECISION FUNCTION S14ABF(X,IFAIL)
C     MARK 8 RELEASE. NAG COPYRIGHT 1979.
C     MARK 11.5(F77) REVISED. (SEPT 1985.)
C        LNGAMMA(X) FUNCTION
C        ABRAMOWITZ AND STEGUN  CH.6
C
C     **************************************************************
C
C     TO EXTRACT THE CORRECT CODE FOR A PARTICULAR MACHINE-RANGE,
C     ACTIVATE THE STATEMENTS CONTAINED IN COMMENTS BEGINNING  CDD ,
C     WHERE  DD  IS THE APPROXIMATE NUMBER OF SIGNIFICANT DECIMAL
C     DIGITS REPRESENTED BY THE MACHINE
C     DELETE THE ILLEGAL DUMMY STATEMENTS OF THE FORM
C     * EXPANSION (NNNN) *
C
C     ALSO INSERT APPROPRIATE DATA STATEMENTS TO DEFINE CONSTANTS
C     WHICH DEPEND ON THE RANGE OF NUMBERS REPRESENTED BY THE
C     MACHINE, RATHER THAN THE PRECISION (SUITABLE STATEMENTS FOR
C     SOME MACHINES ARE CONTAINED IN COMMENTS BEGINNING CRD WHERE
C     D IS A DIGIT WHICH SIMPLY DISTINGUISHES A GROUP OF MACHINES).
C     DELETE THE ILLEGAL DUMMY DATA STATEMENTS WITH VALUES WRITTEN
C     *VALUE*
C
C     **************************************************************
C
C        IMPLEMENTATION DEPENDENT CONSTANTS
C
C        IF(X.LT.XSMALL)GAMMA(X)=1/X
C             I.E.   XSMALL*EULGAM.LE.XRELPR
C        LNGAM(XVBIG)=GBIG.LE.XOVFLO
C        LNR2PI=LN(SQRT(2*PI))
C        IF(X.GT.XBIG)LNGAM(X)=(X-0.5)LN(X)-X+LNR2PI
C
C     .. Parameters ..
      CHARACTER*6                      SRNAME
      PARAMETER                        (SRNAME='S14ABF')
C     .. Scalar Arguments ..
      DOUBLE PRECISION                 X
      INTEGER                          IFAIL
C     .. Local Scalars ..
      DOUBLE PRECISION                 G, GBIG, LNR2PI, T, XBIG, XSMALL,
     *                                 XVBIG, Y
      INTEGER                          I, M
C     .. Local Arrays ..
      CHARACTER*1                      P01REC(1)
C     .. External Functions ..
      INTEGER                          P01ABF
      EXTERNAL                         P01ABF
C     .. Intrinsic Functions ..
      INTRINSIC                        LOG, DBLE
C     .. Data statements ..
C08   DATA XSMALL,XBIG,LNR2PI/
C08  *1.0D-8,1.2D+3,9.18938533D-1/
C09   DATA XSMALL,XBIG,LNR2PI/
C09  *1.0D-9,4.8D+3,9.189385332D-1/
C12   DATA XSMALL,XBIG,LNR2PI/
C12  *1.0D-12,3.7D+5,9.189385332047D-1/
C15   DATA XSMALL,XBIG,LNR2PI/
C15  *1.0D-15,6.8D+6,9.189385332046727D-1/
      DATA XSMALL,XBIG,LNR2PI/
     *1.0D-17,7.7D+7,9.18938533204672742D-1/
C19   DATA XSMALL,XBIG,LNR2PI/
C19  *1.0D-19,3.1D+8,9.189385332046727418D-1/
C
C     RANGE DEPENDENT CONSTANTS
      DATA XVBIG,GBIG/2.55D+305,1.79D+308/
C     FOR IEEE SINGLE PRECISION
CR0   DATA XVBIG,GBIG/4.08E+36,3.40E+38/
C     FOR IBM 360/370 AND SIMILAR MACHINES
CR1   DATA XVBIG,GBIG/4.29D+73,7.231D+75/
C     FOR DEC10, HONEYWELL, UNIVAC 1100 (S.P.)
CR2   DATA XVBIG,GBIG/2.05D36,1.69D38/
C     FOR ICL 1900
CR3   DATA XVBIG,GBIG/3.39D+74,5.784D+76/
C     FOR CDC 7600/CYBER
CR4   DATA XVBIG,GBIG/1.72D+319,1.26D+322/
C     FOR UNIVAC 1100 (D.P.)
CR5   DATA XVBIG,GBIG/1.28D305,8.98D+307/
C     FOR IEEE DOUBLE PRECISION
CR7   DATA XVBIG,GBIG/2.54D+305,1.79D+308/
C     .. Executable Statements ..
      IF (X.GT.XSMALL) GO TO 20
C        VERY SMALL RANGE
      IF (X.LE.0.0D0) GO TO 160
      IFAIL = 0
      S14ABF = -LOG(X)
      GO TO 200
C
   20 IF (X.GT.15.0D0) GO TO 120
C        MAIN SMALL X RANGE
      M = X
      T = X - DBLE(M)
      M = M - 1
      G = 1.0D0
      IF (M) 40, 100, 60
   40 G = G/X
      GO TO 100
   60 DO 80 I = 1, M
         G = (X-DBLE(I))*G
   80 CONTINUE
  100 T = 2.0D0*T - 1.0D0
C
C      * EXPANSION (0026) *
C
C     EXPANSION (0026) EVALUATED AS Y(T)  --PRECISION 08E.09
C08   Y = (((((((((((+1.88278283D-6*T-5.48272091D-6)*T+1.03144033D-5)
C08  *    *T-3.13088821D-5)*T+1.01593694D-4)*T-2.98340924D-4)
C08  *    *T+9.15547391D-4)*T-2.42216251D-3)*T+9.04037536D-3)
C08  *    *T-1.34119055D-2)*T+1.03703361D-1)*T+1.61692007D-2)*T +
C08  *    8.86226925D-1
C
C     EXPANSION (0026) EVALUATED AS Y(T)  --PRECISION 09E.10
C09   Y = ((((((((((((-6.463247484D-7*T+1.882782826D-6)
C09  *    *T-3.382165478D-6)*T+1.031440334D-5)*T-3.393457634D-5)
C09  *    *T+1.015936944D-4)*T-2.967655076D-4)*T+9.155473906D-4)
C09  *    *T-2.422622002D-3)*T+9.040375355D-3)*T-1.341184808D-2)
C09  *    *T+1.037033609D-1)*T+1.616919866D-2)*T + 8.862269255D-1
C
C     EXPANSION (0026) EVALUATED AS Y(T)  --PRECISION 12E.13
C12   Y = ((((((((((((((((-8.965837291520D-9*T+2.612707393536D-8)
C12  *    *T-3.802866827264D-8)*T+1.173294768947D-7)
C12  *    *T-4.275076254106D-7)*T+1.276176602829D-6)
C12  *    *T-3.748495971011D-6)*T+1.123829871408D-5)
C12  *    *T-3.364018663166D-5)*T+1.009331480887D-4)
C12  *    *T-2.968895120407D-4)*T+9.157850115110D-4)
C12  *    *T-2.422595461409D-3)*T+9.040335037321D-3)
C12  *    *T-1.341185056618D-2)*T+1.037033634184D-1)
C12  *    *T+1.616919872437D-2)*T + 8.862269254528D-1
C
C     EXPANSION (0026) EVALUATED AS Y(T)  --PRECISION 15E.16
C15   Y = (((((((((((((((-1.243191705600000D-10*T+
C15  *    3.622882508800000D-10)*T-4.030909644800000D-10)
C15  *    *T+1.265236705280000D-9)*T-5.419466096640000D-9)
C15  *    *T+1.613133578240000D-8)*T-4.620920340480000D-8)
C15  *    *T+1.387603440435200D-7)*T-4.179652784537600D-7)
C15  *    *T+1.253148247777280D-6)*T-3.754930502328320D-6)
C15  *    *T+1.125234962812416D-5)*T-3.363759801664768D-5)
C15  *    *T+1.009281733953869D-4)*T-2.968901194293069D-4)
C15  *    *T+9.157859942174304D-4)*T-2.422595384546340D-3
C15   Y = ((((Y*T+9.040334940477911D-3)*T-1.341185057058971D-2)
C15  *    *T+1.037033634220705D-1)*T+1.616919872444243D-2)*T +
C15  *    8.862269254527580D-1
C
C     EXPANSION (0026) EVALUATED AS Y(T)  --PRECISION 17E.18
      Y = (((((((((((((((-1.46381209600000000D-11*T+
     *    4.26560716800000000D-11)*T-4.01499750400000000D-11)
     *    *T+1.27679856640000000D-10)*T-6.13513953280000000D-10)
     *    *T+1.82243164160000000D-9)*T-5.11961333760000000D-9)
     *    *T+1.53835215257600000D-8)*T-4.64774927155200000D-8)
     *    *T+1.39383522590720000D-7)*T-4.17808776355840000D-7)
     *    *T+1.25281466396672000D-6)*T-3.75499034136576000D-6)
     *    *T+1.12524642975590400D-5)*T-3.36375833240268800D-5)
     *    *T+1.00928148823365120D-4)*T-2.96890121633200000D-4
      Y = ((((((Y*T+9.15785997288933120D-4)*T-2.42259538436268176D-3)
     *    *T+9.04033494028101968D-3)*T-1.34118505705967765D-2)
     *    *T+1.03703363422075456D-1)*T+1.61691987244425092D-2)*T +
     *    8.86226925452758013D-1
C
C     EXPANSION (0026) EVALUATED AS Y(T)  --PRECISION 19E.19
C19   Y = (((((((((((((((+6.710886400000000000D-13*T-
C19  *    1.677721600000000000D-12)*T+6.710886400000000000D-13)
C19  *    *T-4.152360960000000000D-12)*T+2.499805184000000000D-11)
C19  *    *T-6.898581504000000000D-11)*T+1.859597107200000000D-10)
C19  *    *T-5.676387532800000000D-10)*T+1.725556326400000000D-9)
C19  *    *T-5.166307737600000000D-9)*T+1.548131827712000000D-8)
C19  *    *T-4.644574052352000000D-8)*T+1.393195837030400000D-7)
C19  *    *T-4.178233990758400000D-7)*T+1.252842254950400000D-6)
C19  *    *T-3.754985815285760000D-6)*T+1.125245651030528000D-5
C19   Y = (((((((((Y*T-3.363758423922688000D-5)
C19  *    *T+1.009281502108083200D-4)
C19  *    *T-2.968901215188000000D-4)*T+9.157859971435078400D-4)
C19  *    *T-2.422595384370689760D-3)*T+9.040334940288877920D-3)
C19  *    *T-1.341185057059651648D-2)*T+1.037033634220752902D-1)
C19  *    *T+1.616919872444250674D-2)*T + 8.862269254527580137D-1
C
      S14ABF = LOG(Y*G)
      IFAIL = 0
      GO TO 200
C
  120 IF (X.GT.XBIG) GO TO 140
C        MAIN LARGE X RANGE
      T = 450.0D0/(X*X) - 1.0D0
C
C      * EXPANSION (0059) *
C
C     EXPANSION (0059) EVALUATED AS Y(T)  --PRECISION 08E.09
C08   Y = (+3.89980902D-9*T-6.16502533D-6)*T + 8.33271644D-2
C
C     EXPANSION (0059) EVALUATED AS Y(T)  --PRECISION 09E.10
C09   Y = (+3.899809019D-9*T-6.165025333D-6)*T + 8.332716441D-2
C
C     EXPANSION (0059) EVALUATED AS Y(T)  --PRECISION 12E.13
C12   Y = ((-6.451144077930D-12*T+3.899809018958D-9)
C12  *    *T-6.165020494506D-6)*T + 8.332716440658D-2
C
C     EXPANSION (0059) EVALUATED AS Y(T)  --PRECISION 15E.16
C15   Y = (((+2.002019273379824D-14*T-6.451144077929628D-12)
C15  *    *T+3.899788998764847D-9)*T-6.165020494506090D-6)*T +
C15  *    8.332716440657866D-2
C
C     EXPANSION (0059) EVALUATED AS Y(T)  --PRECISION 17E.18
      Y = ((((-9.94561064728159347D-17*T+2.00201927337982364D-14)
     *    *T-6.45101975779653651D-12)*T+3.89978899876484712D-9)
     *    *T-6.16502049453716986D-6)*T + 8.33271644065786580D-2
C
C     EXPANSION (0059) EVALUATED AS Y(T)  --PRECISION 19E.19
C19   Y = (((((+7.196406678180202240D-19*T-9.945610647281593472D-17)
C19  *    *T+2.001911327279650935D-14)*T-6.451019757796536510D-12)
C19  *    *T+3.899788999169644998D-9)*T-6.165020494537169862D-6)*T +
C19  *    8.332716440657865795D-2
C
      S14ABF = (X-0.5D0)*LOG(X) - X + LNR2PI + Y/X
      IFAIL = 0
      GO TO 200
C
  140 IF (X.GT.XVBIG) GO TO 180
C        ASYMPTOTIC LARGE X RANGE
      S14ABF = (X-0.5D0)*LOG(X) - X + LNR2PI
      IFAIL = 0
      GO TO 200
C
C        FAILURE EXITS
  160 IFAIL = P01ABF(IFAIL,1,SRNAME,0,P01REC)
      S14ABF = 0.0D0
      GO TO 200
  180 IFAIL = P01ABF(IFAIL,2,SRNAME,0,P01REC)
      S14ABF = GBIG
C
  200 RETURN
C
      END
