      SUBROUTINE D01ARF(A,B,F,RELACC,ABSACC,MAXRUL,IPARM,ACC,ANS,N,
     *                  ALPHA,IFAIL)
C     MARK 10 RELEASE. NAG COPYRIGHT 1982.
C     MARK 11.5(F77) REVISED. (SEPT 1985.)
C     MARK 13 REVISED. USE OF MARK 13 X02 FUNCTIONS (APR 1988).
C     MARK 13 REVISED. IER-576 (MAR 1988).
C
C     DEFINITE AND INDEFINITE INTEGRATION OVER A FINITE INTERVAL
C
C     THE NUMERICAL INTEGRATION IS PERFORMED USING A SEQUENCE OF
C     RULES BASED ON THE REPEATED OPTIMAL EXTENSIONS OF THE 3-POINT
C     GAUSS RULE (SEE PATTERSON,T.N.L.,MATHS.COMP.,22,847-857,1968).
C     UP TO 9 RULES MAY BE APPLIED USING 1,3,7,15,31,63,127,255 AND
C     511 POINTS OF RESPECTIVE POLYNOMIAL INTEGRATING DEGREE 1,5,11
C     23,47,95,191,383 AND 767. EACH RULE HAS THE INTERLACING
C     PROPERTY THAT THE NEXT IN SEQUENCE INCLUDES ALL THE POINTS OF
C     ITS PREDECESSOR. IN CARRYING OUT THE INTEGRATION THE RESULTS
C     OF SUCCESSIVE RULES ARE COMPARED. WHEN THE LATEST TWO RESULTS
C     DIFFER ABSOLUTELY BY NOT MORE THAN A SPECIFIED TOLERANCE THE
C     RESULT OF THE LAST RULE USED IS TAKEN AS THE VALUE OF THE
C     INTEGRAL. THE PROCEDURE IS NON-ADAPTIVE IN THAT IF THE REQUIRED
C     TOLERANCE IS NOT ACHIEVED AFTER APPLYING ALL RULES NO ATTEMPT
C     IS MADE TO CONTINUE, THE BEST AVAILABLE RESULT IS RETURNED
C     WITH A WARNING.
C
C     THE CALL TO THE SUBROUTINE TAKES THE FORM-
C
C      CALL D01ARF(A,B,F,RELACC,ABSACC,MAXRUL,IPARM,
C                  ACC,ANS,N,ALPHA,IFAIL)
C
C     THE ACTION PERFORMED IS CONTROLLED BY THE PARAMETER IPARM
C     AS FOLLOWS-
C
C     IPARM=0  -THE INTEGRAND F(X) IS INTEGRATED TO A PRESCRIBED
C               ACCURACY OVER THE FINITE INTERVAL A.LE.X.LE.B.
C
C     IPARM=1  -AS FOR IPARM=0 BUT ADDITIONALLY THE EXPANSION OF
C               INTEGRAND OVER THE INTERVAL (A,B) IN LEGENDRE
C               POLYNOMIALS IS CALCULATED USING THE SAME VALUES
C               OF THE INTEGRAND AS USED TO CALCULATE THE INTEGRAL.
C               THE EXPANSION COEFFICIENTS MAY BE USED LATER IN
C               COMPUTING INDEFINITE INTEGRALS.
C
C     IPARM=2  -INDEFINITE INTEGRATION -THE INTEGRAND F(X) IS
C               INTEGRATED ANALYTICALLY OVER THE INTERVAL
C               A.LE.X.LE.B USING THE LEGENDRE EXPANSION OF THE
C               INTEGRAND. NO FURTHER EVALUATIONS OF THE INTEGRAND
C               ARE REQUIRED. THE SUBROUTINE MUST PREVIOUSLY
C               HAVE BEEN CALLED WITH IPARM=1 AND THE INTERVAL
C               (A,B) MUST LIE WITHIN THE INTERVAL PRESCRIBED FOR
C               THAT PREVIOUS CALL.
C
C                    -FORMAL ARGUMENT SPECIFICATIONS-
C
C     INPUT ARGUMENTS-
C
C     A,B        -RESPECTIVE LOWER AND UPPER LIMITS TO THE INTERVAL
C                 OF INTEGRATION. REAL VARIABLES OR CONSTANTS.
C
C     F          -USER SUPPLIED AND DEFINED REAL FUNCTION F(X) TO
C                 CALCULATE THE VALUE OF THE INTEGRAND AT X (REAL
C                 VARIABLE). (IPARM=0 OR 1 ONLY).
C
C     RELACC,    -RESPECTIVE RELATIVE AND ABSOLUTE ACCURACIES
C     ABSACC      REQUIRED. THE REQUIRED ACCURACY IS ASSUMED TO HAVE
C                 BEEN ACHIEVED WHEN THE RESULTS OF TWO SUCCESSIVE
C                 RULES DIFFER ABSOLUTELY BY NOT MORE THAN
C                         AMAX1(ABS(ABSACC),ABS(RELACC*ANS))
C                 WHERE ANS IS THE RESULT OBTAINED BY THE LAST RULE
C                 USED. IF BOTH RELACC AND ABSACC ARE ZERO THEN
C                 RELACC IS ASSUMED TO HAVE VALUE 10.0*EPMACH, WHERE
C                 EPMACH IS THE SMALLEST POSITIVE REAL NUMBER SUCH
C                 THAT
C                            1.0+EPMACH .GT. 1.0
C                 TO MACHINE ACCURACY. IF ALL RULES ARE EXHAUSTED
C                 WITHOUT ACHIEVING THE REQUIRED ACCURACY, ERROR
C                 IFAIL=1 IS RAISED AND ANS IS SET TO THE VALUE
C                 OBTAINED BY THE LAST RULE AS THE BEST
C                 APPROXIMATION POSSIBLE. REAL VARIABLES OR
C                 CONSTANTS.
C                 (IPARM=0 OR 1 ONLY).
C
C     MAXRUL     -MAXIMUM NUMBER OF SUCCESSIVE RULES TO BE USED.
C                 1.LE.MAXRUL.LE.9. IF OUTSIDE THESE LIMITS MAXRUL
C                 DEFAULTS TO THE VALUE 9. INTEGER VARIABLE OR
C                 CONSTANT. (IPARM=0 OR 1 ONLY).
C
C     IPARM      -THIS CONTROLS THE ACTION OF THE SUBROUTINE AND IS
C                 SET TO ONE OF THE THREE POSSIBLE VALUES 0,1 OR 2.
C                 IPARM=0  EVALUATES THE INTEGRAL ONLY.
C                      =1  EVALUATES THE INTEGRAL AND THE EXPANSION
C                          OF THE INTEGRAND IN LEGENDRE POLYNOMIALS.
C                      =2  CARRIES OUT INDEFINITE INTEGRATION.
C                          IN THIS CASE ONLY THE ARGUMENTS A,B,
C                          IPARM, ANS, ALPHA AND IFAIL ARE RELEVANT
C                          WITH THE OTHERS SUPPLIED SIMPLY AS DUMMY
C                          ARGUMENTS.
C                          INTEGER VARIABLE OR CONSTANT.
C                 FULLER DETAILS ON IPARM HAVE BEEN GIVEN EARLIER.
C
C     ALPHA      -REAL ARRAY
C                 THIS ARRAY SHOULD HAVE BEEN GENERATED BY A
C                 PREVIOUS CALL WITH IPARM=1.  CONTENTS AS DESCRIBED
C                 UNDER OUTPUT ARGUMENTS BELOW.
C                 (IPARM=2 ONLY)
C
C     IFAIL      -NAG ERROR CONTROL. INTEGER VARIABLE.
C                 IFAIL=0  HARD FAIL.
C                      =1  SOFT FAIL.
C
C
C     OUTPUT ARGUMENTS-
C
C     ACC        -ESTIMATED ABSOLUTE ERROR IN RESULT. THIS IS TAKEN
C                 AS THE VALUE OF THE ABSOLUTE DIFFERENCE BETWEEN
C                 THE RESULTS OF THE LAST TWO RULES USED.
C                 REAL VARIABLE. (IPARM=0 OR 1 ONLY).
C
C     ANS        -APPROXIMATE VALUE OF THE INTEGRAL. REAL VARIABLE.
C
C     N          -NUMBER OF EVALUATIONS OF THE INTEGRAND USED.
C                 INTEGER VARIABLE. (IPARM=0 OR 1 ONLY).
C
C     ALPHA      -REAL ARRAY
C                 THIS ARRAY CONTAINS
C                 ALPHA(1) TO ALPHA(NPTS) = THE NPTS COEFFICIENTS OF
C                 THE APPROXIMATION TO F(X) OVER (A,B) GIVEN BY-
C
C                 F(X) = SUM( I=1 TO NPTS ) ALPHA(I)*P(I-1,T)
C
C                 WHERE X = (B+A+(B-A)*T)/2 AND P(I,T) IS THE
C                 LEGENDRE POLYNOMIAL OF DEGREE I OVER (-1,1). THIS
C                 APPROXIMATION IS INTEGRATED TO OBTAIN THE VALUE OF
C                 THE INDEFINITE INTEGRAL.
C                 NPTS=3*(N+1)/4 FOR N=1,3 OR 7
C                 NPTS=3*N/4 OTHERWISE.
C
C                 ALPHA ALSO HOLDS THE FOLLOWING INFORMATION
C                 REQUIRED FOR CALLS FOR INDEFINITE INTEGRATION
C                 ALPHA(390)=NPTS
C                 ALPHA(389)=1 IF ALPHA USABLE FOR INDEF INTEGRATION
C                               (IE. IPARM=1 AND RANGE NON-TRIVIAL)
C                           =0 OTHERWISE
C                 ALPHA(388)=IFAIL (IF ALPHA(389)=1)
C                            UNDEFINED OTHERWISE
C                 ALPHA(387)=B
C                 ALPHA(386)=A
C                 ALPHA SHOULD BE DECLARED IN THE CALLING
C                 PROGRAM TO HAVE AT LEAST 390 ELEMENTS.
C                 (IPARM=1 ONLY)
C                 ALPHA IS UNCHANGED WHEN IPARM=2
C
C     IFAIL      -REPORTS ERRORS AS FOLLOWS- (INTEGER VARIABLE)
C                 IFAIL=0  NO ERRORS DETECTED.
C                      =1  ALL MAXRUL RULES HAVE BEEN APPLIED
C                          WITHOUT ACHIEVING THE REQUIRED ACCURACY.
C                          ANS IS SET TO THE VALUE OBTAINED BY THE
C                          LAST RULE USED.
C                      =2  IPARM FAILS TO SATISFY 0.LE.IPARM.LE.2.
C                      =3  SUBROUTINE HAS BEEN CALLED WITH IPARM=2
C                          BUT A PREVIOUS CALL WITH IPARM=1 HAS BEEN
C                          OMITTED OR WAS INVOKED WITH AN
C                          INTEGRATION INTERVAL OF LENGTH ZERO.
C                          (IPARM=2 ONLY).
C                      =4  THE INTERVAL FOR INDEFINITE INTEGRATION
C                          IS NOT CONTAINED WITHIN THE INTERVAL
C                          SPECIFIED WHEN THE SUBROUTINE WAS
C                          PREVIOUSLY CALLED WITH IPARM=1.
C                          (IPARM=2 ONLY).
C
C     .. Parameters ..
      CHARACTER*6       SRNAME
      PARAMETER         (SRNAME='D01ARF')
C     .. Scalar Arguments ..
      DOUBLE PRECISION  A, ABSACC, ACC, ANS, B, RELACC
      INTEGER           IFAIL, IPARM, MAXRUL, N
C     .. Array Arguments ..
      DOUBLE PRECISION  ALPHA(390)
C     .. Function Arguments ..
      DOUBLE PRECISION  F
      EXTERNAL          F
C     .. Local Scalars ..
      DOUBLE PRECISION  AA, BB, BXA, BXA0, BXA1, BXB, BXB0, BXB1, C1,
     *                  C2, C3, DIFF, EPMACH, EPSABS, EPSREL, F1, F2,
     *                  FZERO, PP, Q, R1, R1PLUS, R2, SUM, T1, TEST, TT,
     *                  TTPLUS, X, XA, XB
      INTEGER           I, ICHECK, IERR, IP, IW, J, K, LP, MRULE, NB,
     *                  NPTS, NTOP, NTOPNB, NZ
C     .. Local Arrays ..
      DOUBLE PRECISION  FUNCTM(256), FUNCTP(256), P(256), P0(256),
     *                  P1(256), W(511)
      CHARACTER*1       P01REC(1)
C     .. External Functions ..
      DOUBLE PRECISION  X02AJF
      INTEGER           P01ABF
      EXTERNAL          X02AJF, P01ABF
C     .. External Subroutines ..
      EXTERNAL          X03AAF
C     .. Intrinsic Functions ..
      INTRINSIC         ABS, MAX, MIN, MOD, DBLE, INT
C     .. Data statements ..
      DATA              P(1), P(2), P(3), P(4), P(5), P(6), P(7), P(8),
     *                  P(9), P(10), P(11), P(12), P(13), P(14), P(15),
     *                  P(16), P(17), P(18), P(19), P(20), P(21), P(22),
     *                  P(23), P(24), P(25), P(26), P(27), P(28)
     *  /0.999999672956734384381D 00,   0.999997596379748464620D 00,
     *   0.999992298136257588028D 00,   0.999982430354891598580D 00,
     *   0.999966730098486276883D 00,   0.999943996207054375764D 00,
     *   0.999913081144678282800D 00,   0.999872888120357611938D 00,
     *   0.999822363679787739196D 00,   0.999760490924432047330D 00,
     *   0.999686286448317731776D 00,   0.999598799671910683252D 00,
     *   0.999497112467187190535D 00,   0.999380338025023581928D 00,
     *   0.999247618943342473599D 00,   0.999098124967667597662D 00,
     *   0.998931050830810562236D 00,   0.998745614468095114704D 00,
     *   0.998541055697167906027D 00,   0.998316635318407392531D 00,
     *   0.998071634524930323302D 00,   0.997805354495957274562D 00,
     *   0.997517116063472399965D 00,   0.997206259372221959076D 00,
     *   0.996872143485260161299D 00,   0.996514145914890273849D 00,
     *   0.996131662079315037786D 00,   0.995724104698407188509D 00/
      DATA              P(29), P(30), P(31), P(32), P(33), P(34), P(35),
     *                  P(36), P(37), P(38), P(39), P(40), P(41), P(42),
     *                  P(43), P(44), P(45), P(46), P(47), P(48), P(49),
     *                  P(50), P(51), P(52), P(53), P(54), P(55), P(56)
     *  /0.995290903148810302261D 00,   0.994831502800621000519D 00,
     *   0.994345364356723405931D 00,   0.993831963212755022209D 00,
     *   0.993290788851684966211D 00,   0.992721344282788615328D 00,
     *   0.992123145530863117683D 00,   0.991495721178106132399D 00,
     *   0.990838611958294243677D 00,   0.990151370400770159181D 00,
     *   0.989433560520240838716D 00,   0.988684757547429479939D 00,
     *   0.987904547695124280467D 00,   0.987092527954034067190D 00,
     *   0.986248305913007552681D 00,   0.985371499598520371114D 00,
     *   0.984461737328814534596D 00,   0.983518657578632728762D 00,
     *   0.982541908851080604251D 00,   0.981531149553740106867D 00,
     *   0.980486047876721339416D 00,   0.979406281670862683806D 00,
     *   0.978291538324758539526D 00,   0.977141514639705714156D 00,
     *   0.975955916702011753129D 00,   0.974734459752402667761D 00,
     *   0.973476868052506926773D 00,   0.972182874748581796578D 00/
      DATA              P(57), P(58), P(59), P(60), P(61), P(62), P(63),
     *                  P(64), P(65), P(66), P(67), P(68), P(69), P(70),
     *                  P(71), P(72), P(73), P(74), P(75), P(76), P(77),
     *                  P(78), P(79), P(80), P(81), P(82), P(83), P(84)
     *  /0.970852221732792443256D 00,   0.969484659502459231771D 00,
     *   0.968079947017759947964D 00,   0.966637851558416567092D 00,
     *   0.965158148579915665979D 00,   0.963640621569812132521D 00,
     *   0.962085061904651475741D 00,   0.960491268708020283423D 00,
     *   0.958859048710200221356D 00,   0.957188216109860962736D 00,
     *   0.955478592438183697574D 00,   0.953730006425761136415D 00,
     *   0.951942293872573589498D 00,   0.950115297521294876558D 00,
     *   0.948248866934137357063D 00,   0.946342858373402905148D 00,
     *   0.944397134685866648591D 00,   0.942411565191083059813D 00,
     *   0.940386025573669721370D 00,   0.938320397779592883655D 00,
     *   0.936214569916450806625D 00,   0.934068436157725787999D 00,
     *   0.931881896650953639345D 00,   0.929654857429740056670D 00,
     *   0.927387230329536696843D 00,   0.925078932907075652364D 00,
     *   0.922729888363349241523D 00,   0.920340025470012420730D 00/
      DATA              P(85), P(86), P(87), P(88), P(89), P(90), P(91),
     *                  P(92), P(93), P(94), P(95), P(96), P(97), P(98),
     *                  P(99), P(100), P(101), P(102), P(103), P(104),
     *                  P(105), P(106), P(107), P(108), P(109), P(110),
     *                  P(111), P(112)
     *  /0.917909278499077501636D 00,   0.915437587155765040644D 00,
     *   0.912924896514370590080D 00,   0.910371156957004292498D 00,
     *   0.907776324115058903624D 00,   0.905140358813261595189D 00,
     *   0.902463227016165675048D 00,   0.899744899776940036639D 00,
     *   0.896985353188316590376D 00,   0.894184568335559022859D 00,
     *   0.891342531251319871666D 00,   0.888459232872256998890D 00,
     *   0.885534668997285008926D 00,   0.882568840247341906842D 00,
     *   0.879561752026556262568D 00,   0.876513414484705269742D 00,
     *   0.873423842480859310192D 00,   0.870293055548113905851D 00,
     *   0.867121077859315215614D 00,   0.863907938193690477146D 00,
     *   0.860653669904299969802D 00,   0.857358310886232156525D 00,
     *   0.854021903545468625813D 00,   0.850644494768350279758D 00,
     *   0.847226135891580884381D 00,   0.843766882672708601038D 00,
     *   0.840266795261030442350D 00,   0.836725938168868735503D 00/
      DATA              P(113), P(114), P(115), P(116), P(117), P(118),
     *                  P(119), P(120), P(121), P(122), P(123), P(124),
     *                  P(125), P(126), P(127), P(128), P(129), P(130),
     *                  P(131), P(132), P(133), P(134), P(135), P(136),
     *                  P(137), P(138), P(139), P(140)
     *  /0.833144380243172624728D 00,   0.829522194637401400178D 00,
     *   0.825859458783650001088D 00,   0.822156254364980407373D 00,
     *   0.818412667287925807395D 00,   0.814628787655137413436D 00,
     *   0.810804709738146594361D 00,   0.806940531950217611856D 00,
     *   0.803036356819268687782D 00,   0.799092290960841401800D 00,
     *   0.795108445051100526780D 00,   0.791084933799848361435D 00,
     *   0.787021875923539422170D 00,   0.782919394118283016385D 00,
     *   0.778777615032822744702D 00,   0.774596669241483377036D 00,
     *   0.770376691217076824278D 00,   0.766117819303760090717D 00,
     *   0.761820195689839149173D 00,   0.757483966380513637926D 00,
     *   0.753109281170558142523D 00,   0.748696293616936602823D 00,
     *   0.744245161011347082309D 00,   0.739756044352694758677D 00,
     *   0.735229108319491547663D 00,   0.730664521242181261329D 00,
     *   0.726062455075389632685D 00,   0.721423085370098915485D 00/
      DATA              P(141), P(142), P(143), P(144), P(145), P(146),
     *                  P(147), P(148), P(149), P(150), P(151), P(152),
     *                  P(153), P(154), P(155), P(156), P(157), P(158),
     *                  P(159), P(160), P(161), P(162), P(163), P(164),
     *                  P(165), P(166), P(167), P(168)
     *  /0.716746591245747095767D 00,   0.712033155362252034587D 00,
     *   0.707282963891961103412D 00,   0.702496206491527078610D 00,
     *   0.697673076273711232906D 00,   0.692813769779114702895D 00,
     *   0.687918486947839325756D 00,   0.682987431091079228087D 00,
     *   0.678020808862644517838D 00,   0.673018830230418479199D 00,
     *   0.667981708447749702165D 00,   0.662909660024780595461D 00,
     *   0.657802904699713735422D 00,   0.652661665410017496101D 00,
     *   0.647486168263572388782D 00,   0.642276642509759513774D 00,
     *   0.637033320510492495071D 00,   0.631756437711194230414D 00,
     *   0.626446232611719746542D 00,   0.621102946737226402941D 00,
     *   0.615726824608992638014D 00,   0.610318113715186400156D 00,
     *   0.604877064481584353319D 00,   0.599403930242242892974D 00,
     *   0.593898967210121954393D 00,   0.588362434447662541434D 00,
     *   0.582794593837318850840D 00,   0.577195710052045814844D 00/
      DATA              P(169), P(170), P(171), P(172), P(173), P(174),
     *                  P(175), P(176), P(177), P(178), P(179), P(180),
     *                  P(181), P(182), P(183), P(184), P(185), P(186),
     *                  P(187), P(188), P(189), P(190), P(191), P(192),
     *                  P(193), P(194), P(195), P(196)
     *  /0.571566050525742833992D 00,   0.565905885423654422623D 00,
     *   0.560215487612728441818D 00,   0.554495132631932548866D 00,
     *   0.548745098662529448608D 00,   0.542965666498311490492D 00,
     *   0.537157119515795115982D 00,   0.531319743644375623972D 00,
     *   0.525453827336442687395D 00,   0.519559661537457021993D 00,
     *   0.513637539655988578507D 00,   0.507687757533716602155D 00,
     *   0.501710613415391878251D 00,   0.495706407918761460170D 00,
     *   0.489675444004456155436D 00,   0.483618026945841027562D 00,
     *   0.477534464298829155284D 00,   0.471425065871658876934D 00,
     *   0.465290143694634735858D 00,   0.459130011989832332874D 00,
     *   0.452944987140767283784D 00,   0.446735387662028473742D 00,
     *   0.440501534168875795783D 00,   0.434243749346802558002D 00,
     *   0.427962357921062742583D 00,   0.421657686626163300056D 00,
     *   0.415330064175321663764D 00,   0.408979821229888672409D 00/
      DATA              P(197), P(198), P(199), P(200), P(201), P(202),
     *                  P(203), P(204), P(205), P(206), P(207), P(208),
     *                  P(209), P(210), P(211), P(212), P(213), P(214),
     *                  P(215), P(216), P(217), P(218), P(219), P(220),
     *                  P(221), P(222), P(223), P(224)
     *  /0.402607290368737092671D 00,   0.396212806057615939183D 00,
     *   0.389796704618470795479D 00,   0.383359324198730346916D 00,
     *   0.376901004740559344802D 00,   0.370422087950078230138D 00,
     *   0.363922917266549655269D 00,   0.357403837831532152376D 00,
     *   0.350865196458001209011D 00,   0.344307341599438022777D 00,
     *   0.337730623318886219621D 00,   0.331135393257976833093D 00,
     *   0.324522004605921855207D 00,   0.317890812068476683182D 00,
     *   0.311242171836871800300D 00,   0.304576441556714043335D 00,
     *   0.297893980296857823437D 00,   0.291195148518246681964D 00,
     *   0.284480308042725577496D 00,   0.277749822021824315065D 00,
     *   0.271004054905512543536D 00,   0.264243372410926761945D 00,
     *   0.257468141491069790481D 00,   0.250678730303483176613D 00,
     *   0.243875508178893021593D 00,   0.237058845589829727213D 00,
     *   0.230229114119222177156D 00,   0.223386686428966881628D 00/
      DATA              P(225), P(226), P(227), P(228), P(229), P(230),
     *                  P(231), P(232), P(233), P(234), P(235), P(236),
     *                  P(237), P(238), P(239), P(240), P(241), P(242),
     *                  P(243), P(244), P(245), P(246), P(247), P(248),
     *                  P(249), P(250), P(251), P(252)
     *  /0.216531936228472628081D 00,   0.209665238243181194766D 00,
     *   0.202786968183064697557D 00,   0.195897502711100153915D 00,
     *   0.188997219411721861059D 00,   0.182086496759252198246D 00,
     *   0.175165714086311475707D 00,   0.168235251552207464982D 00,
     *   0.161295490111305257361D 00,   0.154346811481378108692D 00,
     *   0.147389598111939940054D 00,   0.140424233152560174594D 00,
     *   0.133451100421161601344D 00,   0.126470584372301966851D 00,
     *   0.119483070065440005133D 00,   0.112488943133186625746D 00,
     *   0.105488589749541988533D 00,   0.984823965981192020903D-01,
     *   0.914707508403553909095D-01,   0.844540400837108837102D-01,
     *   0.774326523498572825675D-01,   0.704069760428551790633D-01,
     *   0.633773999173222898797D-01,   0.563443130465927899720D-01,
     *   0.493081047908686267156D-01,   0.422691647653636032124D-01,
     *   0.352278828084410232603D-01,   0.281846489497456943394D-01/
      DATA              P(253), P(254), P(255), P(256)
     *  /0.211398533783310883350D-01,   0.140938864107824626142D-01,
     *   0.704713845933674648514D-02,   0.000000000000000000000D 00/
      DATA              W(1)
     *  /2.000000000000000000000D 00/
      DATA              W(2), W(3), W(4), W(5), W(6), W(7), W(8), W(9),
     *                  W(10), W(11), W(12), W(13), W(14), W(15), W(16),
     *                  W(17), W(18), W(19), W(20), W(21), W(22), W(23),
     *                  W(24), W(25), W(26), W(27), W(28), W(29)
     *  /0.555555555555555555556D 00,   0.888888888888888888889D 00,
     *   0.104656226026467265194D 00,   0.268488089868333440729D 00,
     *   0.401397414775962222905D 00,   0.450916538658474142345D 00,
     *   0.170017196299402603390D-01,   0.516032829970797396969D-01,
     *   0.929271953151245376859D-01,   0.134415255243784220360D 00,
     *   0.171511909136391380787D 00,   0.200628529376989021034D 00,
     *   0.219156858401587496404D 00,   0.225510499798206687386D 00,
     *   0.254478079156187441540D-02,   0.843456573932110624631D-02,
     *   0.164460498543878109338D-01,   0.258075980961766535646D-01,
     *   0.359571033071293220968D-01,   0.464628932617579865414D-01,
     *   0.569795094941233574122D-01,   0.672077542959907035404D-01,
     *   0.768796204990035310427D-01,   0.857559200499903511542D-01,
     *   0.936271099812644736167D-01,   0.100314278611795578771D 00,
     *   0.105669893580234809744D 00,   0.109578421055924638237D 00/
      DATA              W(30), W(31), W(32), W(33), W(34), W(35), W(36),
     *                  W(37), W(38), W(39), W(40), W(41), W(42), W(43),
     *                  W(44), W(45), W(46), W(47), W(48), W(49), W(50),
     *                  W(51), W(52), W(53), W(54), W(55), W(56), W(57)
     *  /0.111956873020953456880D 00,   0.112755256720768691607D 00,
     *   0.363221481845530659694D-03,   0.126515655623006801137D-02,
     *   0.257904979468568827243D-02,   0.421763044155885483908D-02,
     *   0.611550682211724633968D-02,   0.822300795723592966926D-02,
     *   0.104982469096213218983D-01,   0.129038001003512656260D-01,
     *   0.154067504665594978021D-01,   0.179785515681282703329D-01,
     *   0.205942339159127111492D-01,   0.232314466399102694433D-01,
     *   0.258696793272147469108D-01,   0.284897547458335486125D-01,
     *   0.310735511116879648799D-01,   0.336038771482077305417D-01,
     *   0.360644327807825726401D-01,   0.384398102494555320386D-01,
     *   0.407155101169443189339D-01,   0.428779600250077344929D-01,
     *   0.449145316536321974143D-01,   0.468135549906280124026D-01,
     *   0.485643304066731987159D-01,   0.501571393058995374137D-01,
     *   0.515832539520484587768D-01,   0.528349467901165198621D-01/
      DATA              W(58), W(59), W(60), W(61), W(62), W(63), W(64),
     *                  W(65), W(66), W(67), W(68), W(69), W(70), W(71),
     *                  W(72), W(73), W(74), W(75), W(76), W(77), W(78),
     *                  W(79), W(80), W(81), W(82), W(83), W(84), W(85)
     *  /0.539054993352660639269D-01,   0.547892105279628650322D-01,
     *   0.554814043565593639878D-01,   0.559784365104763194076D-01,
     *   0.562776998312543012726D-01,   0.563776283603847173877D-01,
     *   0.505360952078625176247D-04,   0.180739564445388357820D-03,
     *   0.377746646326984660274D-03,   0.632607319362633544219D-03,
     *   0.938369848542381500794D-03,   0.128952408261041739210D-02,
     *   0.168114286542146990631D-02,   0.210881524572663287933D-02,
     *   0.256876494379402037313D-02,   0.305775341017553113613D-02,
     *   0.357289278351729964938D-02,   0.411150397865469304717D-02,
     *   0.467105037211432174741D-02,   0.524912345480885912513D-02,
     *   0.584344987583563950756D-02,   0.645190005017573692281D-02,
     *   0.707248999543355546805D-02,   0.770337523327974184817D-02,
     *   0.834283875396815770558D-02,   0.898927578406413572328D-02,
     *   0.964117772970253669530D-02,   0.102971169579563555237D-01/
      DATA              W(86), W(87), W(88), W(89), W(90), W(91), W(92),
     *                  W(93), W(94), W(95), W(96), W(97), W(98), W(99),
     *                  W(100), W(101), W(102), W(103), W(104), W(105),
     *                  W(106), W(107), W(108), W(109), W(110), W(111),
     *                  W(112), W(113)
     *  /0.109557333878379016480D-01,   0.116157233199551347270D-01,
     *   0.122758305600827700870D-01,   0.129348396636073734547D-01,
     *   0.135915710097655467896D-01,   0.142448773729167743063D-01,
     *   0.148936416648151820348D-01,   0.155367755558439824399D-01,
     *   0.161732187295777199419D-01,   0.168019385741038652709D-01,
     *   0.174219301594641737472D-01,   0.180322163903912863201D-01,
     *   0.186318482561387901863D-01,   0.192199051247277660193D-01,
     *   0.197954950480974994880D-01,   0.203577550584721594669D-01,
     *   0.209058514458120238522D-01,   0.214389800125038672465D-01,
     *   0.219563663053178249393D-01,   0.224572658268160987071D-01,
     *   0.229409642293877487608D-01,   0.234067774953140062013D-01,
     *   0.238540521060385400804D-01,   0.242821652033365993580D-01,
     *   0.246905247444876769091D-01,   0.250785696529497687068D-01,
     *   0.254457699654647658126D-01,   0.257916269760242293884D-01/
      DATA              W(114), W(115), W(116), W(117), W(118), W(119),
     *                  W(120), W(121), W(122), W(123), W(124), W(125),
     *                  W(126), W(127), W(128), W(129), W(130), W(131),
     *                  W(132), W(133), W(134), W(135), W(136), W(137),
     *                  W(138), W(139), W(140), W(141)
     *  /0.261156733767060976805D-01,   0.264174733950582599310D-01,
     *   0.266966229274503599062D-01,   0.269527496676330319634D-01,
     *   0.271855132296247918192D-01,   0.273946052639814325161D-01,
     *   0.275797495664818730349D-01,   0.277407021782796819939D-01,
     *   0.278772514766137016085D-01,   0.279892182552381597038D-01,
     *   0.280764557938172466068D-01,   0.281388499156271506363D-01,
     *   0.281763190330166021307D-01,   0.281888141801923586938D-01,
     *   0.693793643241082671695D-05,   0.251578703842806614886D-04,
     *   0.532752936697806131254D-04,   0.903727346587511492612D-04,
     *   0.135754910949228719730D-03,   0.188873264506504913661D-03,
     *   0.249212400482997294025D-03,   0.316303660822264476886D-03,
     *   0.389745284473282293216D-03,   0.469184924247850409755D-03,
     *   0.554295314930374714918D-03,   0.644762041305724779327D-03,
     *   0.740282804244503330463D-03,   0.840571432710722463647D-03/
      DATA              W(142), W(143), W(144), W(145), W(146), W(147),
     *                  W(148), W(149), W(150), W(151), W(152), W(153),
     *                  W(154), W(155), W(156), W(157), W(158), W(159),
     *                  W(160), W(161), W(162), W(163), W(164), W(165),
     *                  W(166), W(167), W(168), W(169)
     *  /0.945361516858525382463D-03,   0.105440762286331677225D-02,
     *   0.116748411742995940769D-02,   0.128438247189701017681D-02,
     *   0.140490799565514464272D-02,   0.152887670508776556838D-02,
     *   0.165611272815445260522D-02,   0.178644639175864982468D-02,
     *   0.191971297101387241252D-02,   0.205575198932734652359D-02,
     *   0.219440692536383883880D-02,   0.233552518605716087370D-02,
     *   0.247895822665756793068D-02,   0.262456172740442956257D-02,
     *   0.277219576459345099400D-02,   0.292172493791781975378D-02,
     *   0.307301843470257832341D-02,   0.322595002508786846140D-02,
     *   0.338039799108692038235D-02,   0.353624499771677773402D-02,
     *   0.369337791702565081826D-02,   0.385168761663987092408D-02,
     *   0.401106872407502339889D-02,   0.417141937698407885279D-02,
     *   0.433264096809298285454D-02,   0.449463789203206786164D-02,
     *   0.465731729975685477728D-02,   0.482058886485126834765D-02/
      DATA              W(170), W(171), W(172), W(173), W(174), W(175),
     *                  W(176), W(177), W(178), W(179), W(180), W(181),
     *                  W(182), W(183), W(184), W(185), W(186), W(187),
     *                  W(188), W(189), W(190), W(191), W(192), W(193),
     *                  W(194), W(195), W(196), W(197)
     *  /0.498436456476553860120D-02,   0.514855847897817776184D-02,
     *   0.531308660518705656629D-02,   0.547786669391895082402D-02,
     *   0.564281810138444415845D-02,   0.580786165997756736349D-02,
     *   0.597291956550816580495D-02,   0.613791528004138504348D-02,
     *   0.630277344908575871716D-02,   0.646741983180368672737D-02,
     *   0.663178124290188789412D-02,   0.679578550488277339479D-02,
     *   0.695936140939042293944D-02,   0.712243868645838715317D-02,
     *   0.728494798055380706388D-02,   0.744682083240759101741D-02,
     *   0.760798966571905658322D-02,   0.776838777792199121996D-02,
     *   0.792794933429484911025D-02,   0.808660936478885997097D-02,
     *   0.824430376303286803055D-02,   0.840096928705193263543D-02,
     *   0.855654356130768961917D-02,   0.871096507973208687358D-02,
     *   0.886417320948249426411D-02,   0.901610819519564316003D-02,
     *   0.916671116356078840671D-02,   0.931592412806939509316D-02/
      DATA              W(198), W(199), W(200), W(201), W(202), W(203),
     *                  W(204), W(205), W(206), W(207), W(208), W(209),
     *                  W(210), W(211), W(212), W(213), W(214), W(215),
     *                  W(216), W(217), W(218), W(219), W(220), W(221),
     *                  W(222), W(223), W(224), W(225)
     *  /0.946368999383006529427D-02,   0.960995256236388300966D-02,
     *   0.975465653631741146108D-02,   0.989774752404874974401D-02,
     *   0.100391720440568407982D-01,   0.101788775292360797335D-01,
     *   0.103168123309476216819D-01,   0.104529257229060119261D-01,
     *   0.105871679048851979309D-01,   0.107194900062519336232D-01,
     *   0.108498440893373140990D-01,   0.109781831526589124696D-01,
     *   0.111044611340069265370D-01,   0.112286329134080493536D-01,
     *   0.113506543159805966017D-01,   0.114704821146938743804D-01,
     *   0.115880740330439525684D-01,   0.117033887476570031007D-01,
     *   0.118163858908302357632D-01,   0.119270260530192700402D-01,
     *   0.120352707852795626304D-01,   0.121410826016682996790D-01,
     *   0.122444249816119858986D-01,   0.123452623722438384545D-01,
     *   0.124435601907140352631D-01,   0.125392848264748843534D-01,
     *   0.126324036435420787645D-01,   0.127228849827323829063D-01/
      DATA              W(226), W(227), W(228), W(229), W(230), W(231),
     *                  W(232), W(233), W(234), W(235), W(236), W(237),
     *                  W(238), W(239), W(240), W(241), W(242), W(243),
     *                  W(244), W(245), W(246), W(247), W(248), W(249),
     *                  W(250), W(251), W(252), W(253)
     *  /0.128106981638773619668D-01,   0.128958134880121146942D-01,
     *   0.129782022395373992858D-01,   0.130578366883530488402D-01,
     *   0.131346900919601528364D-01,   0.132087366975291299655D-01,
     *   0.132799517439305306504D-01,   0.133483114637251799531D-01,
     *   0.134137930851100985130D-01,   0.134763748338165159817D-01,
     *   0.135360359349562136137D-01,   0.135927566148123959096D-01,
     *   0.136465181025712914284D-01,   0.136973026319907162581D-01,
     *   0.137450934430018966323D-01,   0.137898747832409365174D-01,
     *   0.138316319095064286765D-01,   0.138703510891398409970D-01,
     *   0.139060196013254612635D-01,   0.139386257383068508043D-01,
     *   0.139681588065169385157D-01,   0.139946091276190798519D-01,
     *   0.140179680394566088099D-01,   0.140382278969086233034D-01,
     *   0.140553820726499642772D-01,   0.140694249578135753181D-01,
     *   0.140803519625536613248D-01,   0.140881595165083010653D-01/
      DATA              W(254), W(255), W(256), W(257), W(258), W(259),
     *                  W(260), W(261), W(262), W(263), W(264), W(265),
     *                  W(266), W(267), W(268), W(269), W(270), W(271),
     *                  W(272), W(273), W(274), W(275), W(276), W(277),
     *                  W(278), W(279), W(280), W(281)
     *  /0.140928450691604083550D-01,   0.140944070900961793469D-01,
     *   0.945715933950007048827D-06,   0.345456507169149134898D-05,
     *   0.736624069102321668857D-05,   0.125792781889592743525D-04,
     *   0.190213681905875816679D-04,   0.266376412339000901358D-04,
     *   0.353751372055189588628D-04,   0.451863674126296143105D-04,
     *   0.560319507856164252140D-04,   0.678774554733972416227D-04,
     *   0.806899228014035293851D-04,   0.944366322532705527066D-04,
     *   0.109085545645741522051D-03,   0.124606200241498368482D-03,
     *   0.140970302204104791413D-03,   0.158151830411132242924D-03,
     *   0.176126765545083195474D-03,   0.194872642236641146532D-03,
     *   0.214368090034216937149D-03,   0.234592462123925204879D-03,
     *   0.255525589595236862014D-03,   0.277147657465187357459D-03,
     *   0.299439176850911730874D-03,   0.322381020652862389664D-03,
     *   0.345954492129903871350D-03,   0.370141402122251665232D-03/
      DATA              W(282), W(283), W(284), W(285), W(286), W(287),
     *                  W(288), W(289), W(290), W(291), W(292), W(293),
     *                  W(294), W(295), W(296), W(297), W(298), W(299),
     *                  W(300), W(301), W(302), W(303), W(304), W(305),
     *                  W(306), W(307), W(308), W(309)
     *  /0.394924138246873704434D-03,   0.420285716355361231823D-03,
     *   0.446209810101403247488D-03,   0.472680758429262691232D-03,
     *   0.499683553312800484519D-03,   0.527203811431658386125D-03,
     *   0.555227733977307579715D-03,   0.583742058714979703847D-03,
     *   0.612734008012225209294D-03,   0.642191235948505088403D-03,
     *   0.672101776960108194646D-03,   0.702453997827572321358D-03,
     *   0.733236554224767912055D-03,   0.764438352543882784191D-03,
     *   0.796048517297550871506D-03,   0.828056364077226302608D-03,
     *   0.860451377808527848128D-03,   0.893223195879324912340D-03,
     *   0.926361595613111283368D-03,   0.959856485506936206261D-03,
     *   0.993697899638760857945D-03,   0.102787599466367326179D-02,
     *   0.106238104885340071375D-02,   0.109720346268191941940D-02,
     *   0.113233376051597664917D-02,   0.116776259302858043685D-02,
     *   0.120348074001265964881D-02,   0.123947911332878396534D-02/
      DATA              W(310), W(311), W(312), W(313), W(314), W(315),
     *                  W(316), W(317), W(318), W(319), W(320), W(321),
     *                  W(322), W(323), W(324), W(325), W(326), W(327),
     *                  W(328), W(329), W(330), W(331), W(332), W(333),
     *                  W(334), W(335), W(336), W(337)
     *  /0.127574875977346947345D-02,   0.131228086370221478128D-02,
     *   0.134906674928353113127D-02,   0.138609788229672549700D-02,
     *   0.142336587141720519900D-02,   0.146086246895890987689D-02,
     *   0.149857957106456636214D-02,   0.153650921735128916170D-02,
     *   0.157464359003212166189D-02,   0.161297501254393423070D-02,
     *   0.165149594771914570655D-02,   0.169019899554346019117D-02,
     *   0.172907689054461607168D-02,   0.176812249885838886701D-02,
     *   0.180732881501808930079D-02,   0.184668895851282540913D-02,
     *   0.188619617015808475394D-02,   0.192584380831993546204D-02,
     *   0.196562534503150547732D-02,   0.200553436203751169944D-02,
     *   0.204556454679958293446D-02,   0.208570968849203942640D-02,
     *   0.212596367401472533045D-02,   0.216632048404649142727D-02,
     *   0.220677418916003329194D-02,   0.224731894601603393082D-02,
     *   0.228794899365195972378D-02,   0.232865864987842738864D-02/
      DATA              W(338), W(339), W(340), W(341), W(342), W(343),
     *                  W(344), W(345), W(346), W(347), W(348), W(349),
     *                  W(350), W(351), W(352), W(353), W(354), W(355),
     *                  W(356), W(357), W(358), W(359), W(360), W(361),
     *                  W(362), W(363), W(364), W(365)
     *  /0.236944230779380495146D-02,   0.241029443242563417382D-02,
     *   0.245120955750556483923D-02,   0.249218228238276930060D-02,
     *   0.253320726907925325750D-02,   0.257427923948908888092D-02,
     *   0.261539297272236109225D-02,   0.265654330259352828314D-02,
     *   0.269772511525294586667D-02,   0.273893334695947541201D-02,
     *   0.278016298199139435045D-02,   0.282140905069222207923D-02,
     *   0.286266662764757868253D-02,   0.290393082998878368175D-02,
     *   0.294519681581857582284D-02,   0.298645978275408290247D-02,
     *   0.302771496658198544480D-02,   0.306895764002069252174D-02,
     *   0.311018311158427546158D-02,   0.315138672454287935858D-02,
     *   0.319256385597434736790D-02,   0.323370991590184336368D-02,
     *   0.327482034651233969564D-02,   0.331589062145094394706D-02,
     *   0.335691624518616761342D-02,   0.339789275244138669739D-02,
     *   0.343881570768790591876D-02,   0.347968070469521146972D-02/
      DATA              W(366), W(367), W(368), W(369), W(370), W(371),
     *                  W(372), W(373), W(374), W(375), W(376), W(377),
     *                  W(378), W(379), W(380), W(381), W(382), W(383),
     *                  W(384), W(385), W(386), W(387), W(388), W(389),
     *                  W(390), W(391), W(392), W(393)
     *  /0.352048336613417922682D-02,   0.356121934322919357659D-02,
     *   0.360188431545532431869D-02,   0.364247399027690353194D-02,
     *   0.368298410292403911967D-02,   0.372341041620379550870D-02,
     *   0.376374872034296338241D-02,   0.380399483285952829161D-02,
     *   0.384414459846013158917D-02,   0.388419388896099560998D-02,
     *   0.392413860322995774660D-02,   0.396397466714742455513D-02,
     *   0.400369803358421688562D-02,   0.404330468239442998549D-02,
     *   0.408279062042157838350D-02,   0.412215188151643401528D-02,
     *   0.416138452656509745764D-02,   0.420048464352596631772D-02,
     *   0.423944834747438184434D-02,   0.427827178065384480959D-02,
     *   0.431695111253279479928D-02,   0.435548253986604343679D-02,
     *   0.439386228676004195260D-02,   0.443208660474124713206D-02,
     *   0.447015177282692726900D-02,   0.450805409759782158001D-02,
     *   0.454578991327213285488D-02,   0.458335558178039420335D-02/
      DATA              W(394), W(395), W(396), W(397), W(398), W(399),
     *                  W(400), W(401), W(402), W(403), W(404), W(405),
     *                  W(406), W(407), W(408), W(409), W(410), W(411),
     *                  W(412), W(413), W(414), W(415), W(416), W(417),
     *                  W(418), W(419), W(420), W(421)
     *  /0.462074749284080687482D-02,   0.465796206403469754658D-02,
     *   0.469499574088179046532D-02,   0.473184499691503264714D-02,
     *   0.476850633375474925263D-02,   0.480497628118194150483D-02,
     *   0.484125139721057135214D-02,   0.487732826815870573054D-02,
     *   0.491320350871841897367D-02,   0.494887376202437487201D-02,
     *   0.498433569972103029914D-02,   0.501958602202842039909D-02,
     *   0.505462145780650125058D-02,   0.508943876461803986674D-02,
     *   0.512403472879005351831D-02,   0.515840616547381084096D-02,
     *   0.519254991870341614863D-02,   0.522646286145300596306D-02,
     *   0.526014189569259311205D-02,   0.529358395244259896547D-02,
     *   0.532678599182711857974D-02,   0.535974500312596681161D-02,
     *   0.539245800482555593606D-02,   0.542492204466865704951D-02,
     *   0.545713419970309863995D-02,   0.548909157632945623482D-02,
     *   0.552079131034778706457D-02,   0.555223056700346326850D-02/
      DATA              W(422), W(423), W(424), W(425), W(426), W(427),
     *                  W(428), W(429), W(430), W(431), W(432), W(433),
     *                  W(434), W(435), W(436), W(437), W(438), W(439),
     *                  W(440), W(441), W(442), W(443), W(444), W(445),
     *                  W(446), W(447), W(448), W(449)
     *  /0.558340654103215637610D-02,   0.561431645670402467678D-02,
     *   0.564495756786715368885D-02,   0.567532715799029830087D-02,
     *   0.570542254020497332312D-02,   0.573524105734693719020D-02,
     *   0.576478008199711142954D-02,   0.579403701652197628421D-02,
     *   0.582300929311348057702D-02,   0.585169437382850155033D-02,
     *   0.588008975062788803205D-02,   0.590819294541511788161D-02,
     *   0.593600151007459827614D-02,   0.596351302650963502011D-02,
     *   0.599072510668009471472D-02,   0.601763539263978131522D-02,
     *   0.604424155657354634589D-02,   0.607054130083414983949D-02,
     *   0.609653235797888692923D-02,   0.612221249080599294931D-02,
     *   0.614757949239083790214D-02,   0.617263118612191922727D-02,
     *   0.619736542573665996342D-02,   0.622178009535701763157D-02,
     *   0.624587310952490748541D-02,   0.626964241323744217671D-02,
     *   0.629308598198198836688D-02,   0.631620182177103938227D-02/
      DATA              W(450), W(451), W(452), W(453), W(454), W(455),
     *                  W(456), W(457), W(458), W(459), W(460), W(461),
     *                  W(462), W(463), W(464), W(465), W(466), W(467),
     *                  W(468), W(469), W(470), W(471), W(472), W(473),
     *                  W(474), W(475), W(476), W(477)
     *  /0.633898796917690165912D-02,   0.636144249136619145314D-02,
     *   0.638356348613413709795D-02,   0.640534908193868098342D-02,
     *   0.642679743793437438922D-02,   0.644790674400605734710D-02,
     *   0.646867522080231481688D-02,   0.648910111976869964292D-02,
     *   0.650918272318071200827D-02,   0.652891834417652442012D-02,
     *   0.654830632678944064054D-02,   0.656734504598007641819D-02,
     *   0.658603290766824937794D-02,   0.660436834876456498276D-02,
     *   0.662234983720168509457D-02,   0.663997587196526532519D-02,
     *   0.665724498312454708217D-02,   0.667415573186258997654D-02,
     *   0.669070671050613006584D-02,   0.670689654255504925648D-02,
     *   0.672272388271144108036D-02,   0.673818741690825799086D-02,
     *   0.675328586233752529078D-02,   0.676801796747810680683D-02,
     *   0.678238251212300746082D-02,   0.679637830740619795480D-02,
     *   0.681000419582894688374D-02,   0.682325905128564571420D-02/
      DATA              W(478), W(479), W(480), W(481), W(482), W(483),
     *                  W(484), W(485), W(486), W(487), W(488), W(489),
     *                  W(490), W(491), W(492), W(493), W(494), W(495),
     *                  W(496), W(497), W(498), W(499), W(500), W(501),
     *                  W(502), W(503), W(504), W(505)
     *  /0.683614177908911221841D-02,   0.684865131599535812903D-02,
     *   0.686078663022780697951D-02,   0.687254672150094831613D-02,
     *   0.688393062104341470995D-02,   0.689493739162046825872D-02,
     *   0.690556612755588354803D-02,   0.691581595475321433825D-02,
     *   0.692568603071643155621D-02,   0.693517554456992049848D-02,
     *   0.694428371707782549438D-02,   0.695300980066273063177D-02,
     *   0.696135307942366551493D-02,   0.696931286915342540213D-02,
     *   0.697688851735519545845D-02,   0.698407940325846925786D-02,
     *   0.699088493783425207545D-02,   0.699730456380953992594D-02,
     *   0.700333775568106572820D-02,   0.700898401972830440494D-02,
     *   0.701424289402572916425D-02,   0.701911394845431165171D-02,
     *   0.702359678471225911031D-02,   0.702769103632498213858D-02,
     *   0.703139636865428709508D-02,   0.703471247890678765907D-02,
     *   0.703763909614153052319D-02,   0.704017598127683066242D-02/
      DATA              W(506), W(507), W(508), W(509), W(510), W(511)
     *  /0.704232292709631209597D-02,   0.704407975825415053266D-02,
     *   0.704544633127951476780D-02,   0.704642253458020417748D-02,
     *   0.704700828844548013730D-02,   0.704720354504808967346D-02/
C     .. Executable Statements ..
      ICHECK = 0
      ANS = 0.0D0
      EPMACH = X02AJF()
      IP = 0
      IF (IPARM.EQ.0 .OR. IPARM.EQ.1) GO TO 20
      IF (IPARM.EQ.2) GO TO 240
      ICHECK = 2
      GO TO 320
C
C     INITIAL INTEGRATION
C
C     CHECK FOR TRIVIAL CASE
C
   20 IF (ABS(A-B).GT.MAX(ABS(A),ABS(B))*EPMACH*10.0D0) GO TO 40
      N = 0
      ACC = 0.0D0
      GO TO 320
   40 MRULE = MAXRUL
      IF (MAXRUL.LT.1 .OR. MAXRUL.GT.9) MRULE = 9
      EPSREL = ABS(RELACC)
      EPSABS = ABS(ABSACC)
      IF (EPSREL.EQ.0.0D0 .AND. EPSABS.EQ.0.0D0) EPSREL = 10.0D0*EPMACH
      T1 = 0.0D0
      IW = 0
      K = 1
      NB = 256
      NTOP = 0
      LP = 0
C
C     SCALE FACTORS
C
      SUM = (B+A)*0.5D0
      DIFF = (B-A)*0.5D0
      FZERO = F(SUM)
      NTOPNB = NTOP + NB
      FUNCTP(NTOPNB) = FZERO
      FUNCTM(NTOPNB) = 0.0D0
C
C     1-POINT GAUSS
C
      R1 = W(1)*FZERO*DIFF
   60 IF (K.EQ.MRULE) GO TO 100
      IW = IW + LP + 1
      R2 = R1
      K = K + 1
      NB = NB/2
      LP = LP + LP + 1
      NTOP = NTOP + NB
      NTOPNB = NTOP + NB
C
C     EVALUATE RULE K
C
      IF (K.EQ.2) THEN
         NZ = NB
      ELSE
         NZ = 2*NB
      END IF
      DO 80 I = NB, NTOP, NZ
         X = P(I)*DIFF
         F1 = F(SUM+X)
         F2 = F(SUM-X)
         FUNCTP(I) = F1 + F2
         FUNCTM(I) = F1 - F2
   80 CONTINUE
      IERR = 0
      CALL X03AAF(W(IW+1),LP+1,FUNCTP(NB),
     *            NB*LP+1,LP+1,1,NB,0.0D0,0.0D0,R1,R1PLUS,.FALSE.,IERR)
      R1 = R1*DIFF
      TEST = MAX(EPSREL*ABS(R1),EPSABS)
      T1 = ABS(R1-R2)
C
C     CHECK FOR CONVERGENCE
C
      IF (T1.LE.TEST) GO TO 120
      GO TO 60
C
C     NO CONVERGENCE
C
  100 ICHECK = 1
  120 N = LP + LP + 1
      NPTS = 3*(N+1)/4
      ACC = T1
      ANS = R1
      IF (IPARM.EQ.0) GO TO 320
      IP = 1
C
C     EVALUATE EXPANSION COEFFICIENTS
C
C     APPLY RULE USED FOR DEFINITE INTEGRATION TO INTEGRATE-
C
C         F(SUM+DIFF*X)*P(K-1,X) OVER (-1,1),K=1,2,..,NPTS
C
C     WHERE P(K-1,X) IS THE LEGENDRE POLYNOMIAL OF ORDER K-1
C     AND HENCE OBTAIN THE EXPANSION COEFFICIENTS.
C
      DO 140 I = NB, NTOPNB, NB
         IW = IW + 1
         P0(I) = 0.0D0
         P1(I) = 1.0D0
         FUNCTP(I) = FUNCTP(I)*W(IW)
         FUNCTM(I) = FUNCTM(I)*W(IW)
  140 CONTINUE
      DO 220 K = 1, NPTS
         IERR = 0
         IF (MOD(K,2).EQ.1) GO TO 160
         CALL X03AAF(P1(NB),NB*LP+1,FUNCTM(NB),
     *               NB*LP+1,LP+1,NB,NB,0.0D0,0.0D0,TT,TTPLUS,.FALSE.,
     *               IERR)
         GO TO 180
  160    CALL X03AAF(P1(NB),NB*LP+1,FUNCTP(NB),
     *               NB*LP+1,LP+1,NB,NB,0.0D0,0.0D0,TT,TTPLUS,.FALSE.,
     *               IERR)
  180    ALPHA(K) = 0.5D0*DIFF*TT*DBLE(2*K-1)
         C1 = DBLE(2*K-1)/DBLE(K)
         C2 = DBLE(K-1)/DBLE(K)
         DO 200 I = NB, NTOPNB, NB
            PP = C1*P(I)*P1(I) - C2*P0(I)
            P0(I) = P1(I)
            P1(I) = PP
  200    CONTINUE
  220 CONTINUE
      IF (N.GT.7) NPTS = 3*N/4
      ALPHA(386) = A
      ALPHA(387) = B
      ALPHA(388) = DBLE(ICHECK) + 0.25D0
      ALPHA(390) = DBLE(NPTS) + 0.25D0
      GO TO 320
C
C     EVALUATE INDEFINITE INTEGRAL OVER (A,B)
C     CHECK FOR TRIVIAL CASES
C
  240 IF (ABS(A-B).LE.MAX(ABS(A),ABS(B))*EPMACH*10.0D0) GO TO 340
      IP = INT(ALPHA(389))
      IF (IP.NE.0) GO TO 260
      ICHECK = 3
      GO TO 320
  260 ICHECK = INT(ALPHA(388))
      NPTS = INT(ALPHA(390))
      AA = ALPHA(386)
      BB = ALPHA(387)
      IF (MIN(B,A).GE.MIN(BB,AA) .AND. MAX(B,A).LE.MAX(BB,AA))
     *    GO TO 280
      ICHECK = 4
      GO TO 340
C
C     EVALUATE THE INTEGRAL OF THE LEGENDRE EXPANSION OVER (A,B)
C
  280 SUM = (BB+AA)*0.5D0
      DIFF = (BB-AA)*0.5D0
      XA = (A-SUM)/DIFF
      XB = (B-SUM)/DIFF
      BXA0 = 0.0D0
      BXA1 = 0.0D0
      BXB0 = 0.0D0
      BXB1 = 0.0D0
      ALPHA(NPTS+1) = 0.0D0
      ALPHA(NPTS+2) = 0.0D0
      DO 300 K = 1, NPTS
         J = NPTS - K
         C1 = DBLE(J+1)
         C2 = DBLE(2*J+3)
         C3 = DBLE(J+2)
         Q = ALPHA(J+1)/DBLE(2*J+1) - ALPHA(J+3)/DBLE(2*J+5)
         BXA = (Q+C2*BXA0*XA-C3*BXA1)/C1
         BXB = (Q+C2*BXB0*XB-C3*BXB1)/C1
         BXA1 = BXA0
         BXA0 = BXA
         BXB1 = BXB0
         BXB0 = BXB
  300 CONTINUE
      ANS = XB*BXB0 - BXB1 - XA*BXA0 + BXA1
      GO TO 340
  320 ALPHA(389) = DBLE(IP) + 0.25D0
  340 IFAIL = P01ABF(IFAIL,ICHECK,SRNAME,0,P01REC)
      RETURN
      END
