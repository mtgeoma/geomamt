      SUBROUTINE D01BAX(A,B,ITYPE,NPTS,WEIGHT,ABSCIS,IFAIL)
C     MARK 7 RELEASE. NAG COPYRIGHT 1978.
C     MARK 11.5(F77) REVISED. (SEPT 1985.)
C     MARK 13 REVISED. USE OF MARK 12 X02 FUNCTIONS (APR 1988).
C
C     RETURNS WEIGHTS AND PIVOTS FOR ONE GAUSS-LAGUERRE FORMULA IF
C     STORED
C     IFAIL = 1 - THE NPTS RULE IS NOT AMONG THOSE STORED
C     ( WEIGHT,ABSCIS EVALUATED FOR LARGEST VALID NPTS LESS THAN
C     REQUESTED VALUE)
C     IFAIL = 2 - B IS ZERO
C     ( ALL WEIGHTS AND ABSCISSAE RETURNED AS ZERO)
C     IFAIL = 3 - UNDERFLOW IN EVALUATING NORMAL WEIGHTS
C     ( THE UNDERFLOWING WEIGHTS ARE RETURNED AS ZERO)
C
C     THE WEIGHTS AND ABSCISSAE RETURNED DEPEND ON A AND B.
C     THOSE STORED ARE ADJUSTED WEIGHTS AND ABSCISSAE FOR A=0,B=1
C     THOSE RETURNED FOR GENERAL (A,B) ARE RELATED TO THOSE STORED
C     BY
C     X(A,B) = X(0,1) / B + A
C     W(A,B) = +W(0,1) / B                      B>0  ADJUSTED WEIGHT
C     W(A,B) = +W(0,1) / B * EXP(-X(0,1)-B*A)   B>0    NORMAL WEIGHT
C     W(A,B) = -W(0,1) / B                      B<0  ADJUSTED WEIGHT
C     W(A,B) = -W(0,1) / B * EXP(-X(0,1)-B*A)   B<0    NORMAL WEIGHT
C
C     .. Scalar Arguments ..
      DOUBLE PRECISION  A, B
      INTEGER           IFAIL, ITYPE, NPTS
C     .. Array Arguments ..
      DOUBLE PRECISION  ABSCIS(NPTS), WEIGHT(NPTS)
C     .. Local Scalars ..
      DOUBLE PRECISION  EXPMIN, EXPNOW
      INTEGER           I, N, NN, NPTSA
C     .. Local Arrays ..
      DOUBLE PRECISION  ABST(269), WTST(269)
      INTEGER           NSTOR(16)
C     .. External Functions ..
      DOUBLE PRECISION  X02AMF
      EXTERNAL          X02AMF
C     .. Intrinsic Functions ..
      INTRINSIC         LOG, EXP
C     .. Data statements ..
      DATA              WTST(1), WTST(2), WTST(3), WTST(4),
     *                  WTST(5)/0.271828182845904523536028747135D1,
     *                  0.153332603311941684167312830146D1,
     *                  0.445095733505459280061001825091D1,
     *                  0.107769285927092079791596887249D1,
     *                  0.276214296190158724457379842928D1/
      DATA              WTST(6), WTST(7), WTST(8), WTST(9),
     *                  WTST(10)/0.560109462543442626035941899059D1,
     *                  0.832739123837889246612084143083D0,
     *                  0.204810243845429682140044467983D1,
     *                  0.363114630582151786159635626368D1,
     *                  0.648714508440766227159534147675D1/
      DATA              WTST(11), WTST(12), WTST(13), WTST(14),
     *                  WTST(15)/0.679094042207750455022104478403D0,
     *                  0.163848787360274721122549158591D1,
     *                  0.276944324237083809490196054399D1,
     *                  0.431565690092089471502857194927D1,
     *                  0.721918635435444832588471742846D1/
      DATA              WTST(16), WTST(17), WTST(18), WTST(19),
     *                  WTST(20)/0.573535507422738094574234048232D0,
     *                  0.136925259071230452618549207458D1,
     *                  0.226068459338267234571450339803D1,
     *                  0.335052458235545672265573340326D1,
     *                  0.488682680021082495180621689077D1/
      DATA              WTST(21), WTST(22), WTST(23), WTST(24),
     *                  WTST(25)/0.784901594559582139406265860711D1,
     *                  0.437723410492911373232597580123D0,
     *                  0.103386934766559764249926585582D1,
     *                  0.166970976565877574915392201770D1,
     *                  0.237692470175859948095916909947D1/
      DATA              WTST(26), WTST(27), WTST(28), WTST(29),
     *                  WTST(30)/0.320854091334792628424839184576D1,
     *                  0.426857551082513219858412163065D1,
     *                  0.581808336867192192828814196198D1,
     *                  0.890622621529221140650104288102D1,
     *                  0.354009738606996308762226891442D0/
      DATA              WTST(31), WTST(32), WTST(33), WTST(34),
     *                  WTST(35)/0.831902301043580738109829658127D0,
     *                  0.133028856174932817875279219439D1,
     *                  0.186306390311113098976398873548D1,
     *                  0.245025555808301016607269373165D1,
     *                  0.312276415513518249615081826331D1/
      DATA              WTST(36), WTST(37), WTST(38), WTST(39),
     *                  WTST(40)/0.393415269556152109865581245924D1,
     *                  0.499241487219302310201148565243D1,
     *                  0.657220248513080297518766871037D1,
     *                  0.978469584037463069477008663871D1,
     *                  0.297209636044410797791981220367D0/
      DATA              WTST(41), WTST(42), WTST(43), WTST(44),
     *                  WTST(45)/0.696462980430597230678066955855D0,
     *                  0.110778139461575215333946738014D1,
     *                  0.153846423904282912479403863350D1,
     *                  0.199832760627424276519696409653D1,
     *                  0.250074576910086687475087066330D1/
      DATA              WTST(46), WTST(47), WTST(48), WTST(49),
     *                  WTST(50)/0.306532151828238623620460341805D1,
     *                  0.372328911078277159999560977971D1,
     *                  0.452981402998173506209331191236D1,
     *                  0.559725846183532109269052390850D1,
     *                  0.721299546092587700817113516652D1/
      DATA              WTST(51), WTST(52), WTST(53), WTST(54),
     *                  WTST(55)/0.105438374619100811117158467701D2,
     *                  0.256131154736909453671556041372D0,
     *                  0.599170477495118338515766272071D0,
     *                  0.949971502474957986912548427093D0,
     *                  0.131280781146616393842708842484D1/
      DATA              WTST(56), WTST(57), WTST(58), WTST(59),
     *                  WTST(60)/0.169326599075196535297454106764D1,
     *                  0.209840908427184368777350257727D1,
     *                  0.253763265493539384488200996575D1,
     *                  0.302415991770323993864679517162D1,
     *                  0.357780435571985991642606879222D1/
      DATA              WTST(61), WTST(62), WTST(63), WTST(64),
     *                  WTST(65)/0.423056503490643204894994893849D1,
     *                  0.503941336846351161882976936647D1,
     *                  0.612094792832972552370440564980D1,
     *                  0.777429536700603211748936983427D1,
     *                  0.112168342167033196897235541569D2/
      DATA              WTST(66), WTST(67), WTST(68), WTST(69),
     *                  WTST(70)/0.225036314864247251906600757381D0,
     *                  0.525836052762342453614569410519D0,
     *                  0.831961391687087087665388515060D0,
     *                  0.114609924096375170464795693025D1,
     *                  0.147175131696680858874304204586D1/
      DATA              WTST(71), WTST(72), WTST(73), WTST(74),
     *                  WTST(75)/0.181313468738134816488739610863D1,
     *                  0.217551751969460745206267083222D1,
     *                  0.256576275016502920924861688456D1,
     *                  0.299321508637137516517802515156D1,
     *                  0.347123448310209029087386862759D1/
      DATA              WTST(76), WTST(77), WTST(78), WTST(79),
     *                  WTST(80)/0.402004408644466886647828411535D1,
     *                  0.467251660773285426736570925651D1,
     *                  0.548742065798615247120752800022D1,
     *                  0.658536123328921366083470226903D1,
     *                  0.827635798436423448649507548525D1/
      DATA              WTST(81), WTST(82), WTST(83), WTST(84),
     *                  WTST(85)/0.118242775516584347866877735109D2,
     *                  0.181080062418989255451675405913D0,
     *                  0.422556767878563974520344172566D0,
     *                  0.666909546701848150373482114992D0,
     *                  0.915352372783073672670604684771D0/
      DATA              WTST(86), WTST(87), WTST(88), WTST(89),
     *                  WTST(90)/0.116953970719554597380147822239D1,
     *                  0.143135498592820598636844994891D1,
     *                  0.170298113798502272402533261633D1,
     *                  0.198701589079274721410921839275D1,
     *                  0.228663578125343078546222854681D1/
      DATA              WTST(91), WTST(92), WTST(93), WTST(94),
     *                  WTST(95)/0.260583472755383333269498950954D1,
     *                  0.294978373421395086600235416827D1,
     *                  0.332539578200931955236951937421D1,
     *                  0.374225547058981092111707293265D1,
     *                  0.421423671025188041986808063782D1/
      DATA              WTST(96), WTST(97), WTST(98), WTST(99),
     *                  WTST(100)/0.476251846149020929695292197839D1,
     *                  0.542172604424557430380308297989D1,
     *                  0.625401235693242129289518490300D1,
     *                  0.738731438905443455194030019196D1,
     *                  0.915132873098747960794348242552D1/
      DATA              WTST(101), WTST(102), WTST(103), WTST(104),
     *                  WTST(105)/0.128933886459399966710262871287D2,
     *                  0.151494412859509452265084493232D0,
     *                  0.353256582529923846700037134831D0,
     *                  0.556784563288152601393983130602D0,
     *                  0.762685317697309109177545772892D0/
      DATA              WTST(106), WTST(107), WTST(108), WTST(109),
     *                  WTST(110)/0.971872632246547580059256369503D0,
     *                  0.118535789303780108804108500052D1,
     *                  0.140426562728441853150972524948D1,
     *                  0.162986861575704148558270248151D1,
     *                  0.186363505533207295181759526057D1/
      DATA              WTST(111), WTST(112), WTST(113), WTST(114),
     *                  WTST(115)/0.210729115108148019370959984474D1,
     *                  0.236290589104193499858881524405D1,
     *                  0.263300875316385674795069380502D1,
     *                  0.292075757972772466982359777403D1,
     *                  0.323018513349235362651935975293D1/
      DATA              WTST(116), WTST(117), WTST(118), WTST(119),
     *                  WTST(120)/0.356657337736875656898291635370D1,
     *                  0.393704375545516029872135252120D1,
     *                  0.435153118886351196927787610512D1,
     *                  0.482448185489803577155380384940D1,
     *                  0.537802207978918232457718195130D1/
      DATA              WTST(121), WTST(122), WTST(123), WTST(124),
     *                  WTST(125)/0.604841781261996523358721632126D1,
     *                  0.690089835218049651660271292953D1,
     *                  0.806996515614695609996392008808D1,
     *                  0.990279331948422547854446022889D1,
     *                  0.138205320947920056947750939475D2/
      DATA              WTST(126), WTST(127), WTST(128), WTST(129),
     *                  WTST(130)/0.114187105768104848927622124462D0,
     *                  0.266065216897615216046611346939D0,
     *                  0.418793137324852994249899207384D0,
     *                  0.572532846499804706459178417281D0,
     *                  0.727648788380971310663061585107D0/
      DATA              WTST(131), WTST(132), WTST(133), WTST(134),
     *                  WTST(135)/0.884536719340249717425872878285D0,
     *                  0.104361887589207696731026388350D1,
     *                  0.120534927415235258024261192627D1,
     *                  0.137022133852178118598605841546D1,
     *                  0.153877725646864475240238323237D1/
      DATA              WTST(136), WTST(137), WTST(138), WTST(139),
     *                  WTST(140)/0.171161935268645725598271887040D1,
     *                  0.188942406344948409803711219836D1,
     *                  0.207295934024653366947196417576D1,
     *                  0.226310663399696361289684222133D1,
     *                  0.246088907248823612862689024688D1/
      DATA              WTST(141), WTST(142), WTST(143), WTST(144),
     *                  WTST(145)/0.266750812639711714721138456555D1,
     *                  0.288439209292204179062593430341D1,
     *                  0.311326132703958617632792149348D1,
     *                  0.335621769259580255854557831643D1,
     *                  0.361586985648426880697848391718D1/
      DATA              WTST(146), WTST(147), WTST(148), WTST(149),
     *                  WTST(150)/0.389551304494854956387911255376D1,
     *                  0.419939410471158549451926456093D1,
     *                  0.453311497853436176838674105540D1,
     *                  0.490427028761124484381895572477D1,
     *                  0.532350097202366611244575679955D1/
      DATA              WTST(151), WTST(152), WTST(153), WTST(154),
     *                  WTST(155)/0.580633321423362136100029944855D1,
     *                  0.637661467415965254382865981278D1,
     *                  0.707352658070724212022493611301D1,
     *                  0.796769350929590065853696429051D1,
     *                  0.920504033127818957827330325406D1/
      DATA              WTST(156), WTST(157), WTST(158), WTST(159),
     *                  WTST(160)/0.111630130907678730889083422741D2,
     *                  0.153901804152606431051579823628D2,
     *                  0.765091770514956761342118898575D-1,
     *                  0.178176753775905398828330884895D0,
     *                  0.280182139884356357596595727330D0/
      DATA              WTST(161), WTST(162), WTST(163), WTST(164),
     *                  WTST(165)/0.382496359087169141718115527434D0,
     *                  0.485219064838925983329963727664D0,
     *                  0.588460905319131679496727354214D0,
     *                  0.692336967999966138193085613549D0,
     *                  0.796966494376616045970268027815D0/
      DATA              WTST(166), WTST(167), WTST(168), WTST(169),
     *                  WTST(170)/0.902473457882823144220145784820D0,
     *                  0.100898737232707629800542126981D1,
     *                  0.111664422803075856160612314698D1,
     *                  0.122558754531793799662824812056D1,
     *                  0.133596955840331729647271660268D1/
      DATA              WTST(171), WTST(172), WTST(173), WTST(174),
     *                  WTST(175)/0.144795255226199847441425272802D1,
     *                  0.156171038186323193269790621716D1,
     *                  0.167743021013445771532736944822D1,
     *                  0.179531450931003985792738517152D1,
     *                  0.191558338064478820192149989162D1/
      DATA              WTST(176), WTST(177), WTST(178), WTST(179),
     *                  WTST(180)/0.203847726058527662650086185673D1,
     *                  0.216426009832609346748191008287D1,
     *                  0.229322311147943740839172475438D1,
     *                  0.242568925506195650730249226019D1,
     *                  0.256201857652746411478348320242D1/
      DATA              WTST(181), WTST(182), WTST(183), WTST(184),
     *                  WTST(185)/0.270261467949469543001506372612D1,
     *                  0.284793258591011472410303079716D1,
     *                  0.299848837754813525039891195619D1,
     *                  0.315487112309995635064677782804D1,
     *                  0.331775777168698824008904633906D1/
      DATA              WTST(186), WTST(187), WTST(188), WTST(189),
     *                  WTST(190)/0.348793194021297842501060920895D1,
     *                  0.366630787556595224979178358464D1,
     *                  0.385396138825025874303713182147D1,
     *                  0.405217031962381213209747661016D1,
     *                  0.426246826493193786394704415086D1/
      DATA              WTST(191), WTST(192), WTST(193), WTST(194),
     *                  WTST(195)/0.448671707169671091589039881160D1,
     *                  0.472720648823902161949013908500D1,
     *                  0.498679400159401977932888513142D1,
     *                  0.526910576963126839774948155580D1,
     *                  0.557883330406359379212374112554D1/
      DATA              WTST(196), WTST(197), WTST(198), WTST(199),
     *                  WTST(200)/0.592218562814899595664471636459D1,
     *                  0.630760460370205282500468664054D1,
     *                  0.674694836479823449434242742733D1,
     *                  0.725755907386616981074413594121D1,
     *                  0.786613116690562813520995457417D1/
      DATA              WTST(201), WTST(202), WTST(203), WTST(204),
     *                  WTST(205)/0.861661439476592280229011734260D1,
     *                  0.958839324881700067247977716658D1,
     *                  0.109458446112439663157067260588D2,
     *                  0.131151217146602229005940242378D2,
     *                  0.178491385116857843412986990778D2/
      DATA              WTST(206), WTST(207), WTST(208), WTST(209),
     *                  WTST(210)/0.575280378894525890436272546419D-1,
     *                  0.133947450012544835069889920242D0,
     *                  0.210559520190062753410264651011D0,
     *                  0.287306741593137458969672041580D0,
     *                  0.364227443636669253424976184947D0/
      DATA              WTST(211), WTST(212), WTST(213), WTST(214),
     *                  WTST(215)/0.441366991509961979889210808772D0,
     *                  0.518772490744390800682370587402D0,
     *                  0.596492178616888933402265930722D0,
     *                  0.674575428995967007360981705790D0,
     *                  0.753072886217714028284601274000D0/
      DATA              WTST(216), WTST(217), WTST(218), WTST(219),
     *                  WTST(220)/0.832036640613840971591650743949D0,
     *                  0.911520426089580266925697685845D0,
     *                  0.991579835527047789201975349412D0,
     *                  0.107227255416963941372856442434D1,
     *                  0.115365861273396411749745147603D1/
      DATA              WTST(221), WTST(222), WTST(223), WTST(224),
     *                  WTST(225)/0.123580066279341248881853914308D1,
     *                  0.131876427755265408207115394964D1,
     *                  0.140261828167573410750385225619D1,
     *                  0.148743511441922552285890599395D1,
     *                  0.157329123099770495428549561253D1/
      DATA              WTST(226), WTST(227), WTST(228), WTST(229),
     *                  WTST(230)/0.166026754790322603808659025443D1,
     *                  0.174844993884468966840811618879D1,
     *                  0.183792978910258781922516500950D1,
     *                  0.192880461745247173533359506744D1,
     *                  0.202117877644994616093176453417D1/
      DATA              WTST(231), WTST(232), WTST(233), WTST(234),
     *                  WTST(235)/0.211516424385799162624719639754D1,
     *                  0.221088152041886537611449023992D1,
     *                  0.230846065213609279982632607119D1,
     *                  0.240804239887634595140989226663D1,
     *                  0.250977957560631372032781037131D1/
      DATA              WTST(236), WTST(237), WTST(238), WTST(239),
     *                  WTST(240)/0.261383859818030413164098194230D1,
     *                  0.272040127259742280397253628212D1,
     *                  0.282966687545834169553812193088D1,
     *                  0.294185458451072051222172729948D1,
     *                  0.305720633240365251994286550241D1/
      DATA              WTST(241), WTST(242), WTST(243), WTST(244),
     *                  WTST(245)/0.317599017505567106136883642108D1,
     *                  0.329850428971767201180649338506D1,
     *                  0.342508174873032369478537875834D1,
     *                  0.355609625571314495229008688830D1,
     *                  0.369196908511496649021136048390D1/
      DATA              WTST(246), WTST(247), WTST(248), WTST(249),
     *                  WTST(250)/0.383317753889189122064583790377D1,
     *                  0.398026533306148232515021866253D1,
     *                  0.413385546300965414284704119140D1,
     *                  0.429466628606838520049412599557D1,
     *                  0.446353182779689666078949512940D1/
      DATA              WTST(251), WTST(252), WTST(253), WTST(254),
     *                  WTST(255)/0.464142770270254264085828787326D1,
     *                  0.482950460064931503418077262552D1,
     *                  0.502913212279840979430654758303D1,
     *                  0.524195701287730126627980161538D1,
     *                  0.546998178554909056209921349058D1/
      DATA              WTST(256), WTST(257), WTST(258), WTST(259),
     *                  WTST(260)/0.571567286191836668397881349597D1,
     *                  0.598211240191709826717503888173D1,
     *                  0.627321659221683862023469019562D1,
     *                  0.659405813561881627268928484176D1,
     *                  0.695135801769598999598967976377D1/
      DATA              WTST(261), WTST(262), WTST(263), WTST(264),
     *                  WTST(265)/0.735426394860807842222542512048D1,
     *                  0.781563898596646341332894443685D1,
     *                  0.835431448453341961926802062004D1,
     *                  0.899930753225570263393059351411D1,
     *                  0.979844329910944665303288441737D1/
      DATA              WTST(266), WTST(267), WTST(268),
     *                  WTST(269)/0.108382034590564480648538159816D2,
     *                  0.122978755043572691690380934991D2,
     *                  0.146428784968432459176822293531D2,
     *                  0.197904730417376936028236124789D2/
      DATA              ABST(1), ABST(2), ABST(3), ABST(4),
     *                  ABST(5)/0.100000000000000000000000000000D1,
     *                  0.585786437626904951198311275790D0,
     *                  0.341421356237309504880168872420D+1,
     *                  0.415774556783479083311533873128D0,
     *                  0.229428036027904171982205036135D+1/
      DATA              ABST(6), ABST(7), ABST(8), ABST(9),
     *                  ABST(10)/0.628994508293747919686641576551D+1,
     *                  0.322547689619392311800361459104D0,
     *                  0.174576110115834657568681671251D+1,
     *                  0.453662029692112798327928538495D+1,
     *                  0.939507091230113312923353644342D+1/
      DATA              ABST(11), ABST(12), ABST(13), ABST(14),
     *                  ABST(15)/0.263560319718140910203061943360D0,
     *                  0.141340305910651679221840798018D+1,
     *                  0.359642577104072208122318658878D+1,
     *                  0.708581000585883755692212418110D+1,
     *                  0.126408008442757826594332193065D+2/
      DATA              ABST(16), ABST(17), ABST(18), ABST(19),
     *                  ABST(20)/0.222846604179260689464354826786D0,
     *                  0.118893210167262303074315092193D+1,
     *                  0.299273632605931407769132528451D+1,
     *                  0.577514356910451050183983036943D+1,
     *                  0.983746741838258991771554702994D+1/
      DATA              ABST(21), ABST(22), ABST(23), ABST(24),
     *                  ABST(25)/0.159828739806017017825457915673D+2,
     *                  0.170279632305100999788861856608D0,
     *                  0.903701776799379912186020223555D0,
     *                  0.225108662986613068930711836696D+1,
     *                  0.426670017028765879364942182690D+1/
      DATA              ABST(26), ABST(27), ABST(28), ABST(29),
     *                  ABST(30)/0.704590540239346569727932548211D+1,
     *                  0.107585160101809952240599567880D+2,
     *                  0.157406786412780045780287611584D+2,
     *                  0.228631317368892641057005342974D+2,
     *                  0.137793470540492430830772505652D0/
      DATA              ABST(31), ABST(32), ABST(33), ABST(34),
     *                  ABST(35)/0.729454549503170498160373121676D0,
     *                  0.180834290174031604823292007575D+1,
     *                  0.340143369785489951448253222140D+1,
     *                  0.555249614006380363241755848686D+1,
     *                  0.833015274676449670023876719727D+1/
      DATA              ABST(36), ABST(37), ABST(38), ABST(39),
     *                  ABST(40)/0.118437858379000655649185389191D+2,
     *                  0.162792578313781020995326539358D+2,
     *                  0.219965858119807619512770901955D+2,
     *                  0.299206970122738915599087933407D+2,
     *                  0.115722117358020675267196428240D0/
      DATA              ABST(41), ABST(42), ABST(43), ABST(44),
     *                  ABST(45)/0.611757484515130665391630053041D0,
     *                  0.151261026977641878678173792686D+1,
     *                  0.283375133774350722862747177657D+1,
     *                  0.459922763941834848460572922485D+1,
     *                  0.684452545311517734775433041849D+1/
      DATA              ABST(46), ABST(47), ABST(48), ABST(49),
     *                  ABST(50)/0.962131684245686704391238234923D+1,
     *                  0.130060549933063477203460524294D+2,
     *                  0.171168551874622557281840528007D+2,
     *                  0.221510903793970056699218950836D+2,
     *                  0.284879672509840003125686072325D+2/
      DATA              ABST(51), ABST(52), ABST(53), ABST(54),
     *                  ABST(55)/0.370991210444669203366389142763D+2,
     *                  0.997475070325975745736829452514D-1,
     *                  0.526857648851902896404583451502D0,
     *                  0.130062912125149648170842022115D+1,
     *                  0.243080107873084463616999751038D+1/
      DATA              ABST(56), ABST(57), ABST(58), ABST(59),
     *                  ABST(60)/0.393210282229321888213134366777D+1,
     *                  0.582553621830170841933899983898D+1,
     *                  0.814024014156514503005978046052D+1,
     *                  0.109164995073660188408130510904D+2,
     *                  0.142108050111612886831059780825D+2/
      DATA              ABST(61), ABST(62), ABST(63), ABST(64),
     *                  ABST(65)/0.181048922202180984125546272082D+2,
     *                  0.227233816282696248232280886984D+2,
     *                  0.282729817232482056954158923217D+2,
     *                  0.351494436605924265828643121363D+2,
     *                  0.443660817111174230416312423665D+2/
      DATA              ABST(66), ABST(67), ABST(68), ABST(69),
     *                  ABST(70)/0.876494104789278403601980973401D-1,
     *                  0.462696328915080831880838260664D0,
     *                  0.114105777483122685687794501810D+1,
     *                  0.212928364509838061632615907065D+1,
     *                  0.343708663389320664523510701675D+1/
      DATA              ABST(71), ABST(72), ABST(73), ABST(74),
     *                  ABST(75)/0.507801861454976791292305830814D+1,
     *                  0.707033853504823413039598947080D+1,
     *                  0.943831433639193878394724672911D+1,
     *                  0.122142233688661587369391246088D+2,
     *                  0.154415273687816170767647741622D+2/
      DATA              ABST(76), ABST(77), ABST(78), ABST(79),
     *                  ABST(80)/0.191801568567531348546631409497D+2,
     *                  0.235159056939919085318231872751D+2,
     *                  0.285787297428821403675206137098D+2,
     *                  0.345833987022866258145276871777D+2,
     *                  0.419404526476883326354722330251D+2/
      DATA              ABST(81), ABST(82), ABST(83), ABST(84),
     *                  ABST(85)/0.517011603395433183643426971196D+2,
     *                  0.705398896919887533666890045842D-1,
     *                  0.372126818001611443794241388761D0,
     *                  0.916582102483273564667716277074D0,
     *                  0.170730653102834388068768966741D+1/
      DATA              ABST(86), ABST(87), ABST(88), ABST(89),
     *                  ABST(90)/0.274919925530943212964503046049D+1,
     *                  0.404892531385088692237495336913D+1,
     *                  0.561517497086161651410453988565D+1,
     *                  0.745901745367106330976886021837D+1,
     *                  0.959439286958109677247367273428D+1/
      DATA              ABST(91), ABST(92), ABST(93), ABST(94),
     *                  ABST(95)/0.120388025469643163096234092988D+2,
     *                  0.148142934426307399785126797100D+2,
     *                  0.179488955205193760173657909926D+2,
     *                  0.214787882402850109757351703695D+2,
     *                  0.254517027931869055035186774846D+2/
      DATA              ABST(96), ABST(97), ABST(98), ABST(99),
     *                  ABST(100)/0.299325546317006120067136561351D+2,
     *                  0.350134342404790000062849359066D+2,
     *                  0.408330570567285710620295677078D+2,
     *                  0.476199940473465021399416271528D+2,
     *                  0.558107957500638988907507734444D+2/
      DATA              ABST(101), ABST(102), ABST(103), ABST(104),
     *                  ABST(105)/0.665244165256157538186403187914D+2,
     *                  0.590198521815079769729796536122D-1,
     *                  0.311239146198483726857006190420D0,
     *                  0.766096905545936646238779533956D0,
     *                  0.142559759080361308631349091388D+1/
      DATA              ABST(106), ABST(107), ABST(108), ABST(109),
     *                  ABST(110)/0.229256205863219029495204873720D+1,
     *                  0.337077426420899771619826348266D+1,
     *                  0.466508370346717079205845386989D+1,
     *                  0.618153511873676541184349133097D+1,
     *                  0.792753924717215217938007631016D+1/
      DATA              ABST(111), ABST(112), ABST(113), ABST(114),
     *                  ABST(115)/0.991209801507770601882725231142D+1,
     *                  0.121461027117297655500645484691D+2,
     *                  0.146427322895966743422854804679D+2,
     *                  0.174179926465089787263183235716D+2,
     *                  0.204914600826164247068259432350D+2/
      DATA              ABST(116), ABST(117), ABST(118), ABST(119),
     *                  ABST(120)/0.238873298481697331753233786780D+2,
     *                  0.276359371743327174202705297948D+2,
     *                  0.317760413523747232883580042751D+2,
     *                  0.363584058016516216531070205907D+2,
     *                  0.414517204848707670507153988602D+2/
      DATA              ABST(121), ABST(122), ABST(123), ABST(124),
     *                  ABST(125)/0.471531064451563230413708267956D+2,
     *                  0.536085745446950698237910753558D+2,
     *                  0.610585314472187615638081429898D+2,
     *                  0.699622400351050304314877818947D+2,
     *                  0.814982792339488853766317026866D+2/
      DATA              ABST(126), ABST(127), ABST(128), ABST(129),
     *                  ABST(130)/0.444893658332670184188501945243D-1,
     *                  0.234526109519618537452909561301D0,
     *                  0.576884629301886426491552569377D0,
     *                  0.107244875381781763304091397717D+1,
     *                  0.172240877644464544113093292797D+1/
      DATA              ABST(131), ABST(132), ABST(133), ABST(134),
     *                  ABST(135)/0.252833670642579488112419990555D+1,
     *                  0.349221327302199448960880339977D+1,
     *                  0.461645676974976738776205229617D+1,
     *                  0.590395850417424394656152149158D+1,
     *                  0.735812673318624111322198973719D+1/
      DATA              ABST(136), ABST(137), ABST(138), ABST(139),
     *                  ABST(140)/0.898294092421259610337824752676D+1,
     *                  0.107830186325399720675019491380D+2,
     *                  0.127636979867427251149690330822D+2,
     *                  0.149311397555225573197969646873D+2,
     *                  0.172924543367153147892357183836D+2/
      DATA              ABST(141), ABST(142), ABST(143), ABST(144),
     *                  ABST(145)/0.198558609403360547397899445841D+2,
     *                  0.226308890131967744886757793393D+2,
     *                  0.256286360224592477674761768768D+2,
     *                  0.288621018163234747443426407115D+2,
     *                  0.323466291539647370032321654236D+2/
      DATA              ABST(146), ABST(147), ABST(148), ABST(149),
     *                  ABST(150)/0.361004948057519738040171189479D+2,
     *                  0.401457197715394415362093439289D+2,
     *                  0.445092079957549379759066043775D+2,
     *                  0.492243949873086391767222218065D+2,
     *                  0.543337213333969073328671815511D+2/
      DATA              ABST(151), ABST(152), ABST(153), ABST(154),
     *                  ABST(155)/0.598925091621340181961304753246D+2,
     *                  0.659753772879350527965630761193D+2,
     *                  0.726876280906627086386753490877D+2,
     *                  0.801874469779135230674916385686D+2,
     *                  0.887353404178923986893554495242D+2/
      DATA              ABST(156), ABST(157), ABST(158), ABST(159),
     *                  ABST(160)/0.988295428682839725591844784095D+2,
     *                  0.111751398097937695213664716539D+3,
     *                  0.298112358299601106829853667398D-1,
     *                  0.157107990617876302228195178939D0,
     *                  0.386265037576455586428816629438D0/
      DATA              ABST(161), ABST(162), ABST(163), ABST(164),
     *                  ABST(165)/0.717574694116972254573576608055D0,
     *                  0.115139383402643463980184566755D+1,
     *                  0.168818582341904720592285004127D+1,
     *                  0.232852700665322873332764798204D+1,
     *                  0.307311086165263883575281517844D+1/
      DATA              ABST(166), ABST(167), ABST(168), ABST(169),
     *                  ABST(170)/0.392275241304648049404373262669D+1,
     *                  0.487839335592134610923895222351D+1,
     *                  0.594110805462455896865557843817D+1,
     *                  0.711211053589074335395756436908D+1,
     *                  0.839276259909122462543275584035D+1/
      DATA              ABST(171), ABST(172), ABST(173), ABST(174),
     *                  ABST(175)/0.978458318468732328311039934253D+1,
     *                  0.112892591680095271459189553326D+2,
     *                  0.129086577782855308951121527464D+2,
     *                  0.146448408832097058214254190541D+2,
     *                  0.165000814289645861331718007023D+2/
      DATA              ABST(176), ABST(177), ABST(178), ABST(179),
     *                  ABST(180)/0.184768823868741128170595461291D+2,
     *                  0.205779986340222095048549228477D+2,
     *                  0.228064622905213716617755943301D+2,
     *                  0.251656121564391080064746932077D+2,
     *                  0.276591280444805295952522961805D+2/
      DATA              ABST(181), ABST(182), ABST(183), ABST(184),
     *                  ABST(185)/0.302910710010085672389940239882D+2,
     *                  0.330659306624987441669455760390D+2,
     *                  0.359886813274789357829330330344D+2,
     *                  0.390648487641977701833743857277D+2,
     *                  0.423005903629030935825241353591D+2/
      DATA              ABST(186), ABST(187), ABST(188), ABST(189),
     *                  ABST(190)/0.457027920385114703676741052240D+2,
     *                  0.492791863828367928598558836374D+2,
     *                  0.530384980878166647263784462888D+2,
     *                  0.569906248148044758260119738032D+2,
     *                  0.611468647861402287499987744077D+2/
      DATA              ABST(191), ABST(192), ABST(193), ABST(194),
     *                  ABST(195)/0.655202069290186065213469036256D+2,
     *                  0.701257062361131915516608967787D+2,
     *                  0.749809775189113105914056728904D+2,
     *                  0.801068573503243938016002357403D+2,
     *                  0.855283111160341678871016141692D+2/
      DATA              ABST(196), ABST(197), ABST(198), ABST(199),
     *                  ABST(200)/0.912757079936680894506618458847D+2,
     *                  0.973866677135815318301368770382D+2,
     *                  0.103908833357176254669020231842D+3,
     *                  0.110904220884976275490415573534D+3,
     *                  0.118456425046283632024607258015D+3/
      DATA              ABST(201), ABST(202), ABST(203), ABST(204),
     *                  ABST(205)/0.126683425768885830929664830625D+3,
     *                  0.135762589577864301973383740811D+3,
     *                  0.145986432709463454689492988746D+3,
     *                  0.157915612022977989521785821968D+3,
     *                  0.172996328148563253498822074794D+3/
      DATA              ABST(206), ABST(207), ABST(208), ABST(209),
     *                  ABST(210)/0.224158741467052800228118848190D-1,
     *                  0.118122512096770479797466436710D0,
     *                  0.290365744018036483999130066385D0,
     *                  0.539286221227979039318144947812D0,
     *                  0.865037004648113944619955074709D0/
      DATA              ABST(211), ABST(212), ABST(213), ABST(214),
     *                  ABST(215)/0.126781404077524139811570887769D+1,
     *                  0.174785962605943625282996395128D+1,
     *                  0.230546373930750871854807054389D+1,
     *                  0.294096515672525184067946815210D+1,
     *                  0.365475265020729052703539791209D+1/
      DATA              ABST(216), ABST(217), ABST(218), ABST(219),
     *                  ABST(220)/0.444726634331309435674255098016D+1,
     *                  0.531899925449639034352210985918D+1,
     *                  0.627049904692365391291106464633D+1,
     *                  0.730237000258739574722349840951D+1,
     *                  0.841527523948302419449521859120D+1/
      DATA              ABST(221), ABST(222), ABST(223), ABST(224),
     *                  ABST(225)/0.960993919279610803576288204954D+1,
     *                  0.108871503838863721425945504201D+2,
     *                  0.122477645042443016181623692907D+2,
     *                  0.136927078455475051527299325746D+2,
     *                  0.152229811115247288480082687834D+2/
      DATA              ABST(226), ABST(227), ABST(228), ABST(229),
     *                  ABST(230)/0.168396636526487372105288380391D+2,
     *                  0.185439181708591905236196259710D+2,
     *                  0.203369959487302355011498158064D+2,
     *                  0.222202426659508765399221543470D+2,
     *                  0.241951048759332539898864438802D+2/
      DATA              ABST(231), ABST(232), ABST(233), ABST(234),
     *                  ABST(235)/0.262631372271184857851260239547D+2,
     *                  0.284260105275010272994997715267D+2,
     *                  0.306855207675259717710485823984D+2,
     *                  0.330435992364378291255202106805D+2,
     *                  0.355023238911412095869787785350D+2/
      DATA              ABST(236), ABST(237), ABST(238), ABST(239),
     *                  ABST(240)/0.380639321656464682603573179150D+2,
     *                  0.407308354444586263657318695132D+2,
     *                  0.435056354664215298527031849317D+2,
     *                  0.463911429786161920736053999423D+2,
     *                  0.493903990256246866792358008226D+2/
      DATA              ABST(241), ABST(242), ABST(243), ABST(244),
     *                  ABST(245)/0.525066993413463016501792769804D+2,
     *                  0.557436224132783804633357112911D+2,
     *                  0.591050619190171066088487420918D+2,
     *                  0.625952644001513955960550179011D+2,
     *                  0.662188732512475643822137626710D+2/
      DATA              ABST(246), ABST(247), ABST(248), ABST(249),
     *                  ABST(250)/0.699809803771468292285346579722D+2,
     *                  0.738871872324829632109574031135D+2,
     *                  0.779436774344631203136879758705D+2,
     *                  0.821573037783193042951958683422D+2,
     *                  0.865356933494565182102162783752D+2/
      DATA              ABST(251), ABST(252), ABST(253), ABST(254),
     *                  ABST(255)/0.910873756131330901456367153492D+2,
     *                  0.958219400155207320947672154364D+2,
     *                  0.100750231969513979629259261451D+3,
     *                  0.105884599468799949356360427850D+3,
     *                  0.111239207524439582063484736637D+3/
      DATA              ABST(256), ABST(257), ABST(258), ABST(259),
     *                  ABST(260)/0.116830445051306498463386669077D+3,
     *                  0.122677460268538576577419690564D+3,
     *                  0.128802878769237672512753623054D+3,
     *                  0.135233787949525827833980498878D+3,
     *                  0.142003121489931519025140038291D+3/
      DATA              ABST(261), ABST(262), ABST(263), ABST(264),
     *                  ABST(265)/0.149151665900049388587293462932D+3,
     *                  0.156731075132671161233616960813D+3,
     *                  0.164808602655150522993190109025D+3,
     *                  0.173474946836424274522152844866D+3,
     *                  0.182858204691431463646342794509D+3/
      DATA              ABST(266), ABST(267), ABST(268),
     *                  ABST(269)/0.193151136037072911479385527417D+3,
     *                  0.204672028485059455949064433342D+3,
     *                  0.218031851935328516332452384448D+3,
     *                  0.234809579171326164713055529725D+3/
      DATA              NSTOR(1), NSTOR(2), NSTOR(3), NSTOR(4)/1, 2, 3,
     *                  4/
      DATA              NSTOR(5), NSTOR(6), NSTOR(7), NSTOR(8)/5, 6, 8,
     *                  10/
      DATA              NSTOR(9), NSTOR(10), NSTOR(11), NSTOR(12)/12,
     *                  14, 16, 20/
      DATA              NSTOR(13), NSTOR(14), NSTOR(15), NSTOR(16)/24,
     *                  32, 48, 64/
C     .. Executable Statements ..
      DO 20 I = 1, NPTS
         WEIGHT(I) = 0.0D0
         ABSCIS(I) = 0.0D0
   20 CONTINUE
      IF (B.NE.0.0D0) GO TO 40
      IFAIL = 2
      RETURN
   40 N = 0
      NPTSA = 0
      IFAIL = 0
      DO 60 I = 1, 16
         IF (NPTS.LT.NSTOR(I)) GO TO 80
         N = N + NPTSA
         NPTSA = NSTOR(I)
         IF (NPTS.EQ.NSTOR(I)) GO TO 100
   60 CONTINUE
   80 IFAIL = 1
  100 DO 120 NN = 1, NPTSA
         N = N + 1
         ABSCIS(NN) = ABST(N)/B + A
         WEIGHT(NN) = WTST(N)/B
         IF (B.LT.0.0D0) WEIGHT(NN) = -WEIGHT(NN)
  120 CONTINUE
      IF (ITYPE.EQ.1) GO TO 180
      EXPMIN = LOG(X02AMF())
      DO 160 N = 1, NPTSA
         EXPNOW = -B*ABSCIS(N) + LOG(WEIGHT(N))
         IF (EXPNOW.LT.EXPMIN) GO TO 140
         WEIGHT(N) = EXP(EXPNOW)
         GO TO 160
  140    IFAIL = 3
         WEIGHT(N) = 0.0D0
  160 CONTINUE
  180 RETURN
      END
