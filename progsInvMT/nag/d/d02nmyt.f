      SUBROUTINE D02NMY(METH,A,B,TESCO,GAMMA,C)
C     MARK 12 RELEASE. NAG COPYRIGHT 1986.
C
C     OLD NAME CFODE
C
C     .. Scalar Arguments ..
      INTEGER           METH
C     .. Array Arguments ..
      DOUBLE PRECISION  A(13,12), B(12,11), C(11), GAMMA(11),
     *                  TESCO(3,12)
C     .. Local Scalars ..
      INTEGER           I, J
C     .. Executable Statements ..
C-----------------------------------------------------------------------
C D02NMY IS CALLED BY THE INTEGRATOR ROUTINE TO SET COEFFICIENTS
C NEEDED THERE.  THE COEFFICIENTS FOR THE CURRENT METHOD, AS
C GIVEN BY THE VALUE OF METH, ARE SET FOR ALL ORDERS AND SAVED.
C THE MAXIMUM ORDER ASSUMED HERE IS 12 IF METH = 1 AND 11 IF METH = 2.
C (A SMALLER VALUE OF THE MAXIMUM ORDER IS ALSO ALLOWED.)
C D02NMY IS CALLED ONCE AT THE BEGINNING OF THE PROBLEM,
C AND IS NOT CALLED AGAIN UNLESS AND UNTIL METH IS CHANGED.
C
C THE A  ARRAY CONTAINS THE BASIC METHOD COEFFICIENTS.
C THE COEFFICIENTS AL(I), 1 .LE. I .LE. NQ+1, FOR THE METHOD OF
C ORDER NQ ARE STORED IN A(I,NQ). THE SAME APPLIES TO THE ARRAY B.
C
C THE TESCO ARRAY CONTAINS TEST CONSTANTS USED FOR THE
C LOCAL ERROR TEST AND THE SELECTION OF STEP SIZE AND/OR ORDER.
C AT ORDER NQ, TESCO(K,NQ) IS USED FOR THE SELECTION OF STEP
C SIZE AT ORDER NQ - 1 IF K = 1, AT ORDER NQ IF K = 2, AND AT ORDER
C NQ + 1 IF K = 3.
C-----------------------------------------------------------------------
      DO 40 I = 1, 12
         A(2,I) = -1.0D0
         A(1,I) = 0.0D0
         DO 20 J = 3, 13
            A(J,I) = 0.0D0
   20    CONTINUE
   40 CONTINUE
      A(1,1) = -.5D0
C
      A(1,2) = -.4166666666666667D0
      A(3,2) = -.5D0
C
      A(1,3) = -.375D0
      A(3,3) = -.75D0
      A(4,3) = -.1666666666666667D0
C
      A(1,4) = -.3486111111111111D0
      A(3,4) = -.9166666666666667D0
      A(4,4) = -.3333333333333333D0
      A(5,4) = -.04166666666666667D0
C
      A(1,5) = -.3298611111111111D0
      A(3,5) = -1.041666666666667D0
      A(4,5) = -.4861111111111111D0
      A(5,5) = -.1041666666666667D0
      A(6,5) = -.008333333333333333D0
C
      A(1,6) = -.3155919312169312D0
      A(3,6) = -1.141666666666667D0
      A(4,6) = -.625D0
      A(5,6) = -.1770833333333333D0
      A(6,6) = -.025D0
      A(7,6) = -.001388888888888889D0
C
      A(1,7) = -.3042245370370370D0
      A(3,7) = -1.225D0
      A(4,7) = -.7518518518518519D0
      A(5,7) = -.2552083333333333D0
      A(6,7) = -.04861111111111111D0
      A(7,7) = -.004861111111111111D0
      A(8,7) = -.0001984126984126984D0
C
      A(1,8) = -.2948680004409171D0
      A(3,8) = -1.296428571428485D0
      A(4,8) = -.8685185185185185D0
      A(5,8) = -.3357638888888888D0
      A(6,8) = -.07777777777777777D0
      A(7,8) = -.01064814814814815D0
      A(8,8) = -.0007936507936507937D0
      A(9,8) = -.0000248015873015873D0
C
      A(1,9) = -.2869754464285714D0
      A(3,9) = -1.35892857142857D0
      A(4,9) = -.976554232804233D0
      A(5,9) = -.4171875D0
      A(6,9) = -.1113541666666667D0
      A(7,9) = -.01875D0
      A(8,9) = -.001934523809523809D0
      A(9,9) = -.000111607142857143D0
      A(10,9) = -.00000275573192239859D0
C
      A(1,10) = -.280189564439367D0
      A(3,10) = -1.41448412698413D0
      A(4,10) = -1.07721560846561D0
      A(5,10) = -.498567019400353D0
      A(6,10) = -.1484375D0
      A(7,10) = -.0290605709876543D0
      A(8,10) = -.0037202380952381D0
      A(9,10) = -.000299685846560847D0
      A(10,10) = -.0000137786596119929D0
      A(11,10) = -.00000027557319223986D0
C
      A(1,11) = -.274265540031599D0
      A(3,11) = -1.46448412698413D0
      A(4,11) = -1.17151455026455D0
      A(5,11) = -.579358190035273D0
      A(6,11) = -.188322861552028D0
      A(7,11) = -.0414303626543210D0
      A(8,11) = -.0062111447989418D0
      A(9,11) = -.000625206679894180D0
      A(10,11) = -.0000404174015285126D0
      A(11,11) = -.00000151565255731922D0
      A(12,11) = -.0000000250521083854417D0
C
      A(1,12) = -.2690288467736492D0
      A(3,12) = -1.50993867243867D0
      A(4,12) = -1.26027116402116D0
      A(5,12) = -.659234182098765D0
      A(6,12) = -.230458002645503D0
      A(7,12) = -.0556972461052322D0
      A(8,12) = -.00943948412698413D0
      A(9,12) = -.00111927496693122D0
      A(10,12) = -.0000909391534391534D0
      A(11,12) = -.00000482253086419753D0
      A(12,12) = -.000000150312650312650D0
      A(13,12) = -.00000000208767569878681D0
      DO 80 I = 1, 11
         B(1,I) = -1.0D0
         DO 60 J = 2, 12
            B(J,I) = 0.0D0
   60    CONTINUE
   80 CONTINUE
      B(2,1) = -1.D0
C
      B(2,2) = -1.5D0
      B(3,2) = -.5D0
C
      B(2,3) = -1.833333333333333D0
      B(3,3) = -1.D0
      B(4,3) = -.1666666666666667D0
C
      B(2,4) = -2.083333333333333D0
      B(3,4) = -1.458333333333333D0
      B(4,4) = -.4166666666666667D0
      B(5,4) = -.04166666666666667D0
C
      B(2,5) = -2.283333333333333D0
      B(3,5) = -1.875D0
      B(4,5) = -.7083333333333333D0
      B(5,5) = -.125D0
      B(6,5) = -.008333333333333333D0
C
      B(2,6) = -2.45D0
      B(3,6) = -2.255555555555556D0
      B(4,6) = -1.020833333333333D0
      B(5,6) = -.2430555555555556D0
      B(6,6) = -.02916666666666667D0
      B(7,6) = -.001388888888888889D0
C
      B(2,7) = -2.59285714285714D0
      B(3,7) = -2.605555555555556D0
      B(4,7) = -1.343055555555556D0
      B(5,7) = -.3888888888888889D0
      B(6,7) = -.06388888888888889D0
      B(7,7) = -.005555555555555556D0
      B(8,7) = -.000198412698412698D0
C
      B(2,8) = -2.71785714285714D0
      B(3,8) = -2.92966269841270D0
      B(4,8) = -1.66875D0
      B(5,8) = -.5567708333333333D0
      B(6,8) = -.1125D0
      B(7,8) = -.01354166666666667D0
      B(8,8) = -.000892857142857143D0
      B(9,8) = -.0000248015873015873D0
C
      B(2,9) = -2.82896825396825D0
      B(3,9) = -3.23164682539683D0
      B(4,9) = -1.99426807760141D0
      B(5,9) = -.7421875D0
      B(6,9) = -.174363425925926D0
      B(7,9) = -.02604166666666667D0
      B(8,9) = -.00239748677248677D0
      B(9,9) = -.000124007936507937D0
      B(10,9) = -.00000275573192239859D0
C
      B(2,10) = -2.92896825396825D0
      B(3,10) = -3.51454365079365D0
      B(4,10) = -2.31743276014109D0
      B(5,10) = -.941614307760141D0
      B(6,10) = -.248582175925926D0
      B(7,10) = -.0434780092592593D0
      B(8,10) = -.00500165343915344D0
      B(9,10) = -.000363756613756614D0
      B(10,10) = -.0000151565255731922D0
      B(11,10) = -.000000275573192239859D0
C
      B(2,11) = -3.01987734487735D0
      B(3,11) = -3.78081349206349D0
      B(4,11) = -2.63693672839506D0
      B(5,11) = -1.15229001322751D0
      B(6,11) = -.334183476631393D0
      B(7,11) = -.06607638888888889D0
      B(8,11) = -.00895419973544974D0
      B(9,11) = -.000818452380952381D0
      B(10,11) = -.0000482253086419753D0
      B(11,11) = -.00000165343915343915D0
      B(12,11) = -.0000000250521083854417D0
C
C      DEFINE THE C AND GAMMA ARRAYS
C
      GAMMA(1) = 0.08578644D0
      GAMMA(2) = 0.1250D0
      GAMMA(3) = 0.121890D0
      GAMMA(4) = 0.12849970D0
      GAMMA(5) = 0.10872640D0
      GAMMA(6) = 0.096259610D0
      GAMMA(7) = 0.08754865D0
      GAMMA(8) = 0.08105623D0
      GAMMA(9) = 0.07599874D0
      GAMMA(10) = 0.07192936D0
      GAMMA(11) = 0.06857227D0
      C(1) = 0.29289320D0
      C(2) = 0.3374973D0
      C(3) = 0.3335427D0
      C(4) = 0.34273290D0
      C(5) = 0.31690580D0
      C(6) = 0.29929710D0
      C(7) = 0.28623920D0
      C(8) = 0.2760327D0
      C(9) = 0.2677630D0
      C(10) = 0.26088340D0
      C(11) = 0.25504260D0
      DO 100 J = 1, 12
         TESCO(2,J) = J + 1.0D0
         TESCO(3,J) = J + 2.0D0
  100 CONTINUE
      TESCO(1,1) = 1.0D0
      TESCO(1,2) = 1.0D0
      TESCO(1,3) = 0.5D0
      TESCO(1,4) = 0.1667D0
      TESCO(1,5) = 0.4167D-1
      TESCO(1,6) = 0.8333D-2
      TESCO(1,7) = 0.1389D-2
      TESCO(1,8) = 0.1984D-3
      TESCO(1,9) = 0.248D-4
      TESCO(1,10) = 0.2756D-5
      TESCO(1,11) = 0.2756D-6
      TESCO(1,12) = 0.2505D-7
      RETURN
      END
