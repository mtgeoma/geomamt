      SUBROUTINE D02HBV(IFAIL)
C     MARK 8 RELEASE. NAG COPYRIGHT 1979.
C     MARK 11.5(F77) REVISED. (SEPT 1985.)
C     .. Scalar Arguments ..
      INTEGER           IFAIL
C     .. Scalars in Common ..
      INTEGER           ICASE, IFAIL2, IFAIL3, IW1
C     .. Arrays in Common ..
      DOUBLE PRECISION  W(7)
      INTEGER           IW(4)
C     .. Local Scalars ..
      INTEGER           I, NERR
C     .. Local Arrays ..
      CHARACTER*80      REC(3)
C     .. External Subroutines ..
      EXTERNAL          X04AAF, X04BAF
C     .. Common blocks ..
      COMMON            /AD02HB/IFAIL2, IFAIL3
      COMMON            /AD02SA/W, IW, IW1, ICASE
C     .. Executable Statements ..
      IF (IFAIL2.EQ.0) RETURN
      CALL X04AAF(0,NERR)
      GO TO (20,40,80,120,140,180,200,220,240,
     *       240,240,240,240) IFAIL
C     INPUT ERROR
   20 CALL X04BAF(NERR,' ')
      WRITE (REC,FMT=99999)
      CALL X04BAF(NERR,REC(1))
      RETURN
C     STEP TOO SHORT
   40 CALL X04BAF(NERR,' ')
      WRITE (REC,FMT=99998)
      DO 60 I = 1, 2
         CALL X04BAF(NERR,REC(I))
   60 CONTINUE
      RETURN
C     INITIAL STEP IMPOSSIBLE
   80 CALL X04BAF(NERR,' ')
      WRITE (REC,FMT=99997)
      DO 100 I = 1, 2
         CALL X04BAF(NERR,REC(I))
  100 CONTINUE
      RETURN
C     STEP TOO SMALL IN JACOBIAN CALCULATION
  120 CALL X04BAF(NERR,' ')
      WRITE (REC,FMT=99996)
      CALL X04BAF(NERR,REC(1))
      RETURN
C     INITIAL STEP IMPOSS.IN JAC.CALC.
  140 CALL X04BAF(NERR,' ')
      WRITE (REC,FMT=99995)
      DO 160 I = 1, 2
         CALL X04BAF(NERR,REC(I))
  160 CONTINUE
      RETURN
C     INSIGNIFICANT COLUMN IN JACOBIAN
  180 CALL X04BAF(NERR,' ')
      WRITE (REC,FMT=99994)
      CALL X04BAF(NERR,REC(1))
      RETURN
C     SVD FAIL
  200 CALL X04BAF(NERR,' ')
      WRITE (REC,FMT=99993)
      CALL X04BAF(NERR,REC(1))
      RETURN
C     NO CONVERGENCE
  220 CALL X04BAF(NERR,' ')
      WRITE (REC,FMT=99992)
      CALL X04BAF(NERR,REC(1))
      RETURN
C     SERIOUS ERROR EXIT
  240 CALL X04BAF(NERR,' ')
      WRITE (REC,FMT=99991)
      CALL X04BAF(NERR,REC(1))
      I = IFAIL - 8
      GO TO (260,280,300,320,340) I
  260 WRITE (REC,FMT=99990)
      CALL X04BAF(NERR,REC(1))
      GO TO 360
  280 WRITE (REC,FMT=99989)
      CALL X04BAF(NERR,REC(1))
      GO TO 360
  300 WRITE (REC,FMT=99988)
      CALL X04BAF(NERR,REC(1))
      GO TO 360
  320 WRITE (REC,FMT=99987)
      CALL X04BAF(NERR,REC(1))
      GO TO 360
  340 WRITE (REC,FMT=99986)
      CALL X04BAF(NERR,REC(1))
  360 WRITE (REC,FMT=99985)
      DO 380 I = 1, 3
         CALL X04BAF(NERR,REC(I))
  380 CONTINUE
      RETURN
C
99999 FORMAT (' ERROR IN INPUT PARAMETER SETTING - SEE ROUTINE DOCUMENT'
     *  )
99998 FORMAT (' STEP-LENGTH TOO SMALL IN INTEGRATION WITH CURRENT',
     *  /'  PARAMETERS')
99997 FORMAT (' NO INITIAL STEP-LENGTH COULD BE FOUND FOR INTEGRATION ',
     *  'WITH',/'  CURRENT PARAMETERS')
99996 FORMAT (' STEP-LENGTH TOO SMALL IN INTEGRATION TO FIND JACOBIAN')
99995 FORMAT (' NO INITIAL STEP-LENGTH COULD BE FOUND FOR INTEGRATION ',
     *  'TO',/'  FIND JACOBIAN')
99994 FORMAT (' THE JACOBIAN HAS AN INSIGNIFICANT COLUMN')
99993 FORMAT (' FAILURE IN CALCULATION OF SINGULAR VALUE DECOMPOSITION')
99992 FORMAT (' THE NEWTON ITERATION FAILED TO CONVERGE')
99991 FORMAT (' A SERIOUS ERROR HAS OCCURRED IN THE AUXILIARY ROUTINE')
99990 FORMAT ('      D02SAZ')
99989 FORMAT ('      D02SAW')
99988 FORMAT ('      D02SAX')
99987 FORMAT ('      D02SAU')
99986 FORMAT ('      D02SAV')
99985 FORMAT ('  CHECK ALL ARRAY DIMENSIONS, ARGUMENTS, AND NUMBER OF',
     *  /'  ARGUMENTS IN CALL OF PRIMARY ROUTINE',/'  IF UNABLE TO LOC',
     *  'ATE ERROR, SEEK EXPERT HELP')
      END
