      SUBROUTINE G13BFX(ITC,S,D,PARA,NPARA,NPE,MTYP,MSER,KTF,KTFV)
C     MARK 11 RELEASE. NAG COPYRIGHT 1983.
C     MARK 11.5(F77) REVISED. (SEPT 1985.)
C
C     SUBROUTINE G13BFX GIVES A PRINT OUT OF THE PROGRESS OF
C     THE CONVERGENCE. ON EACH ITERATION IT PRINTS OUT THE
C     ITERATION COUNT, THE RESIDUAL SS, THE OBJECTIVE FUNCTION AND
C     THE DESCRIPTION AND VALUE OF EACH PARAMETER ESTIMATED.
C     IT ALWAYS PRINTS OUT THE CONSTANT WHETHER FIXED OR ESTIMATED.
C
C     .. Scalar Arguments ..
      DOUBLE PRECISION  D, S
      INTEGER           ITC, KTF, KTFV, NPARA, NPE
C     .. Array Arguments ..
      DOUBLE PRECISION  PARA(NPARA)
      INTEGER           MSER(NPE), MTYP(NPE)
C     .. Local Scalars ..
      INTEGER           I, J, K, NOUT
C     .. Local Arrays ..
      CHARACTER*70      REC(5)
C     .. External Subroutines ..
      EXTERNAL          X04ABF, X04BAF
C     .. Executable Statements ..
      CALL X04ABF(0,NOUT)
      IF (KTF.NE.0) GO TO 120
      WRITE (REC,FMT=99999) ITC, S, D
      DO 20 I = 1, 5
         CALL X04BAF(NOUT,REC(I))
   20 CONTINUE
      DO 80 I = 1, NPARA
         IF (I.LE.NPE) GO TO 40
         J = 8
         GO TO 60
   40    K = MSER(I)
         J = MTYP(I)
         IF (K.EQ.0) GO TO 60
         IF (J.EQ.1) WRITE (REC,FMT=99998) K, PARA(I)
         IF (J.EQ.2) WRITE (REC,FMT=99997) K, PARA(I)
         IF (J.EQ.3) WRITE (REC,FMT=99996) K, PARA(I)
         IF (J.EQ.4) WRITE (REC,FMT=99995) K, PARA(I)
         IF (J.EQ.5) WRITE (REC,FMT=99994) K, PARA(I)
         IF (J.EQ.6) WRITE (REC,FMT=99993) K, PARA(I)
         IF (J.EQ.7) WRITE (REC,FMT=99992) K, PARA(I)
         IF (J.EQ.8) WRITE (REC,FMT=99991) K, PARA(I)
         IF (J.GE.1 .AND. J.LE.8) CALL X04BAF(NOUT,REC(1))
         GO TO 80
   60    IF (J.EQ.1) WRITE (REC,FMT=99990) PARA(I)
         IF (J.EQ.2) WRITE (REC,FMT=99989) PARA(I)
         IF (J.EQ.3) WRITE (REC,FMT=99988) PARA(I)
         IF (J.EQ.4) WRITE (REC,FMT=99987) PARA(I)
         IF (J.EQ.5) WRITE (REC,FMT=99986) PARA(I)
         IF (J.EQ.6) WRITE (REC,FMT=99985) PARA(I)
         IF (J.EQ.7) WRITE (REC,FMT=99984) PARA(I)
         IF (J.EQ.8) WRITE (REC,FMT=99983) PARA(I)
         IF (J.GE.1 .AND. J.LE.8) CALL X04BAF(NOUT,REC(1))
   80 CONTINUE
  100 RETURN
  120 IF (KTF.NE.5) GO TO 160
      WRITE (REC,FMT=99982) KTFV
      DO 140 I = 1, 4
         CALL X04BAF(NOUT,REC(I))
  140 CONTINUE
      GO TO 100
  160 WRITE (REC,FMT=99981) KTFV
      DO 180 I = 1, 4
         CALL X04BAF(NOUT,REC(I))
  180 CONTINUE
      GO TO 100
C
99999 FORMAT (///' ITC=',I5,10X,' S=',D15.6,10X,' D=',D15.6,/)
99998 FORMAT (' PHI        SERIES',I3,D15.6)
99997 FORMAT (' THETA      SERIES',I3,D15.6)
99996 FORMAT (' SPHI       SERIES',I3,D15.6)
99995 FORMAT (' STHETA     SERIES',I3,D15.6)
99994 FORMAT (' OMEGA/SI   SERIES',I3,D15.6)
99993 FORMAT (' OMEGA      SERIES',I3,D15.6)
99992 FORMAT (' DELTA      SERIES',I3,D15.6)
99991 FORMAT (' CONSTANT   SERIES',I3,D15.6)
99990 FORMAT (' PHI     ',12X,D15.6)
99989 FORMAT (' THETA   ',12X,D15.6)
99988 FORMAT (' SPHI    ',12X,D15.6)
99987 FORMAT (' STHETA  ',12X,D15.6)
99986 FORMAT (' OMEGA/SI',12X,D15.6)
99985 FORMAT (' OMEGA   ',12X,D15.6)
99984 FORMAT (' DELTA   ',12X,D15.6)
99983 FORMAT (' CONSTANT',12X,D15.6)
99982 FORMAT (//' THE REQUIRED MINIMUM DIMENSION OF WA IS',I6,/)
99981 FORMAT (//' THE REQUIRED MINIMUM DIMENSION OF MWA IS',I6,/)
      END
